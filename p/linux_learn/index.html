<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="åŸºäºLinuxæ“ä½œç³»ç»Ÿçš„ç›¸å…³å­¦ä¹  æ ‘è“æ´¾ ROS ç­‰">
<title>ã€Linuxã€‘æ“ä½œç³»ç»Ÿçš„å­¦ä¹ </title>

<link rel='canonical' href='https://prominsegsj.github.io/p/linux_learn/'>

<link rel="stylesheet" href="/scss/style.min.84e9e3518f269b022a23d4be353b0038d7bb6000d763cac7f1a0b9b92d507bc7.css"><meta property='og:title' content="ã€Linuxã€‘æ“ä½œç³»ç»Ÿçš„å­¦ä¹ ">
<meta property='og:description' content="åŸºäºLinuxæ“ä½œç³»ç»Ÿçš„ç›¸å…³å­¦ä¹  æ ‘è“æ´¾ ROS ç­‰">
<meta property='og:url' content='https://prominsegsj.github.io/p/linux_learn/'>
<meta property='og:site_name' content='å°éƒ­ä¸èƒŒé”…'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-09-13T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-09-13T00:00:00&#43;00:00'/><meta property='og:image' content='https://prominsegsj.github.io/p/linux_learn/2.png' />
<meta name="twitter:title" content="ã€Linuxã€‘æ“ä½œç³»ç»Ÿçš„å­¦ä¹ ">
<meta name="twitter:description" content="åŸºäºLinuxæ“ä½œç³»ç»Ÿçš„ç›¸å…³å­¦ä¹  æ ‘è“æ´¾ ROS ç­‰"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://prominsegsj.github.io/p/linux_learn/2.png' />
    <link rel="shortcut icon" href="/favicon.ico" />
<div class="loading">
    <div class="loader"></div>
</div>

<style>
 
.loading {
    position: fixed;
    display: flex;
    justify-content: center;
    align-items: center;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: 99;
    background-color: hsl(199, 63%, 75%);
}

 
.loader {
    position: relative;
    width: 120px;
    height: 90px;
}

.loader:before {
    content: "";
    position: absolute;
    bottom: 30px;
    left: 50px;
    height: 30px;
    width: 30px;
    border-radius: 50%;
    background: #3a88db;
    animation: loading-bounce 0.5s ease-in-out infinite alternate;
}

.loader:after {
    content: "";
    position: absolute;
    right: 0;
    top: 0;
    height: 7px;
    width: 45px;
    border-radius: 4px;
    box-shadow: 0 5px 0 #36a5d9, -35px 50px 0 #36a5d9, -70px 95px 0 #36a5d9;
    animation: loading-step 1s ease-in-out infinite;
}

 
@keyframes loading-bounce {
    0%   { transform: scale(1, 0.7); }
    40%  { transform: scale(0.8, 1.2); }
    60%  { transform: scale(1, 1); }
    100% { bottom: 140px; }
}

 
@keyframes loading-step {
    0% {
        box-shadow: 0 10px 0 rgba(0, 0, 0, 0),
                    0 10px 0 #36a5d9,
                    -35px 50px 0 #36a5d9,
                    -70px 90px 0 #36a5d9;
    }
    100% {
        box-shadow: 0 10px 0 #36a5d9,
                    -35px 50px 0 #36a5d9,
                    -70px 90px 0 #36a5d9,
                    -70px 90px 0 rgba(0, 0, 0, 0);
    }
}

 
@keyframes scaleAndFade {
  0%   { transform: scale(1); opacity: 1; }
  100% { transform: scale(1.2); opacity: 0; }
}

.scaleAndFadeout {
  animation: scaleAndFade 0.5s forwards;  
}
</style>

<script>
function initLoading() {
    let loading = document.querySelector(".loading");
    document.addEventListener('DOMContentLoaded', function() {
        
        setTimeout(() => {
            
            loading.classList.add("scaleAndFadeout");
            loading.addEventListener('animationend', () => {
                loading.style.display = "none";
            });
        }, 1500); 
    });
}
initLoading();
</script>

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_34ea3bfdb6c513b1.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ«£</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">å°éƒ­ä¸èƒŒé”…</a></h1>
            <h2 class="site-description">æ¬¢è¿æ¥åˆ°å°éƒ­ä¸èƒŒé”…çš„ä¸ªäººåšå®¢é¢‘é“ï¼Œè¿™é‡Œè®°å½•ä¸€ä½æ¢¦æƒ³æˆä¸ºæŠ€æœ¯å’¸é±¼å®¶çš„ç‚¹ç‚¹åˆæ»´æ»´ï¼ğŸˆğŸ‡</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/1782631305'
                        target="_blank"
                        title="Bilibili"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-bilibili"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 10a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v6a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4v-6z" /><path d="M8 3l2 3" /><path d="M16 3l-2 3" /><path d="M9 13v-2" /><path d="M15 11v2" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/prominsegsj'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="currentColor"  class="icon icon-tabler icons-tabler-filled icon-tabler-home"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12.707 2.293l9 9c.63 .63 .184 1.707 -.707 1.707h-1v6a3 3 0 0 1 -3 3h-1v-7a3 3 0 0 0 -2.824 -2.995l-.176 -.005h-2a3 3 0 0 0 -3 3v7h-1a3 3 0 0 1 -3 -3v-6h-1c-.89 0 -1.337 -1.077 -.707 -1.707l9 -9a1 1 0 0 1 1.414 0m.293 11.707a1 1 0 0 1 1 1v7h-4v-7a1 1 0 0 1 .883 -.993l.117 -.007z" /></svg>
                
                <span>ä¸»é¡µ | Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="currentColor"  class="icon icon-tabler icons-tabler-filled icon-tabler-archive"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M2 3m0 2a2 2 0 0 1 2 -2h16a2 2 0 0 1 2 2v0a2 2 0 0 1 -2 2h-16a2 2 0 0 1 -2 -2z" /><path d="M19 9c.513 0 .936 .463 .993 1.06l.007 .14v7.2c0 1.917 -1.249 3.484 -2.824 3.594l-.176 .006h-10c-1.598 0 -2.904 -1.499 -2.995 -3.388l-.005 -.212v-7.2c0 -.663 .448 -1.2 1 -1.2h14zm-5 2h-4l-.117 .007a1 1 0 0 0 0 1.986l.117 .007h4l.117 -.007a1 1 0 0 0 0 -1.986l-.117 -.007z" /></svg>
                
                <span>åšå®¢å½’æ¡£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E%E7%AB%99%E4%B8%BB/' >
                
                
                
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="currentColor"  class="icon icon-tabler icons-tabler-filled icon-tabler-user"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 2a5 5 0 1 1 -5 5l.005 -.217a5 5 0 0 1 4.995 -4.783z" /><path d="M14 14a5 5 0 0 1 5 5v1a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-1a5 5 0 0 1 5 -5h4z" /></svg>
                
                <span>å…³äºç«™ä¸»</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="currentColor"  class="icon icon-tabler icons-tabler-filled icon-tabler-zoom-code"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14 3.072a8 8 0 0 1 2.32 11.834l5.387 5.387a1 1 0 0 1 -1.414 1.414l-5.388 -5.387a8 8 0 0 1 -12.905 -6.32l.005 -.285a8 8 0 0 1 11.995 -6.643m-5.293 4.22a1 1 0 0 0 -1.414 0l-2 2a1 1 0 0 0 0 1.415l2 2a1 1 0 0 0 1.414 0l.083 -.094a1 1 0 0 0 -.083 -1.32l-1.292 -1.293l1.292 -1.293a1 1 0 0 0 0 -1.414m4 0a1 1 0 0 0 -1.414 0l-.083 .095a1 1 0 0 0 .083 1.32l1.292 1.292l-1.292 1.293a1 1 0 0 0 1.414 1.414l2 -2a1 1 0 0 0 0 -1.414z" /></svg>
                
                <span>æœ¬ç«™æœç´¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%8F%8B%E6%83%85%E7%B4%A2%E9%81%93/' >
                
                
                
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="currentColor"  class="icon icon-tabler icons-tabler-filled icon-tabler-aerial-lift"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M19.876 2.008a1 1 0 1 1 .248 1.984l-7.124 .891v2.117h4.2a1 1 0 0 1 .688 .274l.087 .093c2.79 3.417 2.717 9.963 -.226 13.295a1 1 0 0 1 -.749 .338h-10.106a1 1 0 0 1 -.763 -.353c-2.86 -3.373 -2.86 -9.92 0 -13.294a1 1 0 0 1 .763 -.353h4.106v-1.867l-6.876 .86a1 1 0 0 1 -1.095 -.754l-.021 -.115a1 1 0 0 1 .868 -1.116l7.996 -1l.011 -.001l.008 -.001zm-8.876 6.992h-3.617l-.051 .072c-.718 1.042 -1.149 2.41 -1.292 3.844l-.008 .084h4.968zm5.698 0h-3.698v4h4.979l-.005 -.072c-.123 -1.436 -.533 -2.811 -1.232 -3.864z" /></svg>
                
                <span>å‹æƒ…ç´¢é“</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E6%8A%80%E6%9C%AF%E9%93%BE%E6%8E%A5/' >
                
                
                
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="currentColor"  class="icon icon-tabler icons-tabler-filled icon-tabler-dumpling"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10.003 2.04a3.53 3.53 0 0 1 2.602 .62l.09 .07l.149 -.11a3.53 3.53 0 0 1 3.044 -.462l.207 .072a3.53 3.53 0 0 1 1.99 1.903l.014 .031l.045 -.004a3.53 3.53 0 0 1 2.624 .879l.153 .144l.358 .358c1.976 1.977 -.32 6.748 -4.655 11.083c-4.336 4.335 -9.106 6.632 -11.083 4.655l-.382 -.382l-.135 -.145a3.53 3.53 0 0 1 -.87 -2.556l.01 -.1l-.162 -.072a3.53 3.53 0 0 1 -1.838 -2.124l-.055 -.192a3.53 3.53 0 0 1 .56 -2.937l.062 -.079l-.07 -.092a3.53 3.53 0 0 1 -.644 -2.401l.025 -.2a3.53 3.53 0 0 1 1.707 -2.505l.046 -.026l-.005 -.14a3.53 3.53 0 0 1 .885 -2.345l.15 -.16l.159 -.149a3.53 3.53 0 0 1 2.346 -.884l.14 .004l.026 -.046a3.53 3.53 0 0 1 2.308 -1.67z" /></svg>
                
                <span>æŠ€æœ¯é“¾æ¥</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#1-linuxåŸºç¡€ç»ˆç«¯">1. LinuxåŸºç¡€ç»ˆç«¯</a></li>
    <li><a href="#2-æ ‘è“æ´¾å­¦ä¹ ç¬”è®°">2. æ ‘è“æ´¾å­¦ä¹ ç¬”è®°</a>
      <ul>
        <li><a href="#21-åˆæ­¥è´¦å·è®¾ç½®">2.1 åˆæ­¥è´¦å·è®¾ç½®</a></li>
        <li><a href="#22-å¸¸ç”¨ç»ˆç«¯æŒ‡ä»¤">2.2 å¸¸ç”¨ç»ˆç«¯æŒ‡ä»¤</a></li>
        <li><a href="#23-é…ç½®ç¤ºä¾‹ä»£ç ">2.3 é…ç½®ç¤ºä¾‹ä»£ç </a></li>
        <li><a href="#24-pythonå¼€å‘ç¯å¢ƒé…ç½®venvè™šæ‹Ÿç¯å¢ƒ">2.4 pythonå¼€å‘ç¯å¢ƒé…ç½®(venvè™šæ‹Ÿç¯å¢ƒ)</a></li>
        <li><a href="#25-pythonå¼€å‘">2.5 pythonå¼€å‘</a></li>
        <li><a href="#26-vimç¼–è¾‘å™¨çš„ä½¿ç”¨">2.6 vimç¼–è¾‘å™¨çš„ä½¿ç”¨</a></li>
      </ul>
    </li>
    <li><a href="#3-ros2å­¦ä¹ ç¬”è®°">3. ROS2å­¦ä¹ ç¬”è®°</a>
      <ul>
        <li><a href="#31-ros2-run">3.1 ros2 run</a></li>
        <li><a href="#32-ros2-node-list">3.2. ros2 node list</a></li>
        <li><a href="#33-é‡æ˜ å°„">3.3. é‡æ˜ å°„</a></li>
        <li><a href="#34-ros2èŠ‚ç‚¹ä¿¡æ¯">3.4. ros2èŠ‚ç‚¹ä¿¡æ¯</a></li>
        <li><a href="#35-ç¼–è¯‘è¿è¡Œcæ–‡ä»¶">3.5. ç¼–è¯‘è¿è¡ŒC++æ–‡ä»¶</a></li>
        <li><a href="#36-åˆ›å»ºåŠŸèƒ½åŒ…">3.6. åˆ›å»ºåŠŸèƒ½åŒ…</a></li>
        <li><a href="#37-å…¶ä»–">3.7. å…¶ä»–</a></li>
        <li><a href="#38-å·¥ä½œç©ºé—´workplace">3.8 å·¥ä½œç©ºé—´(WorkPlace)</a></li>
        <li><a href="#39-pythonå­¦ä¹ ">3.9 Pythonå­¦ä¹ </a></li>
        <li><a href="#310-cå­¦ä¹ ">3.10 C++å­¦ä¹ </a></li>
        <li><a href="#311-å¤šçº¿ç¨‹ä»¥åŠå›è°ƒå‡½æ•°">3.11 å¤šçº¿ç¨‹ä»¥åŠå›è°ƒå‡½æ•°</a></li>
        <li><a href="#312-è¯é¢˜">3.12 è¯é¢˜</a></li>
        <li><a href="#313-æœåŠ¡">3.13 æœåŠ¡</a></li>
      </ul>
    </li>
    <li><a href="#4-å¿ƒå¾—æ€»ç»“">4. å¿ƒå¾—æ€»ç»“</a></li>
  </ul>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/linux_learn/">
                <img src="/p/linux_learn/2_hu_b96b817c7a00abe.png"
                        srcset="/p/linux_learn/2_hu_b96b817c7a00abe.png 800w, /p/linux_learn/2_hu_94b1c81cd92f6411.png 1600w"
                        width="800" 
                        height="457" 
                        loading="lazy"
                        alt="Featured image of post ã€Linuxã€‘æ“ä½œç³»ç»Ÿçš„å­¦ä¹ " />
                
            </a>
        </div>
    

    <div class="article-details">
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/linux_learn/">ã€Linuxã€‘æ“ä½œç³»ç»Ÿçš„å­¦ä¹ </a>
        </h2>
    
        
        <h3 class="article-subtitle">
            åŸºäºLinuxæ“ä½œç³»ç»Ÿçš„ç›¸å…³å­¦ä¹  æ ‘è“æ´¾ ROS ç­‰
        </h3>
        
    </div>

    
    
    

    <footer class="article-time">
        <div class="article-time-item">
            <?xml version="1.0" ?><svg style="enable-background:new 0 0 64 64;" version="1.1" viewBox="0 0 64 64" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="_x32_5_attachment"/><g id="_x32_4_office"/><g id="_x32_3_pin"/><g id="_x32_2_business_card"/><g id="_x32_1_form"/><g id="_x32_0_headset"/><g id="_x31_9_video_call"/><g id="_x31_8_letter_box"/><g id="_x31_7_papperplane"/><g id="_x31_6_laptop"/><g id="_x31_5_connection"/><g id="_x31_4_phonebook"/><g id="_x31_3_classic_telephone"/><g id="_x31_2_sending_mail"/><g id="_x31_1_man_talking"/><g id="_x31_0_date"><g><g><path d="M53.1494,5.7119h-3.8086V5.3877c0-2.3433-1.9063-4.2495-4.249-4.2495c-2.3408,0-4.2461,1.9063-4.2461,4.2495v0.3242     H22.4941V5.2461C22.4941,2.9048,20.5889,1,18.248,1c-2.3428,0-4.249,1.9048-4.249,4.2461v0.4658h-3.1455     c-4.4746,0-8.1143,3.8633-8.1143,8.6123v40.0635c0,4.749,3.6396,8.6123,8.1143,8.6123h42.2959     c4.4727,0,8.1113-3.8633,8.1113-8.6123V14.3242C61.2607,9.5752,57.6221,5.7119,53.1494,5.7119z M42.8457,5.3877     c0-1.2402,1.0078-2.2495,2.2461-2.2495c1.2402,0,2.249,1.0093,2.249,2.2495v3.0596c0,1.2402-1.0088,2.2495-2.249,2.2495     c-1.2383,0-2.2461-1.0093-2.2461-2.2495V5.3877z M15.999,5.2461C15.999,4.0078,17.0078,3,18.248,3     c1.2383,0,2.2461,1.0078,2.2461,2.2461v3.063c0,1.2383-1.0078,2.2461-2.2461,2.2461c-1.2402,0-2.249-1.0078-2.249-2.2461V5.2461z      M59.2607,54.3877c0,3.646-2.7412,6.6123-6.1113,6.6123H10.8535c-3.3711,0-6.1143-2.9663-6.1143-6.6123V17.8652h54.5215V54.3877z      M59.2607,15.8652H4.7393v-1.541c0-3.646,2.7432-6.6123,6.1143-6.6123h3.1455v0.5972c0,2.3413,1.9063,4.2461,4.249,4.2461     c2.3408,0,4.2461-1.9048,4.2461-4.2461V7.7119h18.3516v0.7354c0,2.3433,1.9053,4.2495,4.2461,4.2495     c2.3428,0,4.249-1.9063,4.249-4.2495V7.7119h3.8086c3.3701,0,6.1113,2.9663,6.1113,6.6123V15.8652z"/><path d="M11.4316,56.0688h10.2842h30.8525c0.5527,0,1-0.4478,1-1v-30.854c0-0.5522-0.4473-1-1-1H11.4316c-0.5527,0-1,0.4478-1,1     v30.854C10.4316,55.6211,10.8789,56.0688,11.4316,56.0688z M51.5684,43.7842h-8.2842v-8.2847h8.2842V43.7842z M41.2842,43.7842     H33v-8.2847h8.2842V43.7842z M31,43.7842h-8.2842v-8.2847H31V43.7842z M20.7158,43.7842h-8.2842v-8.2847h8.2842V43.7842z      M12.4316,45.7842h8.2842v8.2847h-8.2842V45.7842z M22.7158,45.7842H31v8.2847h-8.2842V45.7842z M33,45.7842h8.2842v8.2847H33     V45.7842z M51.5684,54.0688h-8.2842v-8.2847h8.2842V54.0688z M51.5684,33.4995h-8.2842v-8.2847h8.2842V33.4995z M41.2842,33.4995     H33v-8.2847h8.2842V33.4995z M31,33.4995h-8.2842v-8.2847H31V33.4995z M12.4316,25.2148h8.2842v8.2847h-8.2842V25.2148z"/></g></g></g><g id="_x30_9_review"/><g id="_x30_8_email"/><g id="_x30_7_information"/><g id="_x30_6_phone_talking"/><g id="_x30_5_women_talking"/><g id="_x30_4_calling"/><g id="_x30_3_women"/><g id="_x30_2_writing"/><g id="_x30_1_chatting"/></svg>
            <time class="article-time--published">2025-09-13</time>
        </div>
    
        <div class="article-time-separator"> | </div>
    
        <div class="article-time-item">
            <?xml version="1.0" ?><svg style="enable-background:new 0 0 24 24;" version="1.1" viewBox="0 0 24 24" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><style type="text/css">
	.st0{display:none;}
</style><g class="st0" id="grid"/><g id="icon"><path d="M8.041,12.659l-1.022,3.708c-0.048,0.173,0.001,0.359,0.128,0.486C7.242,16.949,7.369,17,7.5,17   c0.044,0,0.089-0.006,0.133-0.018l3.708-1.022c0.083-0.023,0.16-0.067,0.221-0.128L23.297,4.096c0.936-0.936,0.936-2.458,0-3.393   c-0.936-0.936-2.458-0.935-3.393,0L8.169,12.438C8.108,12.499,8.063,12.575,8.041,12.659z M8.969,13.052L20.611,1.41   c0.546-0.546,1.434-0.545,1.979,0s0.545,1.434,0,1.979L10.948,15.031l-2.732,0.753L8.969,13.052z"/><path d="M1.818,24h17.364C20.185,24,21,23.185,21,22.182V10.414c0-0.276-0.224-0.5-0.5-0.5s-0.5,0.224-0.5,0.5v11.768   C20,22.633,19.633,23,19.182,23H1.818C1.367,23,1,22.633,1,22.182V4.818C1,4.367,1.367,4,1.818,4h11.768c0.276,0,0.5-0.224,0.5-0.5   S13.862,3,13.586,3H1.818C0.815,3,0,3.815,0,4.818v17.364C0,23.185,0.815,24,1.818,24z"/></g></svg> 
            <span class="article-wordcount">
                19328 å­—
            </span>
        </div>
    </footer>

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="åŸºäºlinuxæ“ä½œç³»ç»Ÿä¸‹çš„ç›¸å…³å­¦ä¹ ">åŸºäºLinuxæ“ä½œç³»ç»Ÿä¸‹çš„ç›¸å…³å­¦ä¹ 
</h1><blockquote class="alert alert-note">
    <p>(æœ¬æ¬¡å­¦ä¹ å¼€å‘ç¯å¢ƒéƒ½æ˜¯åœ¨è™šæ‹Ÿæœºubantu24.04.2ç³»ç»Ÿç‰ˆæœ¬ä»¥åŠROS2çš„jazzyç‰ˆæœ¬ä¸‹çš„è®°å½•)æœ¬æ¥æ˜¯æƒ³åˆ†å¼€æ¥åˆ†åˆ«è®°å½•æ ‘è“æ´¾è·ŸROS2çš„ç›¸å…³å­¦ä¹ çš„ï¼Œä½†æ˜¯æƒ³æ¥ç°åœ¨çš„å­¦ä¹ æ·±åº¦å’Œç¬”è®°éƒ½è¾ƒä¸ºæµ…ï¼Œæˆ‘å°±æš‚ä¸ºæ”¾åˆ°ä¸€èµ·ç®—ä½œæ€»çš„Linuxå­¦ä¹ å¥½äº†ğŸ¤ŒğŸ¤Œ<br></p></blockquote>
<h2 id="1-linuxåŸºç¡€ç»ˆç«¯">1. LinuxåŸºç¡€ç»ˆç«¯
</h2><ul>
<li>ls -aã€åˆ—å‡ºå½“å‰æ–‡ä»¶å¤¹å†…æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶ã€‘</li>
<li>source +æ–‡ä»¶åç§°ã€è¿è¡ŒæŸä¸ªæ–‡æœ¬æ–‡ä»¶ã€‘</li>
<li>~/.bashrcã€æ–‡ä»¶æ˜¯ç»ˆç«¯è¿è¡Œæ—¶ä¼šè‡ªåŠ¨æå‰è¿è¡Œçš„è„šæœ¬ã€‘</li>
<li>nano æ–‡ä»¶åã€æ–‡ä»¶ç¼–è¾‘å™¨ç¼–è¾‘/åˆ›å»ºæ–‡ä»¶ã€‘</li>
<li>gedit æ–‡ä»¶åã€æ–‡ä»¶ç¼–è¾‘å™¨ç¼–è¾‘/åˆ›å»ºæ–‡ä»¶ã€‘</li>
<li>whereis è½¯ä»¶åç§°ã€æŸ¥è¯¢å®‰è£…è·¯å¾„ã€‘</li>
<li>code ./ ã€ä½¿ç”¨vscodeæ‰“å¼€å½“å‰æ–‡ä»¶è·¯å¾„æ–‡ä»¶å¤¹ã€‘</li>
<li>mv åŸæ–‡ä»¶å é‡å‘½åæ–‡ä»¶å ã€é‡å‘½åæ–‡ä»¶åã€‘</li>
<li>æŸ¥çœ‹å½“å‰ç³»ç»Ÿç‰ˆæœ¬ï¼šlsb_release -a</li>
</ul>
<h2 id="2-æ ‘è“æ´¾å­¦ä¹ ç¬”è®°">2. æ ‘è“æ´¾å­¦ä¹ ç¬”è®°
</h2><blockquote class="alert alert-tip">
    <p>å…¶å®æ ‘è“æ´¾å°±æ˜¯ä¸€ä¸ªé›†æˆçš„å°çš„ç¡¬ä»¶&quot;å°ç”µè„‘&quot;ï¼Œå®‰è£…å¥½å¯¹åº”çš„æ ‘è“æ´¾æˆ–è€…å…¶ä»–æ“ä½œç³»ç»Ÿå°±å¯ä»¥æ­£å¸¸å¼€å‘ä½¿ç”¨äº†ï¼Œå¯¹åº”çš„ä¸ªäººè®¤ä¸ºè¾ƒå¥½çš„æ•™ç¨‹å¯ä»¥çœ‹bç«™UP<a class="link" href="https://www.bilibili.com/video/BV16U4y1879Q/?spm_id_from=333.337.search-card.all.click&amp;vd_source=b0f5272da83bbf0fd5569aa17bceb192"  target="_blank" rel="noopener"
    >æ ‘å°æºª</a>ï¼Œæ•´ä½“çš„ç¯å¢ƒé…ç½®å’Œæµç¨‹æˆ‘å°±ä¸èµ˜è¿°äº†ï¼Œè¯¦ç»†ç›´æ¥çœ‹è¿™ä¸ªä»–çš„è§†é¢‘å³å¯ã€‚æ­¤å¤„åªåšä¸ªäººçš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å‚è€ƒï¼è¡¥å……ï¼šæœ¬ç¬”è®°çš„ç³»ç»Ÿç¯å¢ƒæ˜¯æ ‘è“æ´¾çš„å®˜æ–¹ç¯å¢ƒRaspberry Pi OSã€‚<br></p></blockquote>
<h3 id="21-åˆæ­¥è´¦å·è®¾ç½®">2.1 åˆæ­¥è´¦å·è®¾ç½®
</h3><ul>
<li>ä¸»æœºï¼šmiaochuangbalou</li>
<li>å¯†ç ï¼š111111</li>
<li>åœ°å€ï¼š192.168.137.92 ã€æ­¤å¤„æ˜¯æˆ‘ç»™æ ‘è“æ´¾é…ç½®çš„å›ºå®šipï¼Œè¯¦ç»†çœ‹æ•™ç¨‹ã€‘</li>
</ul>
<h3 id="22-å¸¸ç”¨ç»ˆç«¯æŒ‡ä»¤">2.2 å¸¸ç”¨ç»ˆç«¯æŒ‡ä»¤
</h3><ul>
<li>ç»ˆç«¯å¼€å¯æ ‘è“æ´¾é…ç½®é€‰é¡¹ï¼šsudo raspi-config</li>
<li>æŸ¥çœ‹å½“å‰ç”µè„‘IP:hostname -I</li>
<li>åˆ é™¤éç©ºç›®å½•æ–‡ä»¶å¤¹ï¼šrm -r æ–‡ä»¶å</li>
<li>æ¸…å±æ“ä½œï¼šclear</li>
</ul>
<h3 id="23-é…ç½®ç¤ºä¾‹ä»£ç ">2.3 é…ç½®ç¤ºä¾‹ä»£ç 
</h3><ul>
<li>ä»£ç 1ï¼šé…ç½®æ ‘è“æ´¾è‡ªåŠ¨å¼€å¯vnc
<ul>
<li>ä¾‹ç¨‹</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">    <span class="c1">#!/bin/sh </span>
</span></span><span class="line"><span class="cl">    <span class="n">export</span> <span class="n">USER</span><span class="o">=</span><span class="s1">&#39;master&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">eval</span> <span class="n">cd</span><span class="o">~</span><span class="err">$</span><span class="n">USER</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s2">&#34;$1&#34;</span> <span class="ow">in</span>
</span></span><span class="line"><span class="cl">    <span class="n">start</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#å¯åŠ¨å‘½ä»¤è¡Œã€‚æ­¤å¤„è‡ªå®šä¹‰åˆ†è¾¨ç‡ã€æ§åˆ¶å°å·ç æˆ–å…¶å®ƒå‚æ•°ã€‚ </span>
</span></span><span class="line"><span class="cl">        <span class="n">su</span> <span class="err">$</span><span class="n">USER</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;/usr/bin/vncserver -depth 24 -geometry 1920x1080:1&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">echo</span> <span class="s2">&#34;Starting VNCServer for $USER&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">;;</span> 
</span></span><span class="line"><span class="cl">    <span class="n">stop</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">su</span> <span class="err">$</span><span class="n">USER</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;/usr/bin/vncserver -kill:1&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">echo</span> <span class="s2">&#34;VNCServer stopped&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">echo</span> <span class="s2">&#34;Usage: /etc/init.d/vncserver {start/stop}&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">exit</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    <span class="n">esac</span>
</span></span><span class="line"><span class="cl">    <span class="n">exit</span> <span class="mi">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>ä»£ç 2ï¼šè‡ªåŠ¨è¿æ¥çƒ­ç‚¹
<ul>
<li>ä¾‹ç¨‹</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">    <span class="c1">#ï¼ˆwpa_supplicant.confï¼ˆæ–‡ä»¶åï¼‰ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="n">country</span><span class="o">=</span><span class="n">CN</span>
</span></span><span class="line"><span class="cl">    <span class="n">ctrl_interface</span><span class="o">=</span><span class="n">DIR</span><span class="o">=/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">wpa_supplicant</span><span class="err">ï¼Œ</span><span class="n">GROUP</span><span class="o">=</span><span class="n">netdev</span>
</span></span><span class="line"><span class="cl">    <span class="n">update_config</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">network</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">ssid</span><span class="o">=</span><span class="s2">&#34;WiFiåç§°&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">psk</span><span class="o">=</span><span class="s2">&#34;WiFiå¯†ç &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">key_mgmt</span><span class="o">=</span><span class="n">WPA</span><span class="o">-</span><span class="n">PSK</span> 
</span></span><span class="line"><span class="cl">        <span class="n">priority</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="24-pythonå¼€å‘ç¯å¢ƒé…ç½®venvè™šæ‹Ÿç¯å¢ƒ">2.4 pythonå¼€å‘ç¯å¢ƒé…ç½®(venvè™šæ‹Ÿç¯å¢ƒ)
</h3><ul>
<li>æŸ¥çœ‹å½“å‰pythonç‰ˆæœ¬ï¼špython &ndash;version</li>
<li>åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼š
<ul>
<li>(1). sudo apt-get update ï¼ˆæ›´æ–°aptå·¥å…·ï¼‰</li>
<li>(2). sudo apt-get install python3-venvï¼ˆä¸‹è½½è™šæ‹Ÿç¯å¢ƒï¼‰</li>
<li>(3). python3 -m venv venv ï¼ˆå…ˆè¿›å…¥æƒ³è¦åˆ›å»ºçš„è™šæ‹Ÿç¯å¢ƒçš„æ–‡ä»¶è·¯å¾„åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œæœ€åä¸ºç¯å¢ƒåç§°ï¼‰</li>
<li>(4). source venv/bin/activate ï¼ˆæ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼‰</li>
<li>(5). pip listï¼ˆæŸ¥çœ‹å½“å‰ç¯å¢ƒçš„pythonåŒ…ï¼‰</li>
<li>(6). deactivateï¼ˆé€€å‡ºå½“å‰çš„è™šæ‹Ÿç¯å¢ƒï¼‰</li>
</ul>
</li>
<li>åˆ›å»ºè™šæ‹Ÿç¯å¢ƒvenvæ—¶ç»§æ‰¿ç³»ç»Ÿçš„åŒ…
<ul>
<li>æ–¹æ³• 1ï¼šåˆ›å»ºè™šæ‹Ÿç¯å¢ƒæ—¶ç»§æ‰¿ç³»ç»ŸåŒ…
<ul>
<li>python3 -m venv &ndash;system-site-packages myenv</li>
<li>è§£é‡Š1ï¼šmyenv æ˜¯ä½ çš„è™šæ‹Ÿç¯å¢ƒç›®å½•åï¼ˆå¯è‡ªå®šä¹‰ï¼‰ã€‚</li>
<li>è§£é‡Š2ï¼š&ndash;system-site-packages ä¼šè®©è™šæ‹Ÿç¯å¢ƒç»§æ‰¿ç³»ç»Ÿä¸­å·²å®‰è£…çš„åŒ…ã€‚</li>
</ul>
</li>
<li>æ–¹æ³• 2ï¼šå¯¹å·²å­˜åœ¨çš„è™šæ‹Ÿç¯å¢ƒå¯ç”¨ç³»ç»ŸåŒ…
<ul>
<li>è§£é‡Šï¼šå¦‚æœè™šæ‹Ÿç¯å¢ƒå·²ç»åˆ›å»ºï¼Œä½†æ²¡æœ‰ç»§æ‰¿ç³»ç»ŸåŒ…ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹è™šæ‹Ÿç¯å¢ƒçš„é…ç½®æ–‡ä»¶æ‰‹åŠ¨å¯ç”¨.</li>
<li>(1). æ‰¾åˆ°è™šæ‹Ÿç¯å¢ƒçš„ pyvenv.cfg æ–‡ä»¶ï¼ˆé€šå¸¸åœ¨è™šæ‹Ÿç¯å¢ƒçš„æ ¹ç›®å½•ï¼‰ï¼š
<ul>
<li>cat myenv/pyvenv.cfg</li>
</ul>
</li>
<li>(2). ä¿®æ”¹æˆ–æ·»åŠ ä»¥ä¸‹è¡Œä»£ç å†…å®¹ï¼š
<ul>
<li>include-system-site-packages = true</li>
</ul>
</li>
<li>(3). é‡æ–°æ¿€æ´»è™šæ‹Ÿç¯å¢ƒå³å¯ç”Ÿæ•ˆã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="25-pythonå¼€å‘">2.5 pythonå¼€å‘
</h3><ul>
<li>åœ¨ Linux ä¸­ï¼Œè¦æŸ¥çœ‹ Python çš„ .py æ–‡ä»¶å†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‡ ç§å‘½ä»¤ï¼š
<ul>
<li>ä½¿ç”¨ cat å‘½ä»¤ï¼š
<ul>
<li>cat /path/to/your_python_file.pyï¼ˆcat å‘½ä»¤ç”¨äºæ˜¾ç¤ºæ–‡ä»¶å†…å®¹ï¼Œå°†ä¼šåœ¨ç»ˆç«¯è¾“å‡ºæ•´ä¸ª .py æ–‡ä»¶çš„å†…å®¹ï¼‰</li>
</ul>
</li>
<li>ä½¿ç”¨ less å‘½ä»¤ï¼š
<ul>
<li>less /path/to/your_python_file.pyï¼ˆless å‘½ä»¤å¯ä»¥æŒ‰é¡µæ˜¾ç¤ºæ–‡ä»¶å†…å®¹ï¼Œé€‚ç”¨äºè¾ƒå¤§çš„æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ç®­å¤´é”®å’Œ PageUp/PageDown é”®è¿›è¡Œæµè§ˆï¼‰</li>
</ul>
</li>
<li>ä½¿ç”¨ more å‘½ä»¤ï¼š
<ul>
<li>more /path/to/your_python_file.pyï¼ˆmore å‘½ä»¤ä¹Ÿå¯ä»¥æŒ‰é¡µæ˜¾ç¤ºæ–‡ä»¶å†…å®¹ï¼Œä¸ less ç±»ä¼¼ï¼Œä½†åœ¨æ˜¾ç¤ºæ–‡ä»¶å†…å®¹æ—¶çš„äº¤äº’æ–¹å¼ç•¥æœ‰ä¸åŒï¼‰</li>
</ul>
</li>
<li>ä½¿ç”¨ vim æˆ– nano ç¼–è¾‘å™¨ï¼š(å‰ææ˜¯éœ€è¦å…ˆå®‰è£…å¥½æœ‰è¿™ä¸ªè¦ç”¨çš„ç¼–è¾‘å™¨,ä¸€èˆ¬nanoæ˜¯è‡ªå¸¦ä¼šæœ‰çš„)
<ul>
<li>vim /path/to/your_python_file.pyæˆ–nano /path/to/your_python_file.pyï¼ˆvim å’Œ nano éƒ½æ˜¯æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œä½†æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒä»¬æ¥æŸ¥çœ‹ .py æ–‡ä»¶çš„å†…å®¹ã€‚åœ¨ vim æˆ– nano ä¸­ï¼Œæ‚¨å¯ä»¥æŒ‰ Esc é”®é€€å‡ºæŸ¥çœ‹æ¨¡å¼ï¼Œç„¶åè¾“å…¥ :q å‘½ä»¤é€€å‡ºç¼–è¾‘å™¨ï¼‰</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="26-vimç¼–è¾‘å™¨çš„ä½¿ç”¨">2.6 vimç¼–è¾‘å™¨çš„ä½¿ç”¨
</h3><ul>
<li>åˆå§‹æ¨¡å¼ï¼š
<ul>
<li>:w ä¿å­˜ä¸é€€å‡º</li>
<li>:q ä¸ä¿å­˜é€€å‡ºï¼Œä¸€èˆ¬ä¸wæ­é…:wqä¿å­˜å¹¶é€€å‡ºvimï¼Œå›åˆ°å‘½ä»¤è¡Œç•Œé¢</li>
<li>:! å¼ºåˆ¶æ€§æ“ä½œï¼Œä¸€èˆ¬ä¸qæ­é…:!q ä¸ºå¼ºåˆ¶é€€å‡ºä¸ä¿å­˜</li>
<li>/ + æ–‡æœ¬ æŸ¥æ‰¾å­—ç¬¦ä¸²å‘½ä»¤ï¼ŒæŸ¥æ‰¾å¤šä¸ªåŒ¹é…ç»“æœï¼Œå¯ä»¥né”®å‘ä¸‹æŸ¥æ‰¾ï¼ŒNå‘ä¸ŠæŸ¥æ‰¾ã€‚</li>
<li>set nu æ˜¾ç¤ºè¡Œæ•°ã€‚</li>
<li>set nonu ä¸æ˜¾ç¤ºè¡Œæ•°</li>
<li>sp + æ–‡ä»¶è·¯å¾„ å†æ‰“å¼€ä¸€ä¸ªçª—å£ï¼Œspè¡¨ç¤ºæ°´å¹³åˆ‡åˆ†çª—å£ï¼Œvsè¡¨ç¤ºå‚ç›´åˆ‡åˆ†çª—å£ã€‚</li>
<li>v è¿›å…¥è§†å›¾æ¨¡å¼</li>
<li>i/a è¿›å…¥ç¼–è¾‘æ¨¡å¼</li>
</ul>
</li>
<li>è§†å›¾æ¨¡å¼ï¼š
<ul>
<li>ä¸Šã€ä¸‹ã€å·¦ã€å³é”®æˆ–è€… kï¼ˆä¸Šï¼‰ã€jï¼ˆä¸‹ï¼‰ã€hï¼ˆå·¦ï¼‰ã€lï¼ˆå³ï¼‰ å‘½ä»¤è¿›è¡Œå…‰æ ‡ç§»åŠ¨å¹¶é€‰ä¸­æ–‡å­—</li>
<li>é€‰ä¸­æ–‡æœ¬åï¼Œdå‰ªåˆ‡ yå¤åˆ¶ pç²˜è´´</li>
<li>x åˆ é™¤å…‰æ ‡æ‰€åœ¨çš„å•ä¸ªå­—ç¬¦</li>
<li>dd åˆ é™¤ä¸€æ•´è¡Œï¼ˆç›¸å½“äºå‰ªåˆ‡ï¼‰ï¼Œp ç²˜è´´</li>
<li>yy å¤åˆ¶å•è¡Œ</li>
<li>u æ’¤é”€</li>
<li>EscæŒ‰é”® é€€å‡ºè§†å›¾æ¨¡å¼å›åˆ°åˆå§‹æ¨¡å¼</li>
</ul>
</li>
<li>ç¼–è¾‘æ¨¡å¼ï¼š
<ul>
<li>EscæŒ‰é”® é€€å‡ºè§†å›¾æ¨¡å¼å›åˆ°åˆå§‹æ¨¡å¼</li>
<li>å…¶ä»–æŒ‰é”®åˆ™æ­£å¸¸è¾“å…¥æ–‡æœ¬å³å¯</li>
</ul>
</li>
</ul>
<h2 id="3-ros2å­¦ä¹ ç¬”è®°">3. ROS2å­¦ä¹ ç¬”è®°
</h2><blockquote class="alert alert-tip">
    <p>å¤§éƒ¨åˆ†æ˜¯æœ¬äººçš„å­¦ä¹ ç¬”è®°ï¼Œå­¦ä¹ è§†é¢‘ä¸»è¦æ˜¯<a class="link" href="https://www.bilibili.com/video/BV1ky411e7hp/?spm_id_from=333.1387.favlist.content.click&amp;vd_source=b0f5272da83bbf0fd5569aa17bceb192"  target="_blank" rel="noopener"
    >é±¼é¦™ROSæœºå™¨äºº</a>ä»–çš„çŸ¥è¯†ç‚¹å’Œè§†é¢‘å†…å®¹å¾ˆè¯¦ç»†ï¼ŒçœŸçš„æ˜¯åœ¨å°è¯&quot;æˆäººä»¥é±¼ä¸å¦‚æˆäººä»¥æ¸”&quot;ã€‚æ­¤å¤–è¿˜ä¼šåŠ ä¸Šä¸€äº›ä¸ªäººç†è§£ï¼Œå¸Œæœ›èƒ½å¸®åŠ©åŠ æ·±ç†è§£ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼</p></blockquote>
<h3 id="31-ros2-run">3.1 ros2 run
</h3><blockquote class="alert alert-warn">
    <ul>
<li>(1). å‘½ä»¤<em>ros2 run</em>ä¼šä»ä¸€ä¸ªè½¯ä»¶åŒ…ä¸­å¯åŠ¨ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼š
<ul>
<li>ros2 run &lt;package_name&gt; &lt;executable_name&gt;</li>
</ul>
</li>
<li>(2). è§£é‡Šï¼š
<ul>
<li>egï¼šè¦è¿è¡Œturtlesimï¼Œè¯·æ‰“å¼€ä¸€ä¸ªæ–°çš„ç»ˆç«¯ï¼Œå¹¶è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š
<ul>
<li>ros2 run turtlesim turtlesim_node</li>
</ul>
</li>
<li>turtlesimçª—å£å°†ä¼šæ‰“å¼€</li>
<li>è¿™é‡Œï¼ŒåŒ…åæ˜¯ ä½¿ç”¨ <strong>turtlesim</strong> ï¼Œå¯æ‰§è¡Œæ–‡ä»¶åæ˜¯ <strong>turtlesim_node</strong></li>
<li>ç„¶è€Œï¼Œæˆ‘ä»¬è¿˜ä¸çŸ¥é“èŠ‚ç‚¹åç§°ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ ros2 node list å‘½ä»¤æŸ¥æ‰¾èŠ‚ç‚¹åç§°ã€‚</li>
</ul>
</li>
</ul></blockquote>
<h3 id="32-ros2-node-list">3.2. ros2 node list
</h3><blockquote class="alert alert-error">
    <ul>
<li>(1). <em>ros2 node list</em> å‘½ä»¤å°†æ˜¾ç¤ºæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„èŠ‚ç‚¹çš„åç§°ã€‚å½“æ‚¨æƒ³ä¸èŠ‚ç‚¹è¿›è¡Œäº¤äº’æˆ–è€…ç³»ç»Ÿè¿è¡Œå¤šä¸ªèŠ‚ç‚¹æ—¶éœ€è¦è·Ÿè¸ªå®ƒä»¬æ—¶ï¼Œè¿™ç‰¹åˆ«æœ‰ç”¨ã€‚</li>
<li>(2). è§£é‡Šï¼š <br>
<ul>
<li>(A). åœ¨å¦ä¸€ä¸ªç»ˆç«¯ä¸­æ‰“å¼€æ–°çš„ç»ˆç«¯ï¼ŒåŒæ—¶ turtlesim ä»åœ¨è¿è¡Œï¼Œè¯·è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š <br>
<ul>
<li>ros2 node list <br></li>
</ul>
</li>
<li>(B). ç»ˆç«¯å°†è¿”å›èŠ‚ç‚¹åç§°ï¼š <br>
<ul>
<li>/turtlesim <br></li>
</ul>
</li>
<li>(C). å†æ‰“å¼€ä¸€ä¸ªæ–°çš„ç»ˆç«¯ï¼Œå¹¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ teleop èŠ‚ç‚¹ï¼š <br>
<ul>
<li>ros2 run turtlesim turtle_teleop_key <br></li>
<li>ã€åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å†æ¬¡å¼•ç”¨äº†â€œturtlesimâ€è½¯ä»¶åŒ…ï¼Œä½†è¿™æ¬¡æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åä¸ºâ€œturtle_teleop_keyâ€çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‘<br></li>
</ul>
</li>
<li>(D). è¿”å›åˆ°ä¹‹å‰è¿è¡Œros2 node listçš„ç»ˆç«¯ï¼Œå†æ¬¡è¿è¡Œè¯¥å‘½ä»¤ã€‚ä½ å°†ä¼šçœ‹åˆ°ä¸¤ä¸ªæ´»åŠ¨èŠ‚ç‚¹çš„åç§°ï¼š<br>
<ul>
<li>/turtlesim <br></li>
<li>/teleop_turtle <br></li>
</ul>
</li>
</ul>
</li>
</ul></blockquote>
<h3 id="33-é‡æ˜ å°„">3.3. é‡æ˜ å°„
</h3><blockquote class="alert alert-warn">
    <ul>
<li>(1). <em>é‡æ˜ å°„</em>ï¼šå…è®¸ä½ é‡æ–°åˆ†é…é»˜è®¤èŠ‚ç‚¹å±æ€§ï¼Œå¦‚èŠ‚ç‚¹åç§°ã€è¯é¢˜åç§°ã€æœåŠ¡åç§°ç­‰ï¼Œä»¥è‡ªå®šä¹‰çš„å€¼ã€‚åœ¨ä¸Šä¸€ä¸ªæ•™ç¨‹ä¸­ï¼Œä½ åœ¨<strong>turtle_teleop_key</strong>ä¸Šä½¿ç”¨äº†é‡æ˜ å°„æ¥æ”¹å˜<strong>cmd_vel</strong>è¯é¢˜å’Œç›®æ ‡èŠ‚ç‚¹ä¸º<strong>turtle2</strong>ã€‚</li>
<li>(2). è§£é‡Šï¼š
- (A). ç°åœ¨ï¼Œè®©æˆ‘ä»¬é‡æ–°åˆ†é… <strong>/turtlesim</strong> èŠ‚ç‚¹çš„åç§°ã€‚åœ¨ä¸€ä¸ªæ–°çš„ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
- ros2 run turtlesim turtlesim_node &ndash;ros-args &ndash;remap __node:=my_turtle
- (B). ç”±äºæ‚¨å†æ¬¡è°ƒç”¨<strong>ros2 run</strong> å¯åŠ¨äº†turtlesimï¼Œå°†ä¼šæ‰“å¼€å¦ä¸€ä¸ªturtlesimçª—å£ã€‚ä½†æ˜¯ï¼Œç°åœ¨å¦‚æœæ‚¨è¿”å›åˆ°ä¹‹å‰è¿è¡Œ<strong>ros2 node list</strong>çš„ç»ˆç«¯ï¼Œå¹¶å†æ¬¡è¿è¡Œè¯¥å‘½ä»¤ï¼Œæ‚¨å°†çœ‹åˆ°ä¸‰ä¸ªèŠ‚ç‚¹åç§°ï¼š
- /my_turtle
- /turtlesim
- /teleop_turtle</li>
</ul></blockquote>
<h3 id="34-ros2èŠ‚ç‚¹ä¿¡æ¯">3.4. ros2èŠ‚ç‚¹ä¿¡æ¯
</h3><blockquote class="alert alert-error">
    <p><strong>(æ—¢ç„¶æ‚¨çŸ¥é“äº†èŠ‚ç‚¹çš„åç§°ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è®¿é—®æœ‰å…³å®ƒä»¬çš„æ›´å¤šä¿¡æ¯)</strong></p>
<ul>
<li>ros2 node info &lt;node_name&gt;
<ul>
<li>(ä¾‹). è¦æŸ¥çœ‹æ‚¨æœ€æ–°çš„èŠ‚ç‚¹<strong>my_turtle</strong>ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
<ul>
<li>ros2 node info /my_turtle</li>
<li><strong>ros2 node info</strong>è¿”å›è®¢é˜…è€…ã€å‘å¸ƒè€…ã€æœåŠ¡å’ŒåŠ¨ä½œçš„åˆ—è¡¨ï¼Œå³ä¸è¯¥èŠ‚ç‚¹è¿›è¡Œäº¤äº’çš„ROSå›¾è¿æ¥ã€‚è¾“å‡ºåº”è¯¥å¦‚ä¸‹æ‰€ç¤ºï¼š</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">/my_turtle
</span></span><span class="line"><span class="cl">Subscribers:
</span></span><span class="line"><span class="cl">  /parameter_events: rcl_interfaces/msg/ParameterEvent
</span></span><span class="line"><span class="cl">  /turtle1/cmd_vel: geometry_msgs/msg/Twist
</span></span><span class="line"><span class="cl">Publishers:
</span></span><span class="line"><span class="cl">  /parameter_events: rcl_interfaces/msg/ParameterEvent
</span></span><span class="line"><span class="cl">  /rosout: rcl_interfaces/msg/Log
</span></span><span class="line"><span class="cl">  /turtle1/color_sensor: turtlesim/msg/Color
</span></span><span class="line"><span class="cl">  /turtle1/pose: turtlesim/msg/Pose
</span></span><span class="line"><span class="cl">Service Servers:
</span></span><span class="line"><span class="cl">  /clear: std_srvs/srv/Empty
</span></span><span class="line"><span class="cl">  /kill: turtlesim/srv/Kill
</span></span><span class="line"><span class="cl">  /my_turtle/describe_parameters: rcl_interfaces/srv/DescribeParameters
</span></span><span class="line"><span class="cl">  /my_turtle/get_parameter_types: rcl_interfaces/srv/GetParameterTypes
</span></span><span class="line"><span class="cl">  /my_turtle/get_parameters: rcl_interfaces/srv/GetParameters
</span></span><span class="line"><span class="cl">  /my_turtle/list_parameters: rcl_interfaces/srv/ListParameters
</span></span><span class="line"><span class="cl">  /my_turtle/set_parameters: rcl_interfaces/srv/SetParameters
</span></span><span class="line"><span class="cl">  /my_turtle/set_parameters_atomically: rcl_interfaces/srv/SetParametersAtomically
</span></span><span class="line"><span class="cl">  /reset: std_srvs/srv/Empty
</span></span><span class="line"><span class="cl">  /spawn: turtlesim/srv/Spawn
</span></span><span class="line"><span class="cl">  /turtle1/set_pen: turtlesim/srv/SetPen
</span></span><span class="line"><span class="cl">  /turtle1/teleport_absolute: turtlesim/srv/TeleportAbsolute
</span></span><span class="line"><span class="cl">  /turtle1/teleport_relative: turtlesim/srv/TeleportRelative
</span></span><span class="line"><span class="cl">Service Clients: (none)
</span></span><span class="line"><span class="cl">Action Servers:
</span></span><span class="line"><span class="cl">  /turtle1/rotate_absolute: turtlesim/action/RotateAbsolute
</span></span><span class="line"><span class="cl">Action Clients: (none)
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul></blockquote>
<h3 id="35-ç¼–è¯‘è¿è¡Œcæ–‡ä»¶">3.5. ç¼–è¯‘è¿è¡ŒC++æ–‡ä»¶
</h3><blockquote class="alert alert-warn">
    <ul>
<li>
<p>(1). å…ˆåœ¨ç›®å½•ä¸‹ç¼–å†™CMakeFiles.txtï¼š</p>
<ul>
<li>ç¤ºä¾‹ï¼š
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">    <span class="n">cmake_minimum_required</span><span class="p">(</span><span class="n">VERSION</span> <span class="mf">3.8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">project</span><span class="p">(</span><span class="n">ros2_cpp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">add_executable</span><span class="p">(</span><span class="n">ros2_cpp_node</span> <span class="n">ros2_cpp_node</span><span class="o">.</span><span class="n">cpp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">find_package</span><span class="p">(</span><span class="n">rclcpp</span> <span class="n">REQUIRED</span><span class="p">)</span> <span class="c1"># ç›´æ¥æŸ¥æ‰¾åˆ°å¯¹åº”çš„å¤´æ–‡ä»¶å’Œåº“æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">    <span class="n">message</span><span class="p">(</span><span class="n">STATUS</span> <span class="err">$</span><span class="p">{</span><span class="n">rclcpp_INCLUDE_DIRS</span><span class="p">})</span> <span class="c1">#å¤´æ–‡ä»¶åŠrclcppä¾èµ–çš„å¤´æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">    <span class="n">message</span><span class="p">(</span><span class="n">STATUS</span> <span class="err">$</span><span class="p">{</span><span class="n">rclcpp_LIBRARIES</span><span class="p">})</span> <span class="c1">#åº“æ–‡ä»¶åŠrclcppä¾èµ–çš„åº“æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="n">target_include_directories</span><span class="p">(</span><span class="n">ros2_cpp_node</span> <span class="n">PUBLIC</span> <span class="err">$</span><span class="p">{</span><span class="n">rclcpp_INCLUDE_DIRS</span><span class="p">})</span> <span class="c1">#å¤´æ–‡ä»¶åŒ…å¥½åˆ°ros2_cpp_nodeæ–‡ä»¶å†…</span>
</span></span><span class="line"><span class="cl">    <span class="n">target_link_libraries</span><span class="p">(</span><span class="n">ros2_cpp_node</span> <span class="err">$</span><span class="p">{</span><span class="n">rclcpp_LIBRARIES</span><span class="p">})</span> <span class="c1">#åº“æ–‡ä»¶é“¾æ¥åˆ°ros2_cpp_nodeæ–‡ä»¶å†…       </span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p>(2). å†åœ¨å½“å‰ç›®å½•ä¸‹è¿è¡Œç»ˆç«¯å‘½ä»¤ï¼š</p>
<ul>
<li>cmake .</li>
<li>make ã€ä¹‹åä¼šç”Ÿæˆä¸€ä¸ªå¯ä»¥æ‰§è¡Œæ–‡ä»¶ä¸ºç»¿è‰²çš„ï¼Œç›´æ¥ç»ˆç«¯è¾“å…¥æ—¢å¯è¿è¡Œã€‘</li>
</ul>
</li>
</ul></blockquote>
<h3 id="36-åˆ›å»ºåŠŸèƒ½åŒ…">3.6. åˆ›å»ºåŠŸèƒ½åŒ…
</h3><blockquote class="alert alert-error">
    <ul>
<li>å…ˆåˆ›å»ºä¸€ä¸ªå·¥ä½œç©ºé—´ï¼Œç„¶åå†å·¥ä½œç©ºé—´ä¸‹æ–°å»ºsrcæ–‡ä»¶å¤¹ï¼Œè¿›å…¥srcæ–‡ä»¶å¤¹å†…è¿è¡Œï¼šros2 pkg create demo_python_topic &ndash;build-type ament_python &ndash;dependencies rclpy example_interfaces &ndash;license Apache-2.0ã€ä¸­é—´çš„&ndash;æ˜¯å¯é€‰é¡¹é…ç½®ï¼Œæœ‰ç¼–è¯‘ç‰ˆæœ¬ï¼Œæ·»åŠ çš„ä¾èµ–ï¼Œè®¸å¯è¯ï¼Œå­˜æ”¾ç›®å½•ç­‰ç­‰ã€‘</li>
<li>ç„¶åå†å›åˆ°å·¥ä½œç©ºé—´æ–‡ä»¶å¤¹å†…è¿è¡Œï¼šcolcon build</li>
<li>(âœ”ï¸). å¯ç”¨èŠ‚ç‚¹å‡½æ•°  setup.pyæ·»åŠ ï¼š
<ul>
<li>&lsquo;python_NODE = demo_python_pkg.pyhon_node:main&rsquo;, ã€ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶çš„åç§°ä»¥åŠåŒ…åå’Œè·¯å¾„ï¼Œå‡½æ•°åç§°ã€‘</li>
</ul>
</li>
<li>(âœ”ï¸). å°†éœ€è¦å¯¼å…¥çš„åº“åŠ å…¥åˆ°package.xmlåŠŸèƒ½åŒ…æ¸…å•æ–‡ä»¶çš„å£°æ˜é‡Œé¢å¯¼å…¥åŒ…ï¼Œæ·»åŠ ä¾èµ–ä¿¡æ¯ï¼š
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">depend</span><span class="o">&gt;</span><span class="n">rclpy</span><span class="o">&lt;/</span><span class="n">depend</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>(âœ”ï¸). æ·»åŠ å®Œä¹‹åéœ€è¦å¼€å¯æ„å»ºåŠŸèƒ½åŒ…ï¼šcolcon build ã€ç»ˆç«¯ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼Œæ‰§è¡Œå®Œä¹‹åæ˜¯ä¼šæ ¹æ®ä½ ä¹‹å‰é…ç½®çš„è°ƒç”¨å‡½æ•°æ‹·è´å¤åˆ¶ä¸€ä»½ä¸€æ¨¡ä¸€æ ·çš„.pyæ–‡ä»¶ï¼Œç„¶åè¿è¡Œè°ƒç”¨çš„æ˜¯å¤åˆ¶è¿‡æ¥çš„æ–‡ä»¶ï¼Œä¸æ˜¯åŸæ¥çš„æœ¬èº«çš„æ–‡ä»¶ï¼Œæ‰€ä»¥åç»­å†™äº†æ›´æ–°ä¹‹åå®ƒçš„åŒ…è°ƒç”¨çš„æ˜¯ä½ ä¸Šä¸€æ¬¡æ‹·è´çš„ï¼Œä¸æ˜¯ä½ æ–°å†™çš„ã€‘</li>
<li>(âœ”ï¸). ä¿®æ”¹ç¯å¢ƒå˜é‡ï¼šsource install/setup.bashã€æ­¤æ–‡ä»¶æ˜¯åˆ›å»ºæ—¶ç”Ÿæˆçš„ã€‘<br>
<ul>
<li>æˆ–è€…ä¹Ÿå¯ä»¥æ‰‹åŠ¨æ·»åŠ è¿™ä¸ªç¯å¢ƒå˜é‡ï¼š
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">  <span class="n">export</span> <span class="n">PYTHONPATH</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">robot</span><span class="o">/</span><span class="n">chapt2</span><span class="o">/</span><span class="n">install</span><span class="o">/</span><span class="n">demo_python_pkg</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.12</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="p">:</span><span class="err">$</span><span class="n">PYTHONPATH</span> <span class="c1"># $PYTHONPATHè¡¨ç¤ºåŸæ¥çš„è·¯å¾„ä¸å˜ï¼Œç¼©å†™ï¼Œç„¶ååŠ ï¼šå‰é¢åŠ éœ€è¦æ·»åŠ çš„è·¯å¾„</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
</li>
</ul></blockquote>
<h3 id="37-å…¶ä»–">3.7. å…¶ä»–
</h3><blockquote class="alert alert-warn">
    <ul>
<li>(A). <strong>echo</strong>
<ul>
<li>ğŸ”µæŸ¥çœ‹å½“å‰ROS1/ROS2ï¼šecho $ROS_VERSIONã€ä¸­é—´æœ‰ä¸ªä¸‹åˆ’çº¿ã€‘</li>
<li>ğŸ”µæŸ¥çœ‹å½“å‰ROSç‰ˆæœ¬ï¼šecho $ROS_DISTRO</li>
</ul>
</li>
<li>(B). <strong>æ€»çš„æ‰“å°ç¯å¢ƒå˜é‡ä¿¡æ¯</strong>
<ul>
<li>ğŸŸ¡printenv
<ul>
<li>æ‰“å°ç‰¹å®šçš„ä¿¡æ¯ï¼Œè¿›è¡Œä¿¡æ¯è¿‡æ»¤ï¼šprintenv | grep æƒ³è¦æ‰“å°çš„ç¯å¢ƒå˜é‡</li>
</ul>
</li>
</ul>
</li>
<li>(C). <strong>ä¿®æ”¹ç¯å¢ƒå˜é‡çš„æ–‡ä»¶ä½ç½®</strong>
<ul>
<li>ğŸŸ£export ç¯å¢ƒå˜é‡åç§°=æƒ³è¦ä¿®æ”¹çš„æ–‡ä»¶ä½ç½®ï¼ˆä»…åœ¨å½“å‰ç»ˆç«¯ä¸´æ—¶ä¿®æ”¹æˆæ•ˆï¼Œå†å¦å¼€è¿˜æ˜¯åŸæ¥çš„ç¯å¢ƒä½ç½®ï¼‰</li>
</ul>
</li>
<li>(D). åœ¨linuxä¸­ï¼Œä»¥.å¼€å¤´çš„æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹ï¼Œæ˜¯éšè—æ–‡ä»¶
<ul>
<li>ğŸ”´(ä¾‹). å¯åŠ¨è‡ªè¿è¡Œè„šæœ¬ï¼š~/.bashrc</li>
</ul>
</li>
<li>(E). å®‰è£…pythonæ’ä»¶åœ¨vscodeä¸­çš„ä»£ç æ³¨é‡ŠctrlåŠ å·¦é”®ï¼Œæˆ–è€…é•¿æ”¾æç¤ºçš„æ³¨é‡Šå½¢å¼</li>
<li>(F). å¢åŠ å¯æ‰§è¡Œæ–‡ä»¶çš„æ‰§è¡Œæƒé™ï¼Œç™½è‰²ä¸ºè¾ƒä½æƒé™ï¼Œç»¿è‰²ä¸ºè¾ƒé«˜æƒé™å¯è¿›è¡Œæ‰§è¡Œï¼š
<ul>
<li>ğŸŸ chmod a+x æ–‡ä»¶å</li>
</ul>
</li>
<li>(G). æŸ¥çœ‹èŠ‚ç‚¹çš„å…·ä½“ä¿¡æ¯
<ul>
<li>âš«ros2 node info /èŠ‚ç‚¹åç§°</li>
</ul>
</li>
<li>æ‰“å°ç›®æ ‡è¯é¢˜çš„ä¿¡æ¯
<ul>
<li>ros2 topic echo ç›®æ ‡è¯é¢˜çš„åç§°</li>
</ul>
</li>
<li>æŸ¥çœ‹è¯é¢˜çš„è¯¦ç»†ä¿¡æ¯
<ul>
<li>ros2 topic info ç›®æ ‡è¯é¢˜çš„åç§°</li>
</ul>
</li>
<li>æ‰“å°è¯é¢˜çš„æŸä¸ªæ¥å£çš„è¯¦ç»†ä¿¡æ¯
<ul>
<li>ros2 interface show æ¥å£åç§°</li>
</ul>
</li>
<li>å‘å¸ƒä¸€ä¸ªè¯é¢˜
<ul>
<li>ros2 topic pub <strong>/turtle1/cmd_vel geometry_msgs/msg/Twist &ldquo;{linear: {x: 0.4, y: 0.0} , angular: {z: 0.0}}&rdquo;</strong>    ã€è¯é¢˜åç§°ï¼‹æ¥å£åç§°ï¼‹å‘å¸ƒä¿¡æ¯ã€‘<br>
<img src="/p/linux_learn/13.png"
	width="2032"
	height="1241"
	srcset="/p/linux_learn/13_hu_4d857d2b04241dca.png 480w, /p/linux_learn/13_hu_4d2b2a4ab2e07ded.png 1024w"
	loading="lazy"
	
		alt="ç¤ºä¾‹æ•ˆæœå›¾"
	
	
		class="gallery-image" 
		data-flex-grow="163"
		data-flex-basis="392px"
	
></li>
</ul>
</li>
<li>æ‰“å°å½“å‰è¯é¢˜åˆ—è¡¨
<ul>
<li>ros2 topic list</li>
</ul>
</li>
</ul></blockquote>
<h3 id="38-å·¥ä½œç©ºé—´workplace">3.8 å·¥ä½œç©ºé—´(WorkPlace)
</h3><ul>
<li>åˆ›å»ºä½¿ç”¨å·¥ä½œç©ºé—´
<ul>
<li>mkdir -p chapt2_ws/src ã€-pè¡¨ç¤ºåˆ›å»ºç›®å½•ä¸‹çš„æ–‡ä»¶å¤¹ã€‘</li>
<li>mv demo_cpp_pkg/ chapt2_ws/src/ã€å°†è¦æ•´åˆçš„åŒ…å‰ªåˆ‡ç§»åŠ¨åˆ°å·¥ä½œç©ºé—´ä¸‹ã€‘</li>
<li>mv demo_cpp_pkg/ chapt2_ws/src/</li>
<li>cd chapt2_ws/ã€è¿›å…¥å·¥ä½œç©ºé—´å†æ„å»ºä¸»ï¼Œä¿è¯æ¶æ„çš„æ¸…æ™°å®Œæ•´ã€‘</li>
<li>colcon build ã€æ„å»ºã€‘</li>
<li>å¦‚æœæœ‰åŠŸèƒ½åŒ…çš„ä¾èµ–å…³ç³»éœ€è¦æ›´æ”¹æ„å»ºé¡ºåºå°±åœ¨å¯¹åº”éœ€è¦ä¾èµ–çš„package.xmlæ–‡ä»¶å†…æ·»åŠ å¯¹åº”çš„ä¾èµ–åŒ…æ—¢å¯ï¼Œç³»ç»Ÿå°±ä¼šå…ˆç¼–è¯‘æ„å»ºè¢«ä¾èµ–çš„åŒ…
<ul>
<li><depend>è¢«ä¾èµ–çš„åŒ…å</depend></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="39-pythonå­¦ä¹ ">3.9 Pythonå­¦ä¹ 
</h3><ul>
<li>ç®€å•çš„ç±»å’Œå‡½æ•°ä»¥åŠinitæ–¹æ³•çš„ç†è§£
<ul>
<li>ç¤ºä¾‹ä»£ç ï¼š
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">  <span class="k">class</span> <span class="nc">PersonNode</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name_value</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">age_value</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">          <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PersonNode __init__æ–¹æ³•è¢«è°ƒç”¨å¹¶ä¸”è¿˜æ·»åŠ äº†ä¸¤ä¸ªå±æ€§ï¼&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="n">name_value</span>
</span></span><span class="line"><span class="cl">          <span class="bp">self</span><span class="o">.</span><span class="n">age</span><span class="o">=</span><span class="n">age_value</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">def</span> <span class="nf">eat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">food_name</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">          æ–¹æ³•ï¼šåƒä¸œè¥¿
</span></span></span><span class="line"><span class="cl"><span class="s2">          :food_name é£Ÿç‰©åå­—
</span></span></span><span class="line"><span class="cl"><span class="s2">          &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">          <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">age</span><span class="si">}</span><span class="s2">å²ï¼Œçˆ±åƒ</span><span class="si">{</span><span class="n">food_name</span><span class="si">}</span><span class="s2">ï¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">      <span class="n">node</span> <span class="o">=</span> <span class="n">PersonNode</span><span class="p">(</span><span class="s1">&#39;æ³•å¤–ç‹‚å¾’å¼ ä¸‰&#39;</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">node2</span> <span class="o">=</span> <span class="n">PersonNode</span><span class="p">(</span><span class="s1">&#39;æ³•å¤–ç‹‚å¾’é‡Œæ–¯&#39;</span><span class="p">,</span><span class="mi">19</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">node</span><span class="o">.</span><span class="n">eat</span><span class="p">(</span><span class="s1">&#39;é»„ç„–é¸¡ç±³é¥­&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">node2</span><span class="o">.</span><span class="n">eat</span><span class="p">(</span><span class="s1">&#39;é±¼é¦™è‚‰ä¸&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>ç®€å•çš„ç»§æ‰¿æ€æƒ³
<ul>
<li>ç¤ºä¾‹ä»£ç ï¼š
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">rclpy</span>
</span></span><span class="line"><span class="cl">  <span class="kn">from</span> <span class="nn">rclpy.node</span> <span class="kn">import</span> <span class="n">Node</span> <span class="c1">#å€’å…¥Nodeç±»</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">class</span> <span class="nc">PersonNode</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span><span class="c1">#æ­¤å¤„çš„Nodeå°±æ˜¯ç»§æ‰¿äºå¯¼å…¥çš„rclpy.nodeé‡Œé¢çš„Nodeç±»</span>
</span></span><span class="line"><span class="cl">      <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">node_name</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">name_value</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">age_value</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">          <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PersonNode __init__æ–¹æ³•è¢«è°ƒç”¨å¹¶ä¸”è¿˜æ·»åŠ äº†ä¸¤ä¸ªå±æ€§ï¼&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span> <span class="c1">#åˆå§‹åŒ–èŠ‚ç‚¹</span>
</span></span><span class="line"><span class="cl">          <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="n">name_value</span>
</span></span><span class="line"><span class="cl">          <span class="bp">self</span><span class="o">.</span><span class="n">age</span><span class="o">=</span><span class="n">age_value</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">def</span> <span class="nf">eat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">food_name</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">          æ–¹æ³•ï¼šåƒä¸œè¥¿
</span></span></span><span class="line"><span class="cl"><span class="s2">          :food_name é£Ÿç‰©åå­—
</span></span></span><span class="line"><span class="cl"><span class="s2">          &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">          <span class="c1"># print(f&#34;{self.name},{self.age}å²ï¼Œçˆ±åƒ{food_name}ï¼&#34;)</span>
</span></span><span class="line"><span class="cl">          <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">age</span><span class="si">}</span><span class="s2">å²ï¼Œçˆ±åƒ</span><span class="si">{</span><span class="n">food_name</span><span class="si">}</span><span class="s2">ï¼&#34;</span><span class="p">)</span> <span class="c1">#å°†å†…å®¹æ·»åŠ åˆ°rosæ—¥å¿—é‡Œé¢å¹¶ä¸”æ‰“å°</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclpy</span><span class="o">.</span><span class="n">init</span><span class="p">()</span> <span class="c1">#ä½¿ç”¨ros2å‰éœ€è¦æ‰§è¡Œinitåˆå§‹åŒ–èµ„æºé…ç½®</span>
</span></span><span class="line"><span class="cl">      <span class="n">node</span> <span class="o">=</span> <span class="n">PersonNode</span><span class="p">(</span><span class="s1">&#39;zhangsan_node&#39;</span><span class="p">,</span><span class="s1">&#39;æ³•å¤–ç‹‚å¾’å¼ ä¸‰&#39;</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">node</span><span class="o">.</span><span class="n">eat</span><span class="p">(</span><span class="s1">&#39;é»„ç„–é¸¡ç±³é¥­&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclpy</span><span class="o">.</span><span class="n">spin</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="c1">#æ”¶é›†èŠ‚ç‚¹æ•°æ®</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclpy</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span> <span class="c1">#å…³é—­èŠ‚ç‚¹</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>å¤šçº¿ç¨‹åŠå›è°ƒå‡½æ•°
<ul>
<li>ç¤ºä¾‹ä»£ç ï¼š</li>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">threading</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">class</span> <span class="nc">Download</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="n">sel</span><span class="p">,</span><span class="n">url</span><span class="p">,</span><span class="n">callback_word_count</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;çº¿ç¨‹ï¼š</span><span class="si">{</span><span class="n">threading</span><span class="o">.</span><span class="n">get_ident</span><span class="p">()</span><span class="si">}</span><span class="s2">å¼€å§‹ä¸‹è½½ï¼š</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="n">response</span><span class="o">.</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span> <span class="c1">#ç»™è¯·æ±‚çš„ç»“æœä¸€ä¸ªç¼–ç </span>
</span></span><span class="line"><span class="cl">          <span class="n">callback_word_count</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="c1">#è°ƒç”¨å›è°ƒå‡½æ•°</span>
</span></span><span class="line"><span class="cl">          <span class="c1">#pass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">def</span> <span class="nf">start_download</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">url</span><span class="p">,</span><span class="n">callback_word_count</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">          <span class="n">thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">download</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">callback_word_count</span><span class="p">))</span> <span class="c1">#åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹  targetç›®æ ‡å‡½æ•°ï¼Œargséœ€è¦ä¼ å…¥çš„å‚æ•°</span>
</span></span><span class="line"><span class="cl">          <span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span> <span class="c1">#å¯åŠ¨çº¿ç¨‹</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="c1"># pass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">world_count</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">result</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">      æ™®é€šçš„å‡½æ•°ï¼Œç”¨äºå›è°ƒ
</span></span></span><span class="line"><span class="cl"><span class="s2">      &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="si">}</span><span class="s2">-&gt;</span><span class="si">{</span><span class="n">result</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">      <span class="n">download</span> <span class="o">=</span> <span class="n">Download</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">      <span class="n">download</span><span class="o">.</span><span class="n">start_download</span><span class="p">(</span><span class="s1">&#39;urlç½‘å€&#39;</span><span class="p">,</span><span class="n">world_count</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">download</span><span class="o">.</span><span class="n">start_download</span><span class="p">(</span><span class="s1">&#39;urlç½‘å€&#39;</span><span class="p">,</span><span class="n">world_count</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">download</span><span class="o">.</span><span class="n">start_download</span><span class="p">(</span><span class="s1">&#39;urlç½‘å€&#39;</span><span class="p">,</span><span class="n">world_count</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="310-cå­¦ä¹ ">3.10 C++å­¦ä¹ 
</h3><ul>
<li>C++ vscodeçš„æ‰©å±•é‡åˆ°includeæŠ¥é”™æ‰¾ä¸åˆ°è·¯å¾„å°±åœ¨ä»–æ‰©å±•é…ç½®ä¸­æ·»åŠ ç±»ä¼¼ï¼š/opt/ros/jazzy/include/**</li>
<li>ä¾æ®ç±»ä¼¼çš„é¢å‘å¯¹è±¡ç¼–ç¨‹åŸç†ï¼Œä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š
<ul>
<li>ç¤ºä¾‹ä»£ç ï¼š
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">  <span class="cp">#include</span> <span class="cpf">&#34;rclcpp/rclcpp.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl">  <span class="c1">// å®šä¹‰ä¸€ä¸ªPersionNodeçš„ç±»å¹¶ä¸”ç»§æ‰¿rclcppçš„Nodeä½œä¸ºçˆ¶ç±»
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">class</span> <span class="nc">PersonNode</span> <span class="o">:</span> <span class="k">public</span> <span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// å£°æ˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="kt">int</span> <span class="n">age_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">PersonNode</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">node_name</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">name</span><span class="p">,</span> <span class="k">const</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">age</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="o">:</span> <span class="n">Node</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span> <span class="cm">/*è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œç­‰åŒäºpythonä¸­çš„ super().__init__(),ä¼ å…¥èŠ‚ç‚¹çš„åç§°ä½œä¸ºå‚æ•°*/</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="k">this</span><span class="o">-&gt;</span><span class="n">name_</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="k">this</span><span class="o">-&gt;</span><span class="n">age_</span> <span class="o">=</span> <span class="n">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="kt">void</span> <span class="nf">eat</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">food_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span> <span class="s">&#34;æˆ‘æ˜¯%s,%då²äº†,çˆ±åƒ%s&#34;</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">name_</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">age_</span><span class="p">,</span> <span class="n">food_name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">      <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">auto</span> <span class="n">node</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">PersonNode</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;persion_node&#34;</span><span class="p">,</span> <span class="s">&#34;å°è¿‡&#34;</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">node</span><span class="o">-&gt;</span><span class="n">eat</span><span class="p">(</span><span class="s">&#34;é»„ç„–é¸¡ç±³é¥­&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">spin</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">shutdown</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
<li>å°†ä»£ç æ·»åŠ åˆ°src/ç›®å½•ä¸‹åˆ›å»ºçš„person_node.cppæ–‡ä»¶å†…ï¼Œç¼–å†™å¥½åå†åˆ°CmkeList.txtæ–‡ä»¶å†…æ·»åŠ æŒ‡å®šè¾“å‡ºçš„å¯æ‰§è¡Œæ–‡ä»¶åå’Œéœ€è¦è¿æ¥çš„åŒ…åä»¥åŠæ‰§è¡Œç¼–è¯‘</li>
<li>æœ€ç»ˆè¿›å…¥åˆ°CmkeList.txtç›®å½•ç»“æ„ä¸‹ï¼ˆä¾‹å¦‚å›¾ç‰‡ä¸­çš„ç›®å½•åº”è¿›å…¥chart2_ws/ï¼‰è¿è¡Œ
<ul>
<li>colcon build #ç¼–è¯‘</li>
<li>source install/setup.bash</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="/p/linux_learn/11.png"
	width="2024"
	height="1179"
	srcset="/p/linux_learn/11_hu_b2d9078a7d21032e.png 480w, /p/linux_learn/11_hu_7886eff87a9378b9.png 1024w"
	loading="lazy"
	
		alt="ç›®å½•æ¡†æ¶å›¾"
	
	
		class="gallery-image" 
		data-flex-grow="171"
		data-flex-basis="412px"
	
></p>
<p><img src="/p/linux_learn/10.png"
	width="2037"
	height="1209"
	srcset="/p/linux_learn/10_hu_1e7c8f185de0c4cd.png 480w, /p/linux_learn/10_hu_f4f4565c3a919bac.png 1024w"
	loading="lazy"
	
		alt="CmkeList.txtå†…å®¹ç¤ºæ„å›¾"
	
	
		class="gallery-image" 
		data-flex-grow="168"
		data-flex-basis="404px"
	
></p>
<ul>
<li>C++æ–°ç‰¹æ€§
<ul>
<li>autoè‡ªåŠ¨ç±»å‹æ¨å¯¼ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">  <span class="cp">#include</span> <span class="cpf">&#34;iostream&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">//auto çš„è‡ªåŠ¨ç±»å‹æ¨å¯¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="k">auto</span> <span class="n">xn</span> <span class="o">=</span> <span class="mi">2</span> <span class="p">;</span> <span class="c1">//int xn = 2;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="k">auto</span> <span class="n">yn</span> <span class="o">=</span> <span class="mf">3.14f</span><span class="p">;</span> <span class="c1">//float yn = 3.1415;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="k">auto</span> <span class="n">zn</span> <span class="o">=</span> <span class="sc">&#39;a&#39;</span><span class="p">;</span><span class="c1">//char zn = &#39;a&#39;;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">xn</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">yn</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">zn</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
<li>å…±äº«æŒ‡é’ˆ
<ul>
<li>ä½¿ç”¨å…±äº«æŒ‡é’ˆä¸è¦ç”¨é‡å¤æ–°å¢å†…å­˜åœ°å€ï¼Œå¹¶ä¸”å¯ä»¥è‡ªåŠ¨å›æ”¶ä¸ä¼šé€ æˆå†…å­˜æ³„æ¼ï¼Œä¾‹å¦‚ä¸‹é¢çš„make_sharedä¾‹å­ï¼š
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">  <span class="cp">#include</span> <span class="cpf">&#34;iostream&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&#34;memory&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">auto</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;This is a str.&#34;</span><span class="p">);</span> <span class="c1">// std::make_shared&lt;æ•°æ®ç±»å‹/ç±»&gt;ï¼ˆå‚æ•°ï¼‰ï¼›è¿”å›å€¼ï¼Œå¯¹åº”çš„å…±äº«æŒ‡é’ˆ std::shared_ptr&lt;std::string&gt; å†™æˆ auto
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;p1çš„å¼•ç”¨è®¡æ•°&#34;</span><span class="o">&lt;&lt;</span> <span class="n">p1</span><span class="p">.</span><span class="n">use_count</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&#34;,æŒ‡å‘å†…å­˜åœ°å€ï¼š&#34;</span><span class="o">&lt;&lt;</span><span class="n">p1</span><span class="p">.</span><span class="n">get</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="c1">// 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">      <span class="k">auto</span> <span class="n">p2</span> <span class="o">=</span><span class="n">p1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;p1çš„å¼•ç”¨è®¡æ•°&#34;</span><span class="o">&lt;&lt;</span> <span class="n">p1</span><span class="p">.</span><span class="n">use_count</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&#34;,æŒ‡å‘å†…å­˜åœ°å€ï¼š&#34;</span><span class="o">&lt;&lt;</span><span class="n">p1</span><span class="p">.</span><span class="n">get</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="c1">// 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;p2çš„å¼•ç”¨è®¡æ•°&#34;</span><span class="o">&lt;&lt;</span> <span class="n">p2</span><span class="p">.</span><span class="n">use_count</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&#34;,æŒ‡å‘å†…å­˜åœ°å€ï¼š&#34;</span><span class="o">&lt;&lt;</span><span class="n">p2</span><span class="p">.</span><span class="n">get</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="c1">// 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">      <span class="n">p1</span><span class="p">.</span><span class="n">reset</span><span class="p">();</span> <span class="c1">//é‡Šæ”¾å¼•ç”¨ï¼Œä¸æŒ‡å‘â€œThis is a str.â€æ‰€åœ¨å†…å­˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;p1çš„å¼•ç”¨è®¡æ•°&#34;</span><span class="o">&lt;&lt;</span> <span class="n">p1</span><span class="p">.</span><span class="n">use_count</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&#34;,æŒ‡å‘å†…å­˜åœ°å€ï¼š&#34;</span><span class="o">&lt;&lt;</span><span class="n">p1</span><span class="p">.</span><span class="n">get</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="c1">// 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;p2çš„å¼•ç”¨è®¡æ•°&#34;</span><span class="o">&lt;&lt;</span> <span class="n">p2</span><span class="p">.</span><span class="n">use_count</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&#34;,æŒ‡å‘å†…å­˜åœ°å€ï¼š&#34;</span><span class="o">&lt;&lt;</span><span class="n">p2</span><span class="p">.</span><span class="n">get</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="c1">// 2-1=1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">      <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;p2çš„æŒ‡å‘å†…å­˜åœ°å€ï¼š&#34;</span><span class="o">&lt;&lt;</span><span class="n">p2</span><span class="o">-&gt;</span><span class="n">c_str</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="c1">// è°ƒç”¨æˆå‘˜æ–¹æ³•  This is a str.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>åŒ¿åå‡½æ•°
<ul>
<li>
<p>æ¢ä¸€ç§è¯­æ³•çš„å‡½æ•° ä¸‹é¢lambdaå‡½æ•°ç¤ºä¾‹ä»£ç ï¼š</p>
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">  <span class="cp">#include</span> <span class="cpf">&#34;iostream&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">    
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">auto</span> <span class="n">add</span> <span class="o">=</span> <span class="p">[](</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span><span class="kt">int</span> <span class="n">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="p">{</span><span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">;};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">50</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">auto</span> <span class="n">print_sum</span> <span class="o">=</span> <span class="p">[</span><span class="n">sum</span><span class="p">]()</span> <span class="o">-&gt;</span> <span class="kt">void</span> <span class="c1">//æ­¤å¤„ç›´æ¥å°†sumå†…å®¹è°ƒç”¨è¿‡æ¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">sum</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">      <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="n">print_sum</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>å‡½æ•°åŒ…è£…å™¨ï¼Œç†è§£ä¸‹é¢ç¤ºä¾‹ä»£ç ï¼š</p>
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">  <span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&lt;functional&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl">  <span class="c1">// è‡ªç”±å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">void</span> <span class="nf">save_with_free_fun</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">file_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;è‡ªç”±å‡½æ•°ï¼š&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">file_name</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// æˆå‘˜å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">class</span> <span class="nc">FileSave</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">FileSave</span><span class="p">(</span><span class="cm">/* args */</span><span class="p">)</span> <span class="o">=</span> <span class="k">default</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="o">~</span><span class="n">FileSave</span><span class="p">()</span> <span class="o">=</span> <span class="k">default</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="kt">void</span> <span class="nf">save_with_member_fun</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">file_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;æˆå‘˜æ–¹æ³•ï¼š&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">file_name</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">FileSave</span> <span class="n">file_save</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="c1">// Lambdaå‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="k">auto</span> <span class="n">save_with_lambda_fun</span> <span class="o">=</span> <span class="p">[](</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">file_name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">void</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Lambda å‡½æ•°ï¼š&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">file_name</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="c1">//å¸¸è§çš„æ™®é€šå‡½æ•°è°ƒç”¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">      <span class="c1">// save_with_lambda_fun(&#34;file.txt&#34;);           // Lambdaå‡½æ•°çš„è°ƒç”¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// file_save.save_with_member_fun(&#34;file.txt&#34;); // æˆå‘˜å‡½æ•°çš„è°ƒç”¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// save_with_free_fun(&#34;file.txt&#34;);             // è‡ªç”±å‡½æ•°çš„è°ƒç”¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">      <span class="c1">//ä½¿ç”¨å‡½æ•°åŒ…è£…å™¨ä¹‹åçš„ï¼š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">      <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">save1</span><span class="o">=</span><span class="n">save_with_free_fun</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">save2</span><span class="o">=</span><span class="n">save_with_lambda_fun</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="c1">//æˆå‘˜å‡½æ•°ï¼Œæ”¾å…¥åŒ…è£…å™¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">save3</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">FileSave</span><span class="o">::</span><span class="n">save_with_member_fun</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="o">&amp;</span><span class="n">file_save</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">_1</span><span class="p">);</span> <span class="c1">//ä¿æŠ¤ç±»çš„å…¶ä»–æ–¹æ³•ä¸è¢«è°ƒç”¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">      <span class="c1">//ç»Ÿä¸€çš„è°ƒç”¨æ–¹æ³•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="n">save1</span><span class="p">(</span><span class="s">&#34;file.txt&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">save2</span><span class="p">(</span><span class="s">&#34;file.txt&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">save3</span><span class="p">(</span><span class="s">&#34;file.txt&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="311-å¤šçº¿ç¨‹ä»¥åŠå›è°ƒå‡½æ•°">3.11 å¤šçº¿ç¨‹ä»¥åŠå›è°ƒå‡½æ•°
</h3><p><img src="/p/linux_learn/12.png"
	width="1030"
	height="691"
	srcset="/p/linux_learn/12_hu_c12a5fe78c860f76.png 480w, /p/linux_learn/12_hu_56508aaa6df21af8.png 1024w"
	loading="lazy"
	
		alt="å‡½æ•°åŒ…è£…å™¨"
	
	
		class="gallery-image" 
		data-flex-grow="149"
		data-flex-basis="357px"
	
></p>
<ul>
<li>C++å…·ä½“(æœ‰å…³httpæœåŠ¡çš„è¯·æ±‚ç­‰éƒ¨åˆ†è¾ƒä¸ºå¤æ‚ï¼Œè¯¦ç»†è¯·çœ‹<a class="link" href="https://www.bilibili.com/video/BV18mWjeEEXS/?spm_id_from=333.1391.0.0&amp;vd_source=b0f5272da83bbf0fd5569aa17bceb192"  target="_blank" rel="noopener"
    >ROS2 å°é±¼</a>) ã€æ‰“å¼€httpæœåŠ¡ï¼špython3 -m http.serverã€‘
<ul>
<li>ç¤ºä¾‹ä»£ç ï¼š
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">  <span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&lt;thread&gt;</span><span class="cp"> </span><span class="c1">//å¤šçº¿ç¨‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="cp">#include</span> <span class="cpf">&lt;chrono&gt;</span><span class="cp">  </span><span class="c1">//æ—¶é—´ç›¸å…³
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="cp">#include</span> <span class="cpf">&lt;functional&gt;</span><span class="cp"> </span><span class="c1">//å‡½æ•°åŒ…è£…å™¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="cp">#include</span> <span class="cpf">&#34;cpp-httplib/httplib.h&#34;</span><span class="cp"> </span><span class="c1">//ä¸‹è½½ç›¸å…³
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">class</span> <span class="nc">Download</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="cm">/* data */</span>
</span></span><span class="line"><span class="cl">  <span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="kt">void</span> <span class="n">download</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">host</span><span class="p">,</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">path</span><span class="p">,</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="p">,</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">callback_word_count</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;çº¿ç¨‹&#34;</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">this_thread</span><span class="o">::</span><span class="n">get_id</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="n">httplib</span><span class="o">::</span><span class="n">Client</span> <span class="n">client</span><span class="p">(</span><span class="n">host</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="k">auto</span> <span class="n">response</span><span class="o">=</span><span class="n">client</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="k">if</span><span class="p">(</span><span class="n">response</span><span class="o">&amp;&amp;</span><span class="n">response</span><span class="o">-&gt;</span><span class="n">status</span><span class="o">==</span><span class="mi">200</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="n">callback_word_count</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">response</span><span class="o">-&gt;</span><span class="n">body</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">};</span>
</span></span><span class="line"><span class="cl">      <span class="kt">void</span> <span class="nf">start_download</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">host</span><span class="p">,</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">path</span><span class="p">,</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="p">,</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">callback_word_count</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="k">auto</span> <span class="n">download_fun</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Download</span><span class="o">::</span><span class="n">download</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">_1</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">_2</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">_3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="n">std</span><span class="o">::</span><span class="kr">thread</span> <span class="kr">thread</span><span class="p">(</span><span class="n">download_fun</span><span class="p">,</span><span class="n">host</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">callback_word_count</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="kr">thread</span><span class="p">.</span><span class="n">detach</span><span class="p">();</span> <span class="c1">//çº¿ç¨‹åˆ†ç¦»ï¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">};</span>    
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">auto</span> <span class="n">d</span><span class="o">=</span><span class="n">Download</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="k">auto</span> <span class="n">word_count</span> <span class="o">=</span><span class="p">[](</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">path</span><span class="p">,</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">result</span><span class="p">)</span> <span class="o">-&gt;</span><span class="kt">void</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;ä¸‹è½½å®Œæˆ&#34;</span><span class="o">&lt;&lt;</span><span class="n">path</span><span class="o">&lt;&lt;</span><span class="s">&#34;:&#34;</span><span class="o">&lt;&lt;</span><span class="n">result</span><span class="p">.</span><span class="n">length</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&#34;-&gt;&#34;</span><span class="o">&lt;&lt;</span><span class="n">result</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="n">d</span><span class="p">.</span><span class="n">start_download</span><span class="p">(</span><span class="s">&#34;hoståŸŸå&#34;</span><span class="p">,</span><span class="s">&#34;path1åœ°å€&#34;</span><span class="p">,</span><span class="n">word_count</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">d</span><span class="p">.</span><span class="n">start_download</span><span class="p">(</span><span class="s">&#34;hoståŸŸå&#34;</span><span class="p">,</span><span class="s">&#34;path2åœ°å€&#34;</span><span class="p">,</span><span class="n">word_count</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">d</span><span class="p">.</span><span class="n">start_download</span><span class="p">(</span><span class="s">&#34;hoståŸŸå&#34;</span><span class="p">,</span><span class="s">&#34;path3åœ°å€&#34;</span><span class="p">,</span><span class="n">word_count</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="n">std</span><span class="o">::</span><span class="n">this_thread</span><span class="o">::</span><span class="n">sleep_for</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">milliseconds</span><span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="mi">100</span><span class="p">));</span><span class="c1">//ä¼‘çœ 10s
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
<h3 id="312-è¯é¢˜">3.12 è¯é¢˜
</h3><ul>
<li>è¯é¢˜çš„å‘å¸ƒ
<ul>
<li>ç¤ºä¾‹pythonèŠ‚ç‚¹ä»£ç å‘å¸ƒè¯é¢˜ï¼š
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">   <span class="kn">import</span> <span class="nn">rclpy</span>
</span></span><span class="line"><span class="cl">   <span class="kn">from</span> <span class="nn">rclpy.node</span> <span class="kn">import</span> <span class="n">Node</span>
</span></span><span class="line"><span class="cl">   <span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl">   <span class="kn">from</span> <span class="nn">example_interfaces.msg</span> <span class="kn">import</span> <span class="n">String</span>
</span></span><span class="line"><span class="cl">   <span class="kn">from</span> <span class="nn">queue</span> <span class="kn">import</span>  <span class="n">Queue</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">class</span> <span class="nc">NovelPuNode</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">       <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">node_name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">           <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">,å¯åŠ¨ï¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="bp">self</span><span class="o">.</span><span class="n">novel_queue_</span><span class="o">=</span><span class="n">Queue</span><span class="p">()</span> <span class="c1">#åˆ›å»ºé˜Ÿåˆ— æ”¾åœ¨å‰é¢</span>
</span></span><span class="line"><span class="cl">           <span class="bp">self</span><span class="o">.</span><span class="n">novel_publisher_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_publisher</span><span class="p">(</span><span class="n">String</span><span class="p">,</span><span class="s1">&#39;novel&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="bp">self</span><span class="o">.</span><span class="n">create_timer</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">timer_callback</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       <span class="k">def</span> <span class="nf">timer_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">           <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">novel_queue_</span><span class="o">.</span><span class="n">qsize</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">               <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">novel_queue_</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">               <span class="n">msg</span><span class="o">=</span><span class="n">String</span><span class="p">()</span> <span class="c1">#ç»„è£…</span>
</span></span><span class="line"><span class="cl">               <span class="n">msg</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="n">line</span>
</span></span><span class="line"><span class="cl">               <span class="bp">self</span><span class="o">.</span><span class="n">novel_publisher_</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">               <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;å‘å¸ƒäº†ï¼š</span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2"> è¿™æ¡ä¿¡æ¯ï¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       <span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">           <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="c1">#å‘é€å¼€å§‹è¯·æ±‚</span>
</span></span><span class="line"><span class="cl">           <span class="n">response</span><span class="o">.</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span> <span class="c1">#ç»™è¯·æ±‚çš„ç»“æœä¸€ä¸ªç¼–ç </span>
</span></span><span class="line"><span class="cl">           <span class="n">text</span> <span class="o">=</span><span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">           <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ä¸‹è½½</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span> <span class="c1">#è·å–åˆ°æ¯ä¸€è¡Œçš„æ•°æ®å­˜å‚¨åˆ°é˜Ÿåˆ—ä¸­ æŒ‰è¡Œåˆ†å‰²</span>
</span></span><span class="line"><span class="cl">               <span class="bp">self</span><span class="o">.</span><span class="n">novel_queue_</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">       <span class="n">rclpy</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">       <span class="n">node</span> <span class="o">=</span> <span class="n">NovelPuNode</span><span class="p">(</span><span class="s1">&#39;novel_pub&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="n">node</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;http://0.0.0.0:8000/novel1.txt&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="n">rclpy</span><span class="o">.</span><span class="n">spin</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="n">rclpy</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>è®¢é˜…è¯é¢˜
<ul>
<li>pythonç¤ºä¾‹ä»£ç ï¼š
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">   <span class="kn">import</span> <span class="nn">espeakng</span>
</span></span><span class="line"><span class="cl">   <span class="kn">import</span> <span class="nn">rclpy</span>
</span></span><span class="line"><span class="cl">   <span class="kn">from</span> <span class="nn">rclpy.node</span> <span class="kn">import</span> <span class="n">Node</span>
</span></span><span class="line"><span class="cl">   <span class="kn">from</span> <span class="nn">example_interfaces.msg</span> <span class="kn">import</span> <span class="n">String</span>
</span></span><span class="line"><span class="cl">   <span class="kn">from</span> <span class="nn">queue</span> <span class="kn">import</span>  <span class="n">Queue</span>
</span></span><span class="line"><span class="cl">   <span class="kn">import</span> <span class="nn">threading</span>
</span></span><span class="line"><span class="cl">   <span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">class</span> <span class="nc">NovelSubNode</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">       <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">node_name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">           <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">,å¯åŠ¨ï¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="bp">self</span><span class="o">.</span><span class="n">novels_queue_</span> <span class="o">=</span><span class="n">Queue</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">           <span class="bp">self</span><span class="o">.</span><span class="n">novel_subscriber_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">create_subscription</span><span class="p">(</span><span class="n">String</span><span class="p">,</span><span class="s1">&#39;novel&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">novel_callback</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="bp">self</span><span class="o">.</span><span class="n">speech_thread_</span> <span class="o">=</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">speake_thread</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="bp">self</span><span class="o">.</span><span class="n">speech_thread_</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       <span class="k">def</span> <span class="nf">novel_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">msg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">           <span class="bp">self</span><span class="o">.</span><span class="n">novels_queue_</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       <span class="k">def</span> <span class="nf">speake_thread</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">           <span class="n">speaker</span> <span class="o">=</span><span class="n">espeakng</span><span class="o">.</span><span class="n">Speaker</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">           <span class="n">speaker</span><span class="o">.</span><span class="n">voice</span><span class="o">=</span><span class="s1">&#39;zh-yue&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">           <span class="k">while</span> <span class="n">rclpy</span><span class="o">.</span><span class="n">ok</span><span class="p">():</span> <span class="c1">#æ£€æµ‹å½“å‰ROSä¸Šä¸‹æ–‡æ˜¯å¦OK</span>
</span></span><span class="line"><span class="cl">               <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">novels_queue_</span><span class="o">.</span><span class="n">qsize</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                   <span class="n">text</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">novels_queue_</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                   <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;æœ—è¯µï¼š</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                   <span class="n">speaker</span><span class="o">.</span><span class="n">say</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="c1">#è¯´</span>
</span></span><span class="line"><span class="cl">                   <span class="n">speaker</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span> <span class="c1">#ç­‰ä»–è¯´å®Œ</span>
</span></span><span class="line"><span class="cl">               <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                   <span class="c1"># è®©å½“å‰è¿›ç¨‹ä¼‘çœ 1s</span>
</span></span><span class="line"><span class="cl">                   <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">       <span class="n">rclpy</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">       <span class="n">node</span> <span class="o">=</span> <span class="n">NovelSubNode</span><span class="p">(</span><span class="s1">&#39;novel_sub&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="n">rclpy</span><span class="o">.</span><span class="n">spin</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="n">rclpy</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å®‰è£…espeakngè¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜ï¼šï¼ˆå»ºè®®æ˜¯ç›´æ¥åˆ›å»ºä¸€ä¸ªåˆé€‚çš„è™šæ‹Ÿç¯å¢ƒvenvç„¶åä¸‹è½½ä½ åç»­éœ€è¦çš„åº“ï¼Œä¸è¦ç”¨å…¨å±€ç³»ç»Ÿï¼‰
<ul>
<li>ç›´æ¥å…ˆè¿›å…¥åˆ°ä½ æƒ³è¦æ”¾ç½®è™šæ‹Ÿç¯å¢ƒçš„æ–‡ä»¶ä¸­ï¼Œå»ºè®®æ˜¯ç›´æ¥æ”¾åˆ°~/ç›®å½•ä¸‹ï¼Œç„¶åè¿è¡Œï¼š</li>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">  <span class="c1"># ä½¿ç”¨å…¨å±€Pythonåˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œå¹¶ç»§æ‰¿ç³»ç»ŸåŒ…</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># /bin/python3 -m venv --system-site-packages ~/mvenv</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>éšååœ¨ä½ çš„vscodeä¸­æ›¿æ¢ä¸ºä½ æ–°å»ºçš„ç¯å¢ƒï¼š</li>
<li>ä¹‹åä½ ç¼ºå°‘å“ªä¸ªåº“ï¼Œå°±åœ¨è¿™ä¸ªè™šæ‹Ÿç¯å¢ƒä¸‹ç›´æ¥ï¼š(pip install åº“å ) æ—¢å¯</li>
<li>æœ€ç»ˆçš„ç¼–è¯‘åä½¿ç”¨ros2 run æ—¶éœ€è¦æå‰åœ¨æœ¬å·¥ä½œç©ºé—´æ–°å»ºä¸€ä¸ª.shè„šæœ¬æ–‡ä»¶ï¼š</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">    <span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ</span>
</span></span><span class="line"><span class="cl">    <span class="nb">source</span> ~/mvenv/bin/activate
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># é…ç½® ROS2 ç¯å¢ƒ éœ€è¦æ ¹æ®è‡ªå·±çš„ç³»ç»Ÿæ¥é…ç½®</span>
</span></span><span class="line"><span class="cl">    <span class="nb">source</span> /opt/ros/jazzy/setup.bash
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># é…ç½®ä½ çš„å·¥ä½œç©ºé—´</span>
</span></span><span class="line"><span class="cl">    <span class="nb">source</span> ~/chapt3/topic_ws/install/setup.bash
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># æŠŠè™šæ‹Ÿç¯å¢ƒçš„ Python è·¯å¾„åŠ å…¥åˆ° ROS2 çš„ Python è·¯å¾„ä¸­ åç»­å…¶ä»–å·¥ç¨‹æˆ–è€…å·¥ä½œç©ºé—´çš„pythonä¸­éœ€è¦ros2è°ƒç”¨è‡ªå·±åˆ›å»ºçš„è™šæ‹Ÿç¯å¢ƒçš„ç¬¬ä¸‰æ–¹åº“æ—¶ç›´æ¥ä¿®è¯¥è¿™æ®µä¸­çš„å¯¹åº”è™šæ‹Ÿç¯å¢ƒçš„åè¯/ä½ç½®å³å¯</span>
</span></span><span class="line"><span class="cl">    <span class="nb">export</span> <span class="nv">PYTHONPATH</span><span class="o">=</span><span class="nv">$PYTHONPATH</span>:/home/robot/mvenv/lib/python3.12/site-packages
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;ROS2 + Python è™šæ‹Ÿç¯å¢ƒå·²é…ç½®å®Œæˆï¼&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ç„¶åæ­£å¸¸colcon buildå’Œsource install/setup.bashæ—¢å¯è¿è¡Œros2 run</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="/p/linux_learn/17.png"
	width="2037"
	height="1197"
	srcset="/p/linux_learn/17_hu_8d4b001e269b078a.png 480w, /p/linux_learn/17_hu_b84ab974187cb3a6.png 1024w"
	loading="lazy"
	
		alt="ç¤ºæ„å›¾"
	
	
		class="gallery-image" 
		data-flex-grow="170"
		data-flex-basis="408px"
	
></p>
<ul>
<li>C++å‘å¸ƒè¯é¢˜æ§åˆ¶å°æµ·é¾Ÿè¿åŠ¨
<ul>
<li>ç¤ºä¾‹ä»£ç (ä»…å‘å¸ƒè¯é¢˜)ï¼š
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">  <span class="cp">#include</span> <span class="cpf">&#34;rclcpp/rclcpp.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&#34;geometry_msgs/msg/twist.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&lt;chrono&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl">  <span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="o">::</span><span class="n">chrono_literals</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">class</span> <span class="nc">TurtlrCircleNode</span><span class="o">:</span><span class="k">public</span> <span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">TimerBase</span><span class="o">::</span><span class="n">SharedPtr</span> <span class="n">timer_</span><span class="p">;</span> <span class="c1">//åˆ›å»ºè®¡æ—¶å™¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="n">rclcpp</span><span class="o">::</span><span class="n">Publisher</span><span class="o">&lt;</span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Twist</span><span class="o">&gt;::</span><span class="n">SharedPtr</span> <span class="n">publisher_</span><span class="p">;</span> <span class="c1">//å‘å¸ƒè€…çš„æ™ºèƒ½æŒ‡é’ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">explicit</span> <span class="n">TurtlrCircleNode</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">node_name</span><span class="p">)</span><span class="o">:</span><span class="n">Node</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span> <span class="c1">//åŠ å…¥explicitå…³é”®å­—æ˜¯é˜²æ­¢ç±»è¿›è¡Œå•å‚æ•°éšå¼è½¬æ¢ æ­¤å¤„åªæœ‰ä¸€ä¸ªå‚æ•°å¯ä»¥è¢«ç›´æ¥ä½¿ç”¨èµ‹å€¼æ„é€ ï¼Œä½†æ˜¯ä¸è¦å…è®¸è¿™æ ·å‘ç”Ÿï¼Œæé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">publisher_</span><span class="o">=</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_publisher</span><span class="o">&lt;</span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Twist</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;/turtle1/cmd_vel&#34;</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="n">timer_</span><span class="o">=</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_wall_timer</span><span class="p">(</span><span class="mi">1000</span><span class="n">ms</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">TurtlrCircleNode</span><span class="o">::</span><span class="n">timer_callback</span><span class="p">,</span><span class="k">this</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="kt">void</span> <span class="nf">timer_callback</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="k">auto</span> <span class="n">msg</span><span class="o">=</span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Twist</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">          <span class="n">msg</span><span class="p">.</span><span class="n">linear</span><span class="p">.</span><span class="n">x</span><span class="o">=</span><span class="mf">1.0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="n">msg</span><span class="p">.</span><span class="n">angular</span><span class="p">.</span><span class="n">z</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="n">publisher_</span><span class="o">-&gt;</span><span class="n">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="n">argv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">auto</span> <span class="n">node</span> <span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">TurtlrCircleNode</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;turtle_circle&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">spin</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">shutdown</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
<li>ç¤ºä¾‹ä»£ç (è®¢é˜…åŠ å‘å¸ƒè¯é¢˜ æ§åˆ¶å°æµ·é¾Ÿåˆ°è®¾å®šçš„ç›®æ ‡ç‚¹)
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">  <span class="cp">#include</span> <span class="cpf">&#34;rclcpp/rclcpp.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&#34;geometry_msgs/msg/twist.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&lt;chrono&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&#34;turtlesim/msg/pose.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl">  <span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="o">::</span><span class="n">chrono_literals</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">class</span> <span class="nc">TurtrlControlNode</span><span class="o">:</span><span class="k">public</span> <span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// rclcpp::TimerBase::SharedPtr timer_; //åˆ›å»ºè®¡æ—¶å™¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="n">rclcpp</span><span class="o">::</span><span class="n">Publisher</span><span class="o">&lt;</span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Twist</span><span class="o">&gt;::</span><span class="n">SharedPtr</span> <span class="n">publisher_</span><span class="p">;</span> <span class="c1">//å‘å¸ƒè€…çš„æ™ºèƒ½æŒ‡é’ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="n">rclcpp</span><span class="o">::</span><span class="n">Subscription</span><span class="o">&lt;</span><span class="n">turtlesim</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Pose</span><span class="o">&gt;::</span><span class="n">SharedPtr</span> <span class="n">subscription_</span><span class="p">;</span><span class="c1">//è¨‚é–±è€…çš„æ™ºèƒ½æŒ‡é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="kt">double</span> <span class="n">target_x_</span><span class="p">{</span><span class="mf">1.0</span><span class="p">};</span><span class="c1">//ç›®æ¨™ä½ç½®xåº§æ¨™
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="kt">double</span> <span class="n">target_y_</span><span class="p">{</span><span class="mf">1.0</span><span class="p">};</span> <span class="c1">//ç›®æ¨™ä½ç½®yåº§æ¨™
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="kt">double</span> <span class="n">k_</span><span class="p">{</span><span class="mf">1.0</span><span class="p">};</span> <span class="c1">// æ¯”ä¾‹ä¿‚æ•¸
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="kt">double</span> <span class="n">max_speed_</span><span class="p">{</span><span class="mf">3.0</span><span class="p">};</span> <span class="c1">//æœ€å¤§é€Ÿåº¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">explicit</span> <span class="n">TurtrlControlNode</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">node_name</span><span class="p">)</span><span class="o">:</span><span class="n">Node</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span> <span class="c1">//åŠ å…¥explicitå…³é”®å­—æ˜¯é˜²æ­¢ç±»è¿›è¡Œå•å‚æ•°éšå¼è½¬æ¢ æ­¤å¤„åªæœ‰ä¸€ä¸ªå‚æ•°å¯ä»¥è¢«ç›´æ¥ä½¿ç”¨èµ‹å€¼æ„é€ ï¼Œä½†æ˜¯ä¸è¦å…è®¸è¿™æ ·å‘ç”Ÿï¼Œæé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">publisher_</span><span class="o">=</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_publisher</span><span class="o">&lt;</span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Twist</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;/turtle1/cmd_vel&#34;</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="c1">// timer_=this-&gt;create_wall_timer(1000ms,std::bind(&amp;TurtrlControlNode::timer_callback,this));
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="n">subscription_</span><span class="o">=</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_subscription</span><span class="o">&lt;</span><span class="n">turtlesim</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Pose</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;/turtle1/pose&#34;</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">TurtrlControlNode</span><span class="o">::</span><span class="n">on_pose_recevied</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">_1</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="kt">void</span> <span class="nf">on_pose_recevied</span><span class="p">(</span><span class="k">const</span> <span class="n">turtlesim</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Pose</span><span class="o">::</span><span class="n">SharedPtr</span> <span class="n">pose</span><span class="p">)</span> <span class="c1">//åƒæ•¸ï¼šæ”¶åˆ°æ•¸æ“šçš„å…±äº«æŒ‡é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="c1">//1.ç²å–ç•¶å‰ä½ç½®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="k">auto</span> <span class="n">current_x</span><span class="o">=</span><span class="n">pose</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="k">auto</span> <span class="n">current_y</span><span class="o">=</span><span class="n">pose</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="n">get_logger</span><span class="p">(),</span><span class="s">&#34;ç•¶å‰çš„ï¼šx=%f,y=%f&#34;</span><span class="p">,</span><span class="n">current_x</span><span class="p">,</span><span class="n">current_y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="c1">//2.è¨ˆç®—ç•¶å‰çš„ä½ç½®å’Œç›®æ¨™ä½ç½®çš„è·é›¢å’Œæœå‘çš„å·®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="k">auto</span> <span class="n">distance</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">              <span class="p">(</span><span class="n">target_x_</span><span class="o">-</span><span class="n">current_x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">target_x_</span><span class="o">-</span><span class="n">current_x</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">              <span class="p">(</span><span class="n">target_y_</span><span class="o">-</span><span class="n">current_y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">target_y_</span><span class="o">-</span><span class="n">current_y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="k">auto</span> <span class="n">angle</span><span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">atan2</span><span class="p">((</span><span class="n">target_y_</span><span class="o">-</span><span class="n">current_y</span><span class="p">),(</span><span class="n">target_x_</span><span class="o">-</span><span class="n">current_x</span><span class="p">))</span> <span class="o">-</span> <span class="n">pose</span><span class="o">-&gt;</span><span class="n">theta</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="c1">//3.åˆ©ç”¨è§’åº¦å·®å’Œä½ç½®å·®è¼¸å‡ºæ§åˆ¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="k">auto</span> <span class="n">msg</span><span class="o">=</span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Twist</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">          <span class="k">if</span><span class="p">(</span><span class="n">distance</span><span class="o">&gt;</span><span class="mf">0.2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="k">if</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="n">msg</span><span class="p">.</span><span class="n">angular</span><span class="p">.</span><span class="n">z</span><span class="o">=</span><span class="n">fabs</span><span class="p">(</span><span class="n">angle</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">              <span class="p">}</span>
</span></span><span class="line"><span class="cl">              <span class="k">else</span>
</span></span><span class="line"><span class="cl">              <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="n">msg</span><span class="p">.</span><span class="n">linear</span><span class="p">.</span><span class="n">x</span><span class="o">=</span><span class="n">k_</span><span class="o">*</span><span class="n">distance</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">              <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="c1">//4.é™åˆ¶ç·šé€Ÿåº¦æœ€å¤§å€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="k">if</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">linear</span><span class="p">.</span><span class="n">x</span><span class="o">&gt;</span><span class="n">max_speed_</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="n">msg</span><span class="p">.</span><span class="n">linear</span><span class="p">.</span><span class="n">x</span><span class="o">=</span><span class="n">max_speed_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="n">publisher_</span><span class="o">-&gt;</span><span class="n">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="n">argv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">auto</span> <span class="n">node</span> <span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">TurtrlControlNode</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;turtle_control&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">spin</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">shutdown</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>å®æˆ˜è¯é¢˜å°é¡¹ç›®ï¼šè·å–ç³»ç»ŸçŠ¶æ€å¹¶ä¸”qtæ˜¾ç¤ºï¼Œé€šè¿‡ROSé€šè®¯å®ç°å±€åŸŸç½‘é€šè®¯
<ul>
<li><img src="/p/linux_learn/18.png"
	width="1668"
	height="1229"
	srcset="/p/linux_learn/18_hu_4d21adbd91a78612.png 480w, /p/linux_learn/18_hu_e7a6c8cc798bef59.png 1024w"
	loading="lazy"
	
		alt="æ¡†æ¶å›¾"
	
	
		class="gallery-image" 
		data-flex-grow="135"
		data-flex-basis="325px"
	
></li>
<li>ç¬¬ä¸€æ­¥ï¼šè‡ªå®šä¹‰é€šè®¯æ¥å£
<ul>
<li>(1). æ–°å»ºå·¥ä½œç©ºé—´topic_practice_ws,åœ¨æ–°çš„å·¥ä½œç©ºé—´ä¸­æ–°å»ºsrcæ–‡ä»¶å¤¹åˆ›å»ºæ¶ˆæ¯æ¥å£çš„åŠŸèƒ½åŒ…
<ul>
<li>ros2 pkg create status_interfaces &ndash;dependencies builtin_interfaces rosidl_default_generators &ndash;license Apache-2.0</li>
</ul>
</li>
<li>(2). åœ¨ç”Ÿæˆçš„å·¥ä½œåŒ…ä¸­æ–°å»ºmsgæ–‡ä»¶å¤¹æ–°å»ºå¥½è‡ªå·±çš„çš„æ¶ˆæ¯æ¥å£æ–‡ä»¶,(å‘½åè§„åˆ™è¦æ±‚ä¸ºéª†é©¼å³°å‘½åï¼Œå³å¼€å¤´ç¬¬ä¸€ä¸ªå­—æ¯ä¸ºå¤§å†™,åç¼€ä¸º.msg),SystemStatus.msg
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">  <span class="n">builtin_interfaces</span><span class="o">/</span><span class="n">Time</span> <span class="n">stamp</span> <span class="err">#è®°å½•æ—¶é—´è¾å¼•å…¥å…¶ä»–åŠŸèƒ½åŒ…çš„æ¶ˆæ¯æ¥å£ï¼Œæ³¨æ„å»é™¤</span><span class="n">msgæ–‡ä»¶è·¯å¾„</span>
</span></span><span class="line"><span class="cl">  <span class="n">string</span> <span class="n">host_name</span> <span class="err">#</span> <span class="err">ä¸»æœºåå­—</span>
</span></span><span class="line"><span class="cl">  <span class="n">float32</span> <span class="n">cpu_percent</span> <span class="err">#</span> <span class="n">CPUä½¿ç”¨ç‡</span>
</span></span><span class="line"><span class="cl">  <span class="n">float32</span> <span class="n">memory_percent</span> <span class="err">#</span> <span class="err">å†…å­˜ä½¿ç”¨ç‡</span>
</span></span><span class="line"><span class="cl">  <span class="n">float32</span> <span class="n">memory_total</span> <span class="err">#</span> <span class="err">å†…å­˜æ€»å¤§å°</span>
</span></span><span class="line"><span class="cl">  <span class="n">float32</span> <span class="n">memory_available</span> <span class="err">#</span> <span class="err">å†…å­˜å‰©äºé‡</span>
</span></span><span class="line"><span class="cl">  <span class="n">float32</span> <span class="n">net_sent</span> <span class="err">#</span> <span class="err">ç½‘ç»œå‘é€æ•°æ®æ€»é‡</span> <span class="mi">1</span><span class="n">MB</span><span class="o">=</span><span class="mi">1</span><span class="n">Mb</span>
</span></span><span class="line"><span class="cl">  <span class="n">float32</span> <span class="n">net_recv</span> <span class="err">#</span> <span class="err">ç½‘ç»œæ•°æ®æ¥å—æ€»é‡</span> <span class="mi">1</span><span class="n">MB</span><span class="o">=</span><span class="mi">1</span><span class="n">Mb</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
<li>(3). åœ¨cmakelistæ–‡ä»¶ä¸­æ·»åŠ ä¸€æ®µï¼š
-```cpp
# cmake å‡½æ•°ï¼Œæ¥è‡ªrosidl_default_generators ç”¨äºå°†msgç­‰æ¶ˆæ¯å°†æ¥å£å®šä¹‰æ–‡ä»¶è½¬æ¢æˆåº“æˆ–è€…å¤´æ–‡ä»¶ç±»
rosidl_generators_interfaces{
${PROJECT_NAME}
&ldquo;msg/SystemStatus.msg&rdquo;
DEPENDENCIES builtin_interfaces
}
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
<li>(4). å†åœ¨package.xmlæ–‡ä»¶ä¸­æ·»åŠ ä¸€è¡Œå£°æ˜åº”ç”¨äº†å…¶ä»–æ–‡ä»¶åŠŸèƒ½åŒ…ï¼š
<ul>
<li>&lt;member_of_group&gt;rosidl_interface_packages&lt;/member_of_group&gt;</li>
</ul>
</li>
<li>(5). å›åˆ°srcåŒçº§ç›®å½•ä¸‹è¿›è¡Œcolcon buildæ„å»º,ä¹‹åå…ˆsource install/setup.bashæ›´æ–°ä¸€ä¸‹ç¯å¢ƒå˜é‡ï¼Œä¹‹åå¯ä»¥è¿è¡Œï¼šros2 interface show status_interfaces/msg/SystemStatus æŸ¥çœ‹ä¸€ä¸‹æ¥å£ä¿¡æ¯æ˜¯å¦æ­£ç¡®</li>
</ul>
</li>
<li>ç¬¬äºŒæ­¥ï¼šç³»ç»Ÿä¿¡æ¯è·å–å’Œå‘å¸ƒ
<ul>
<li>(1). å…ˆåœ¨åŒä¸€ä¸ªå·¥ä½œç©ºé—´ä¸‹æ–°å»ºä¸€ä¸ªpythonåŠŸèƒ½åŒ…</li>
<li>(2). å†æ–°å»ºä¸€ä¸ªpyæ–‡ä»¶
<ul>
<li>ä»£ç ç¤ºä¾‹ï¼š</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">rclpy</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">status_interfaces.msg</span> <span class="kn">import</span> <span class="n">SystemStatus</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">rclpy.node</span> <span class="kn">import</span> <span class="n">Node</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">psutil</span> <span class="c1">#è·å–ç³»ç»Ÿä¿¡æ¯åº“</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">platform</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">SysStatusPub</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">node_name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">status_publisher_</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">create_publisher</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">SystemStatus</span><span class="p">,</span><span class="s1">&#39;sys_status&#39;</span><span class="p">,</span><span class="mi">10</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">timer_</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">create_timer</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">timer_callback</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">timer_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
</span></span><span class="line"><span class="cl">        <span class="c1"># builtin_interfaces/Time stamp #è®°å½•æ—¶é—´è¾å¼•å…¥å…¶ä»–åŠŸèƒ½åŒ…çš„æ¶ˆæ¯æ¥å£ï¼Œæ³¨æ„å»é™¤msgæ–‡ä»¶è·¯å¾„</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># string host_name # ä¸»æœºåå­—</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># float32 cpu_percent # CPUä½¿ç”¨ç‡</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># float32 memory_percent # å†…å­˜ä½¿ç”¨ç‡</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># float32 memory_total # å†…å­˜æ€»å¤§å°</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># float32 memory_available # å†…å­˜å‰©äºé‡</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># float32 net_sent # ç½‘ç»œå‘é€æ•°æ®æ€»é‡ 1MB=1Mb</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># float32 net_recv # ç½‘ç»œæ•°æ®æ¥å—æ€»é‡ 1MB=1Mb</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">cpu_percent</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">cpu_percent</span><span class="p">()</span> <span class="c1">#cpuå½“å‰ä½¿ç”¨ç‡</span>
</span></span><span class="line"><span class="cl">        <span class="n">memory_info</span><span class="o">=</span><span class="n">psutil</span><span class="o">.</span><span class="n">virtual_memory</span><span class="p">()</span> <span class="c1"># å†…å­˜ç›¸å…³ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">        <span class="n">net_io_counters</span><span class="o">=</span><span class="n">psutil</span><span class="o">.</span><span class="n">net_io_counters</span><span class="p">()</span> <span class="c1"># ç½‘ç»œè¾“å…¥è¾“å‡ºç›¸å…³ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">msg</span><span class="o">=</span><span class="n">SystemStatus</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg</span><span class="o">.</span><span class="n">stamp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_clock</span><span class="p">()</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">to_msg</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg</span><span class="o">.</span><span class="n">host_name</span><span class="o">=</span><span class="n">platform</span><span class="o">.</span><span class="n">node</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg</span><span class="o">.</span><span class="n">cpu_percent</span><span class="o">=</span><span class="n">cpu_percent</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg</span><span class="o">.</span><span class="n">memory_percent</span><span class="o">=</span><span class="n">memory_info</span><span class="o">.</span><span class="n">percent</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg</span><span class="o">.</span><span class="n">memory_total</span><span class="o">=</span><span class="n">memory_info</span><span class="o">.</span><span class="n">total</span><span class="o">/</span><span class="mi">1024</span><span class="o">/</span><span class="mi">1024</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg</span><span class="o">.</span><span class="n">memory_available</span><span class="o">=</span><span class="n">memory_info</span><span class="o">.</span><span class="n">available</span><span class="o">/</span><span class="mi">1024</span><span class="o">/</span><span class="mi">1024</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg</span><span class="o">.</span><span class="n">net_sent</span><span class="o">=</span><span class="n">net_io_counters</span><span class="o">.</span><span class="n">bytes_sent</span><span class="o">/</span><span class="mi">1024</span><span class="o">/</span><span class="mi">1024</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg</span><span class="o">.</span><span class="n">net_recv</span><span class="o">=</span><span class="n">net_io_counters</span><span class="o">.</span><span class="n">bytes_recv</span><span class="o">/</span><span class="mi">1024</span><span class="o">/</span><span class="mi">1024</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;å‘å¸ƒï¼š</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="c1">#rosä¿¡æ¯ç»ˆç«¯æ‰“å°ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">status_publisher_</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="c1">#å‘å¸ƒä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">rclpy</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">node</span><span class="o">=</span><span class="n">SysStatusPub</span><span class="p">(</span><span class="s1">&#39;sys_status_pub&#39;</span><span class="p">)</span> <span class="c1">#åˆ›å»ºèŠ‚ç‚¹</span>
</span></span><span class="line"><span class="cl">    <span class="n">rclpy</span><span class="o">.</span><span class="n">spin</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="c1">#spinè¿è¡ŒèŠ‚ç‚¹</span>
</span></span><span class="line"><span class="cl">    <span class="n">rclpy</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span><span class="c1">#è¿è¡Œå®Œä¹‹åå…³é—­</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>(3). åœ¨setup.pyæ–‡ä»¶ä¸­åŠ å…¥ï¼š&lsquo;sys_status_pub=status_publisher.sys_status_pub:main&rsquo;,</li>
<li>(4). æœ€åcolcon buildä»¥åŠsourceä¹‹åè¿è¡Œï¼šros2 run status_publisher sys_status_pubï¼Œä¹‹åå¯ä»¥æ‰“å¼€å¦å¤–ä¸€ä¸ªç»ˆç«¯sourceä¹‹åè¿è¡Œï¼šros2 topic echo /sys_status ï¼Œæ‰“å°å½“å‰è¿è¡Œçš„sys_status_pubèŠ‚ç‚¹çš„å‘å¸ƒçš„sys_statusè¯é¢˜ï¼Œæ­¤è¯é¢˜å‘å¸ƒäº†ç”µè„‘çŠ¶æ€çš„msgä¿¡æ¯</li>
</ul>
</li>
<li>ç¬¬ä¸‰æ­¥ï¼šåœ¨åŠŸèƒ½åŒ…ä¸­ä½¿ç”¨QT
<ul>
<li>(1). åœ¨å·¥ä½œç¯å¢ƒçš„srcæ–‡ä»¶å¤¹å†…æ–°å»ºstatus_displayåŠŸèƒ½åŒ…ï¼Œé»˜è®¤æ˜¯cppæ–‡ä»¶ç±»å‹ï¼Œéœ€è¦åŠ è½½rclcppå’Œstatus_interfaceï¼Œç„¶åæ–°å»ºä¸€ä¸ªhello_qt.cppæ–‡ä»¶
<ul>
<li>ä»£ç ç¤ºä¾‹ï¼š
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;QApplication&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;QLabel&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;QString&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">QApplication</span> <span class="n">app</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="n">argv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">QLabel</span><span class="o">*</span> <span class="n">lable</span><span class="o">=</span><span class="k">new</span> <span class="n">QLabel</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">QString</span> <span class="n">message</span><span class="o">=</span><span class="n">QString</span><span class="o">::</span><span class="n">fromStdString</span><span class="p">(</span><span class="s">&#34;Hello Qt!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">lable</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">lable</span><span class="o">-&gt;</span><span class="n">show</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="p">.</span><span class="n">exec</span><span class="p">();</span><span class="c1">//æ‰§è¡Œåº”ç”¨ï¼Œé˜»å¡ä»£ç 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>(2). å†åœ¨cmakelistæ–‡ä»¶ä¸­æ·»åŠ ä¸‹é¢4è¡Œ,ä¹‹åæ„å»ºè¿è¡Œå³å¯
<ul>
<li>find_package(Qt5 REQUIRED COMPONENTS Widgets) # æŸ¥æ‰¾åº“</li>
<li>add_executable(hello_qt src/hello_qt.cpp) # æ·»åŠ å¯æ‰§è¡Œæ–‡ä»¶</li>
<li>target_link_libraries(hello_qt Qt5::Widgets) # é“¾æ¥åº“</li>
<li>install(TARGETS hello_qt DESTINATION lib/${PROJECT_NAME}) # å¤‡ä»½æ–‡ä»¶</li>
</ul>
</li>
<li>(3). åŸºäºæœ¬å®æˆ˜ç³»ç»ŸçŠ¶æ€æ˜¾ç¤ºé¡¹ç›®ï¼Œå¦‚ä¸‹æ–°å»ºä¸€ä¸ªsys_status_display.cppï¼š
<ul>
<li>ä»£ç ç¤ºä¾‹ï¼š
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;QApplication&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;QLabel&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;QString&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;rclcpp/rclcpp.hpp&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;status_interfaces/msg/system_status.hpp&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">SystemStatus</span> <span class="o">=</span> <span class="n">status_interfaces</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">SystemStatus</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">SysStatusDisplay</span> <span class="o">:</span> <span class="k">public</span> <span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/* data */</span>
</span></span><span class="line"><span class="cl">    <span class="n">rclcpp</span><span class="o">::</span><span class="n">Subscription</span><span class="o">&lt;</span><span class="n">SystemStatus</span><span class="o">&gt;::</span><span class="n">SharedPtr</span> <span class="n">subscriber_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">QLabel</span> <span class="o">*</span><span class="n">lable</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">SysStatusDisplay</span><span class="p">(</span><span class="cm">/* args */</span><span class="p">)</span> <span class="o">:</span> <span class="n">Node</span><span class="p">(</span><span class="s">&#34;sys_status_display&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">lable</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QLabel</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">subscriber_</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">create_subscription</span><span class="o">&lt;</span><span class="n">SystemStatus</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;sys_status&#34;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="k">const</span> <span class="n">SystemStatus</span><span class="o">::</span><span class="n">SharedPtr</span> <span class="n">msg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">void</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">lable</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="n">get_qstr_from_msg</span><span class="p">(</span><span class="n">msg</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">        <span class="n">lable</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="n">get_qstr_from_msg</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">SystemStatus</span><span class="o">&gt;</span><span class="p">()));</span>
</span></span><span class="line"><span class="cl">        <span class="n">lable</span><span class="o">-&gt;</span><span class="n">show</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// msg.stamp=self.get_clock().now().to_msg()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// msg.host_name=platform.node()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// msg.cpu_percent=cpu_percent
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// msg.memory_percent=memory_info.percent
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// msg.memory_total=memory_info.total/1024/1024
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// msg.memory_available=memory_info.available/1024/1024
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// msg.net_sent=net_io_counters.bytes_sent/1024/1024
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// msg.net_recv=net_io_counters.bytes_recv/1024/1024
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="n">QString</span> <span class="nf">get_qstr_from_msg</span><span class="p">(</span><span class="k">const</span> <span class="n">SystemStatus</span><span class="o">::</span><span class="n">SharedPtr</span> <span class="n">msg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">std</span><span class="o">::</span><span class="n">stringstream</span> <span class="n">show_str</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">show_str</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;&lt;</span><span class="s">&#34;========ç³»ç»ŸçŠ¶æ€å¯è§†åŒ–æ˜¾ç¤ºå·¥å…·==========</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;&lt;</span><span class="s">&#34; æ•° æ® æ—¶ é—´ï¼š</span><span class="se">\t</span><span class="s">&#34;</span><span class="o">&lt;&lt;</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">stamp</span><span class="p">.</span><span class="n">sec</span><span class="o">&lt;&lt;</span><span class="s">&#34;</span><span class="se">\t</span><span class="s">s</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;&lt;</span><span class="s">&#34; ä¸» æœº å å­—ï¼š</span><span class="se">\t</span><span class="s">&#34;</span><span class="o">&lt;&lt;</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">host_name</span><span class="o">&lt;&lt;</span><span class="s">&#34;</span><span class="se">\t</span><span class="s">s</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;&lt;</span><span class="s">&#34; CPU ä½¿ ç”¨ ç‡ï¼š</span><span class="se">\t</span><span class="s">&#34;</span><span class="o">&lt;&lt;</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">cpu_percent</span><span class="o">&lt;&lt;</span><span class="s">&#34;</span><span class="se">\t</span><span class="s">%</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;&lt;</span><span class="s">&#34; å†… å­˜ ä½¿ ç”¨ ç‡ï¼š</span><span class="se">\t</span><span class="s">&#34;</span><span class="o">&lt;&lt;</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">memory_percent</span><span class="o">&lt;&lt;</span><span class="s">&#34;</span><span class="se">\t</span><span class="s">%</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;&lt;</span><span class="s">&#34; å†… å­˜ æ€» é‡ï¼š</span><span class="se">\t</span><span class="s">&#34;</span><span class="o">&lt;&lt;</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">memory_total</span><span class="o">&lt;&lt;</span><span class="s">&#34;</span><span class="se">\t</span><span class="s">MB</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;&lt;</span><span class="s">&#34; å†… å­˜ å‰© ä½™ï¼š</span><span class="se">\t</span><span class="s">&#34;</span><span class="o">&lt;&lt;</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">memory_available</span><span class="o">&lt;&lt;</span><span class="s">&#34;</span><span class="se">\t</span><span class="s">MB</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;&lt;</span><span class="s">&#34; ç½‘ ç»œ å‘ é€ï¼š</span><span class="se">\t</span><span class="s">&#34;</span><span class="o">&lt;&lt;</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">net_sent</span><span class="o">&lt;&lt;</span><span class="s">&#34;</span><span class="se">\t</span><span class="s">MB</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;&lt;</span><span class="s">&#34; ç½‘ ç»œ æ¥ å—ï¼š</span><span class="se">\t</span><span class="s">&#34;</span><span class="o">&lt;&lt;</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">net_recv</span><span class="o">&lt;&lt;</span><span class="s">&#34;</span><span class="se">\t</span><span class="s">MB</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;&lt;</span><span class="s">&#34;=====================================&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">QString</span><span class="o">::</span><span class="n">fromStdString</span><span class="p">(</span><span class="n">show_str</span><span class="p">.</span><span class="n">str</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">rclcpp</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="n">argv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">QApplication</span> <span class="n">app</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">auto</span> <span class="n">node</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">SysStatusDisplay</span><span class="o">&gt;</span><span class="p">();</span> 
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="kr">thread</span> <span class="n">spin_thread</span><span class="p">([</span><span class="o">&amp;</span><span class="p">]()</span><span class="o">-&gt;</span><span class="kt">void</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">rclcpp</span><span class="o">::</span><span class="n">spin</span><span class="p">(</span><span class="n">node</span><span class="p">);</span> <span class="c1">//å¯åŠ¨nodeèŠ‚ç‚¹,é˜»å¡ä»£ç 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="n">spin_thread</span><span class="p">.</span><span class="n">detach</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="p">.</span><span class="n">exec</span><span class="p">();</span> <span class="c1">// æ‰§è¡Œåº”ç”¨ï¼Œé˜»å¡ä»£ç 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>(4). æ›´æ”¹å¥½cmakelistæ–‡ä»¶å†…å®¹ï¼Œé“¾æ¥å¥½åº“ï¼š</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">    <span class="n">add_executable</span><span class="p">(</span><span class="n">sys_status_display</span> <span class="n">src</span><span class="o">/</span><span class="n">sys_status_display</span><span class="p">.</span><span class="n">cpp</span><span class="p">)</span> <span class="err">#</span> <span class="err">æ·»åŠ å¯æ‰§è¡Œæ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">    <span class="n">target_link_libraries</span><span class="p">(</span><span class="n">sys_status_display</span> <span class="n">Qt5</span><span class="o">::</span><span class="n">Widgets</span><span class="p">)</span> <span class="err">#</span> <span class="err">é“¾æ¥åº“</span>
</span></span><span class="line"><span class="cl">    <span class="n">ament_target_dependencies</span><span class="p">(</span><span class="n">sys_status_display</span> <span class="n">rclcpp</span> <span class="n">status_interfaces</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">install</span><span class="p">(</span><span class="n">TARGETS</span> <span class="n">hello_qt</span> <span class="n">sys_status_display</span>
</span></span><span class="line"><span class="cl">    <span class="n">DESTINATION</span> <span class="n">lib</span><span class="o">/</span><span class="err">$</span><span class="p">{</span><span class="n">PROJECT_NAME</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span> <span class="err">#</span> <span class="err">å¤‡ä»½æ–‡ä»¶</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>(5). æœ€ååˆ†åˆ«è¿è¡Œstatus_publisher sys_status_pubå’Œstatus_display sys_status_display æ­£å¸¸çœ‹åˆ°æ˜¾ç¤ºå³<strong>å¤§åŠŸå‘Šæˆï¼</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="/p/linux_learn/19.png"
	width="2041"
	height="1195"
	srcset="/p/linux_learn/19_hu_20aa5ffcc4f14cbb.png 480w, /p/linux_learn/19_hu_d4684e08e3eaa8a0.png 1024w"
	loading="lazy"
	
		alt="æœ€åè¿è¡Œæ•ˆæœå›¾"
	
	
		class="gallery-image" 
		data-flex-grow="170"
		data-flex-basis="409px"
	
></p>
<h3 id="313-æœåŠ¡">3.13 æœåŠ¡
</h3><ul>
<li>
<p>åˆæ­¥è®¤è¯†ä½¿ç”¨æœåŠ¡ï¼š</p>
<ul>
<li>ç¤ºä¾‹ï¼š
<ul>
<li>æ‰“å¼€å°æµ·é¾Ÿæ˜¾ç¤ºèŠ‚ç‚¹(è®°ä¸èµ·æ¥å°±åŒtap)
<ul>
<li>ros2 run turtlesim turtlesim_node</li>
</ul>
</li>
<li>ä¹‹åå†æ‰“å¼€å¦å¤–ä¸€ä¸ªç»ˆç«¯(ctrl+alt+t)è¿è¡Œä¸‹é¢å›¾ç‰‡æŸ¥çœ‹æœåŠ¡ï¼ŒæŸ¥çœ‹æŸä¸ªæœåŠ¡æ¶ˆæ¯è¯¦æƒ…ï¼Œcallå¯åŠ¨ä¸€ä¸ªæœåŠ¡æ¶ˆæ¯
<ul>
<li>ros2 service list -t</li>
<li>ros2 interface show turtlesim/srv/Spawn</li>
<li>ros2 service call spawn turtlesim/srv/Spawn &ldquo;{x: 1, y: 1}&rdquo;</li>
</ul>
</li>
<li>ä½¿ç”¨å›¾å½¢åŒ–äº¤äº’ç•Œé¢ï¼šrqt
<ul>
<li><img src="/p/linux_learn/20.png"
	width="2036"
	height="1244"
	srcset="/p/linux_learn/20_hu_fb5d81d0dd8619b9.png 480w, /p/linux_learn/20_hu_7781642a710ff9e9.png 1024w"
	loading="lazy"
	
		alt="æœåŠ¡åˆè¯†"
	
	
		class="gallery-image" 
		data-flex-grow="163"
		data-flex-basis="392px"
	
></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>åŸºäºæœåŠ¡çš„å‚æ•°é€šä¿¡</p>
<ul>
<li>æœåŠ¡çš„ä¸€äº›å‚æ•°åˆ—è¡¨å±•ç¤º:ros2 param list
<ul>
<li>ä¹‹åå¯ä»¥æ‰“å°è¯¦ç»†çš„å‚æ•°ä»‹ç»ä¿¡æ¯ï¼šros2 param describe /turtlesim background_r</li>
<li>è¿˜å¯ä»¥æ‰“å°è·å–å½“å‰å‚æ•°çš„å€¼ï¼šros2 param get /turtlesim background_r</li>
<li>è¿˜å¯ä»¥è®¾ç½®å½“å‰å‚æ•°çš„å€¼ï¼šros2 param set /turtlesim background_r 255</li>
</ul>
</li>
<li>ä¸€èˆ¬é…ç½®å¤šä¸ªå‚æ•°æ—¶æœ€å¿«ä¾¿æ·æ–¹æ³•æ˜¯å¯¼å‡ºyamlå‚æ•°æ–‡ä»¶ï¼Œä¹‹åç¼–è¾‘æ–‡ä»¶ä¸­çš„å‚æ•°æ—¢å¯ï¼Œéšåè¿è¡Œç›¸åº”èŠ‚ç‚¹æ—¶å°†yamlå‚æ•°é…ç½®æ–‡ä»¶ä¸€èµ·å¯ç”¨é…ç½®
<ul>
<li>å¯¼å‡ºæœåŠ¡å‚æ•°ä¸ºyamlæ–‡ä»¶ï¼š
<ul>
<li>ros2 param dump /turtlesim &gt; turtlesim_param.yaml</li>
</ul>
</li>
<li>æŸ¥çœ‹å½“å‰å¯¼å‡ºçš„yamlæ–‡ä»¶
<ul>
<li>cat turtlesim_param.yaml</li>
</ul>
</li>
<li>å¯åŠ¨èŠ‚ç‚¹æ—¶ä½¿ç”¨yamlçš„é…ç½®æ–‡ä»¶ï¼š
<ul>
<li>ros2 run turtlesim turtlesim_node &ndash;ros-args &ndash;params-file turtlesim_param.yaml ã€å…¶å®å°±æ˜¯rclcpp.init(argc,argv)æ—¶å°†yamlä¼ å…¥ä½œä¸ºåˆå§‹åŒ–å‚æ•°ã€‘</li>
</ul>
</li>
<li>æˆ–è€…æ˜¯rqtä¸­çš„åŠ¨æ€é…ç½®configurationç›´æ¥è°ƒæ•´ä¿®æ”¹å€¼</li>
</ul>
</li>
</ul>
</li>
<li>
<p>è‡ªå®šä¹‰æœåŠ¡æ¥å£(äººè„¸è¯†åˆ«ç¤ºä¾‹)</p>
<ul>
<li>
<p>æ–°å»ºå·chapt4æ–‡ä»¶ä¸‹srcå†…æ–°å»ºä¸€ä¸ªchapt4_interfacesåŠŸèƒ½åŒ…ï¼š</p>
<ul>
<li>ros2 pkg create chapt4_interfaces &ndash;dependencies sensor_msgs rosidl_default_generators &ndash;license Apache-2.0</li>
</ul>
</li>
<li>
<p>å†åœ¨åŠŸèƒ½åŒ…å†…æ–°å»ºsrvæœåŠ¡æ¥å£æ–‡ä»¶å¤¹ï¼Œåœ¨æ­¤æ–‡ä»¶å¤¹å†…æ–°å»ºFaceDetector.srvæ–‡ä»¶å¹¶ä¸”æ›´æ”¹cmakelistå’Œpackage.xmlæ–‡ä»¶å†…å®¹ï¼š</p>
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">  <span class="n">sensor_msgs</span><span class="o">/</span><span class="n">Image</span> <span class="n">image</span>     <span class="err">#äººè„¸å›¾åƒ</span>
</span></span><span class="line"><span class="cl">  <span class="o">---</span>
</span></span><span class="line"><span class="cl">  <span class="n">int16</span> <span class="n">number</span>    <span class="err">#è¯†åˆ«åˆ°çš„äººè„¸ä¸ªæ•°</span>
</span></span><span class="line"><span class="cl">  <span class="n">float32</span> <span class="n">use_time</span>  <span class="err">#è¯†åˆ«è€—æ—¶</span>
</span></span><span class="line"><span class="cl">  <span class="n">int32</span><span class="p">[]</span> <span class="n">top</span>   <span class="err">#äººè„¸åœ¨å›¾åƒä¸­çš„ä½ç½®</span>
</span></span><span class="line"><span class="cl">  <span class="n">int32</span><span class="p">[]</span> <span class="n">right</span>
</span></span><span class="line"><span class="cl">  <span class="n">int32</span><span class="p">[]</span> <span class="n">bottom</span>
</span></span><span class="line"><span class="cl">  <span class="n">int32</span><span class="p">[]</span> <span class="n">left</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">rosidl_generate_interfaces</span><span class="p">(</span><span class="err">$</span><span class="p">{</span><span class="n">PROJECT_NAME</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="s">&#34;srv/FaceDetector.srv&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">DEPENDENCIES</span> <span class="n">sensor_msgs</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">member_of_group</span><span class="o">&gt;</span><span class="n">rosidl_interface_packages</span><span class="o">&lt;/</span><span class="n">member_of_group</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>ä¹‹ååˆ‡æ¢åˆ°srcçš„åŒçº§ç›®å½•ä¸‹è¿›è¡Œcolcon buildå†source install/setup.bash ï¼Œæœ€åè¿è¡Œros2 interface show chapt4_interfaces/srv/FaceDetector æŸ¥çœ‹æ˜¯å¦æœ‰å¯¹åº”çš„æœåŠ¡æ¥å£ä¿¡æ¯æ—¢å¯</p>
</li>
</ul>
</li>
<li>
<p>äººè„¸æ£€æµ‹pythonæœåŠ¡é€šä¿¡ï¼š(pythonåœ¨mvenvç¯å¢ƒä¸‹)</p>
<ul>
<li>æ–°å»ºä¸€ä¸ªstart_mvenv.shæ–‡ä»¶ä¸€é”®é…ç½®è™šæ‹Ÿç¯å¢ƒ
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  <span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ</span>
</span></span><span class="line"><span class="cl">  <span class="nb">source</span> ~/mvenv/bin/activate
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># é…ç½® ROS2 ç¯å¢ƒ éœ€è¦æ ¹æ®è‡ªå·±çš„ç³»ç»Ÿæ¥é…ç½®</span>
</span></span><span class="line"><span class="cl">  <span class="nb">source</span> /opt/ros/jazzy/setup.bash
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># é…ç½®ä½ çš„å·¥ä½œç©ºé—´</span>
</span></span><span class="line"><span class="cl">  <span class="nb">source</span> ~/chapt4/chapt4_ws/install/setup.bash
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># æŠŠè™šæ‹Ÿç¯å¢ƒçš„ Python è·¯å¾„åŠ å…¥åˆ° ROS2 çš„ Python è·¯å¾„ä¸­ åç»­å…¶ä»–å·¥ç¨‹æˆ–è€…å·¥ä½œç©ºé—´çš„pythonä¸­éœ€è¦ros2è°ƒç”¨è‡ªå·±åˆ›å»ºçš„è™šæ‹Ÿç¯å¢ƒçš„ç¬¬ä¸‰æ–¹åº“æ—¶ç›´æ¥ä¿®è¯¥è¿™æ®µä¸­çš„å¯¹åº”è™šæ‹Ÿç¯å¢ƒçš„åè¯/ä½ç½®å³å¯</span>
</span></span><span class="line"><span class="cl">  <span class="nb">export</span> <span class="nv">PYTHONPATH</span><span class="o">=</span><span class="nv">$PYTHONPATH</span>:/home/robot/mvenv/lib/python3.12/site-packages
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;ROS2 + Python è™šæ‹Ÿç¯å¢ƒå·²é…ç½®å®Œæˆï¼&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>æ–°å»ºåŠŸèƒ½åŒ…ros2 pkg create demo_python_service &ndash;build-type ament_python &ndash;dependencies rclpy chapt4_interfaces &ndash;license Apache-2.0</li>
<li>éœ€è¦æ‰¾åˆ°ä¸€å¼ éœ€è¦æ£€æµ‹çš„ç…§ç‰‡æ”¾åˆ°resourceæ–‡ä»¶å¤¹å†…ï¼Œéšåæ›´æ”¹setup.pyæ–‡ä»¶ï¼Œè¡¨ç¤ºåœ¨colcon buildæ‹·è´ä¸€ä»½æ—¶å°†sourceæ–‡ä»¶ä¸‹çš„è¿™å¼ ç…§ç‰‡ä¹Ÿä¸€èµ·æ‹·è´
<ul>
<li>(&lsquo;share/&rsquo; + package_name+&quot;/resource&quot;, [&lsquo;resource/defult.jpg&rsquo;]),</li>
</ul>
</li>
<li>ç„¶åæ–°å»ºlearn_face_detect.pyï¼Œä»£ç ç¤ºä¾‹ï¼š
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">face_recognition</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">cv2</span>
</span></span><span class="line"><span class="cl">  <span class="kn">from</span> <span class="nn">ament_index_python.packages</span> <span class="kn">import</span> <span class="n">get_package_share_directory</span> <span class="c1">#å¯¼å…¥åŠŸèƒ½åŒ…shareç›®å½•ç»å¯¹è·¯å¾„</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">      <span class="c1">#è·å–å›¾ç‰‡çš„çœŸå®è·¯å¾„ /home/robot/chapt4/chapt4_ws/install/demo_python_service/share/demo_python_service</span>
</span></span><span class="line"><span class="cl">      <span class="n">default_image_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">get_package_share_directory</span><span class="p">(</span><span class="s1">&#39;demo_python_service&#39;</span><span class="p">),</span><span class="s1">&#39;/resource/defult.jpg&#39;</span><span class="p">)</span><span class="c1">#osåº“è‡ªåŠ¨åˆ¤æ–­è¿æ¥è·¯å¾„æ˜¯å¦éœ€è¦/é“¾æ¥</span>
</span></span><span class="line"><span class="cl">      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;å›¾ç‰‡çš„çœŸå®è·¯å¾„ï¼š</span><span class="si">{</span><span class="n">default_image_path</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="c1">#ä½¿ç”¨cv2åŠ è½½å›¾ç‰‡</span>
</span></span><span class="line"><span class="cl">      <span class="n">image</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">default_image_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="c1">#æ£€æµ‹äººè„¸</span>
</span></span><span class="line"><span class="cl">      <span class="n">face_locations</span><span class="o">=</span><span class="n">face_recognition</span><span class="o">.</span><span class="n">face_locations</span><span class="p">(</span><span class="n">image</span><span class="p">,</span><span class="n">number_of_times_to_upsample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;hog&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="c1">#ç»˜åˆ¶äººè„¸æ¡†</span>
</span></span><span class="line"><span class="cl">      <span class="k">for</span> <span class="n">top</span><span class="p">,</span><span class="n">right</span><span class="p">,</span><span class="n">bottom</span><span class="p">,</span><span class="n">left</span> <span class="ow">in</span> <span class="n">face_locations</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">          <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">image</span><span class="p">,(</span><span class="n">left</span><span class="p">,</span><span class="n">top</span><span class="p">),(</span><span class="n">right</span><span class="p">,</span><span class="n">bottom</span><span class="p">),(</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="c1">#ç»“æœæ˜¾ç¤º</span>
</span></span><span class="line"><span class="cl">      <span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s1">&#39;Face Detecte result&#39;</span><span class="p">,</span><span class="n">image</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
<li>ç„¶ååˆ†åˆ«è¿è¡Œ,ä¹‹åå†è¿è¡Œros2 run demo_python_service learn_face_detect
<ul>
<li>source start_mvenv.sh</li>
<li>colcon build source</li>
<li>install/setup.bash</li>
</ul>
</li>
<li>ä¸‹é¢ä¸ºæ­£å¼å¼€å§‹äººè„¸æ£€æµ‹æœåŠ¡éƒ¨åˆ†ï¼š
<ul>
<li>æ–°å»ºface_detect_node.pyä»£ç ç¤ºä¾‹ï¼š
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">rclpy</span>
</span></span><span class="line"><span class="cl">  <span class="kn">from</span> <span class="nn">rclpy.node</span> <span class="kn">import</span> <span class="n">Node</span>
</span></span><span class="line"><span class="cl">  <span class="kn">from</span> <span class="nn">chapt4_interfaces.srv</span> <span class="kn">import</span> <span class="n">FaceDetector</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">face_recognition</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">cv2</span>
</span></span><span class="line"><span class="cl">  <span class="kn">from</span> <span class="nn">ament_index_python.packages</span> <span class="kn">import</span> <span class="n">get_package_share_directory</span> <span class="c1">#å¯¼å…¥åŠŸèƒ½åŒ…shareç›®å½•ç»å¯¹è·¯å¾„</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">  <span class="kn">from</span> <span class="nn">cv_bridge</span> <span class="kn">import</span> <span class="n">CvBridge</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">class</span> <span class="nc">FaceDetectNode</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">      <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">          <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s1">&#39;face_detect_node&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="bp">self</span><span class="o">.</span><span class="n">service_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">create_service</span><span class="p">(</span><span class="n">FaceDetector</span><span class="p">,</span><span class="s1">&#39;face_detect&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_face_callback</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="bp">self</span><span class="o">.</span><span class="n">bridge</span><span class="o">=</span><span class="n">CvBridge</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">          <span class="bp">self</span><span class="o">.</span><span class="n">number_of_times_to_upsample</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">          <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;hog&#39;</span>
</span></span><span class="line"><span class="cl">          <span class="bp">self</span><span class="o">.</span><span class="n">default_image_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">get_package_share_directory</span><span class="p">(</span><span class="s1">&#39;demo_python_service&#39;</span><span class="p">),</span><span class="s1">&#39;resource/defult.jpg&#39;</span><span class="p">)</span><span class="c1">#osåº“è‡ªåŠ¨åˆ¤æ–­è¿æ¥è·¯å¾„æ˜¯å¦éœ€è¦/é“¾æ¥</span>
</span></span><span class="line"><span class="cl">          <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;äººè„¸æ£€æµ‹æœåŠ¡æˆåŠŸå¼€å¯ï¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">def</span> <span class="nf">detect_face_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">request</span><span class="p">,</span><span class="n">response</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">          <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">              <span class="n">cv_image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bridge</span><span class="o">.</span><span class="n">imgmsg_to_cv2</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">              <span class="n">cv_image</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default_image_path</span><span class="p">)</span><span class="c1">#è‹¥è¯·æ±‚çš„å›¾ç‰‡å†…å®¹ä¸ºç©ºåˆ™è¯†åˆ«é»˜è®¤çš„ç…§ç‰‡å†…å®¹ï¼Œç›®å½•ä½ç½®ä¸ºä¸Šé¢</span>
</span></span><span class="line"><span class="cl">              <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ä¼ å…¥å›¾åƒä¸ºç©ºï¼Œä½¿ç”¨é»˜è®¤å›¾åƒï¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="c1">#æ­¤å¤„çš„cv_imageå›¾åƒå·²ç»æ˜¯ä¸€ä¸ªopencvæ ¼å¼çš„å›¾åƒ</span>
</span></span><span class="line"><span class="cl">          <span class="n">start_time</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">          <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;åŠ è½½å®Œæˆå›¾åƒï¼Œå¼€å§‹äººè„¸è¯†åˆ«ï¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="n">face_locations</span><span class="o">=</span><span class="n">face_recognition</span><span class="o">.</span><span class="n">face_locations</span><span class="p">(</span><span class="n">cv_image</span><span class="p">,</span><span class="n">number_of_times_to_upsample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_times_to_upsample</span><span class="p">,</span><span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="n">response</span><span class="o">.</span><span class="n">use_time</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">start_time</span>
</span></span><span class="line"><span class="cl">          <span class="n">response</span><span class="o">.</span><span class="n">number</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">face_locations</span><span class="p">)</span> <span class="c1">#face_locationsæ˜¯ä¸€ä¸ªåˆ—è¡¨é‡Œé¢å…¶å®å°±æ˜¯è¯†åˆ«å‡ºæ¥æœ‰å¤šå°‘ç»„äººé“¾æ•°ç»„</span>
</span></span><span class="line"><span class="cl">          <span class="k">for</span> <span class="n">top</span><span class="p">,</span><span class="n">right</span><span class="p">,</span><span class="n">bottom</span><span class="p">,</span><span class="n">left</span> <span class="ow">in</span> <span class="n">face_locations</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">              <span class="n">response</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="n">response</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="n">response</span><span class="o">.</span><span class="n">bottom</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bottom</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="n">response</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="k">return</span> <span class="n">response</span> <span class="c1">#å¿…é¡»è¿”å›response</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclpy</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">      <span class="n">node</span><span class="o">=</span><span class="n">FaceDetectNode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclpy</span><span class="o">.</span><span class="n">spin</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclpy</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
<li>ä¹‹åä¿®æ”¹å¥½setup.pyç„¶åç›´æ¥è¿è¡Œå³å¯ï¼Œæ‰“å¼€å¦å¤–ä¸€ä¸ªç»ˆç«¯åˆ—å‡ºæœåŠ¡ï¼šros2 service list -tï¼Œä¹‹åå†è¿è¡Œservice callè¿™ä¸ªå‘å¸ƒçš„æœåŠ¡æ¶ˆæ¯æ¥å£å³å¯ï¼Œè¯†åˆ«å‡ºé»˜è®¤çš„å›¾ç‰‡å†…å®¹</li>
</ul>
</li>
<li>äººè„¸æ£€æµ‹çš„å®¢æˆ·ç«¯å®ç°
<ul>
<li>ç°åœ¨resourceç›®å½•ä¸‹æ·»åŠ å¥½éœ€è¦è¯†åˆ«çš„ç…§ç‰‡ï¼Œç„¶åä¿®æ”¹å¥½setup.pyåœ¨colcon buildæ—¶å°†ç…§ç‰‡ä¹Ÿä¸€èµ·æ‹·è´è¿‡å»</li>
<li>ç„¶åæ­£å¸¸åœ°æ–°å»ºå¥½face_detect_client_node.pyä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">rclpy</span>
</span></span><span class="line"><span class="cl">  <span class="kn">from</span> <span class="nn">rclpy.node</span> <span class="kn">import</span> <span class="n">Node</span>
</span></span><span class="line"><span class="cl">  <span class="kn">from</span> <span class="nn">chapt4_interfaces.srv</span> <span class="kn">import</span> <span class="n">FaceDetector</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">face_recognition</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">cv2</span>
</span></span><span class="line"><span class="cl">  <span class="kn">from</span> <span class="nn">ament_index_python.packages</span> <span class="kn">import</span> <span class="n">get_package_share_directory</span> <span class="c1">#å¯¼å…¥åŠŸèƒ½åŒ…shareç›®å½•ç»å¯¹è·¯å¾„</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">  <span class="kn">from</span> <span class="nn">cv_bridge</span> <span class="kn">import</span> <span class="n">CvBridge</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">class</span> <span class="nc">FaceDetectClientNode</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">      <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">          <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s1">&#39;face_detect_client_node&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="bp">self</span><span class="o">.</span><span class="n">bridge</span><span class="o">=</span><span class="n">CvBridge</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">          <span class="bp">self</span><span class="o">.</span><span class="n">default_image_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">get_package_share_directory</span><span class="p">(</span><span class="s1">&#39;demo_python_service&#39;</span><span class="p">),</span><span class="s1">&#39;resource/peoples.jpg&#39;</span><span class="p">)</span><span class="c1">#osåº“è‡ªåŠ¨åˆ¤æ–­è¿æ¥è·¯å¾„æ˜¯å¦éœ€è¦/é“¾æ¥</span>
</span></span><span class="line"><span class="cl">          <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;äººè„¸æ£€æµ‹å®¢æˆ·ç«¯æˆåŠŸå¼€å¯ï¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">create_client</span><span class="p">(</span><span class="n">FaceDetector</span><span class="p">,</span><span class="s1">&#39;face_detect&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default_image_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">def</span> <span class="nf">send_request</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">          <span class="c1"># 1.åˆ¤æ–­æœåŠ¡ç«¯æ˜¯å¦ä¸Šçº¿</span>
</span></span><span class="line"><span class="cl">          <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">wait_for_service</span><span class="p">(</span><span class="n">timeout_sec</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">              <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æ­£åœ¨ç­‰å¾…æœåŠ¡ç«¯ä¸Šçº¿.....&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="c1"># 2.æ„é€ Request</span>
</span></span><span class="line"><span class="cl">          <span class="n">request</span><span class="o">=</span><span class="n">FaceDetector</span><span class="o">.</span><span class="n">Request</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">          <span class="n">request</span><span class="o">.</span><span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bridge</span><span class="o">.</span><span class="n">cv2_to_imgmsg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="c1"># 3.å‘é€è¯·æ±‚å¹¶ç­‰å¾…å¤„ç†å®Œæˆ</span>
</span></span><span class="line"><span class="cl">          <span class="n">future</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">call_async</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="c1"># while not future.done():</span>
</span></span><span class="line"><span class="cl">          <span class="c1">#     time.sleep(1.0) #ä¼‘çœ å½“å‰çº¿ç¨‹ï¼Œç­‰å¾…æœåŠ¡å¤„ç†å®Œæˆ==é€ æˆå½“å‰çº¿ç¨‹æ— æ³•å†æ¥å—æ¥è‡ªæœåŠ¡ç«¯çš„è¿”å›ï¼Œå¯¼è‡´æ°¸è¿œæ— æ³•å®Œæˆfuture.done()æ— æ³•è¿”å›True</span>
</span></span><span class="line"><span class="cl">          <span class="c1"># rclpy.spin_until_future_complete(self,future) #ç­‰å¾…æœåŠ¡ç«¯è¿”å›å“åº”</span>
</span></span><span class="line"><span class="cl">          <span class="k">def</span> <span class="nf">result_callback</span><span class="p">(</span><span class="n">result_future</span><span class="p">):</span>           
</span></span><span class="line"><span class="cl">              <span class="n">response</span> <span class="o">=</span><span class="n">result_future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span> <span class="c1">#è·å–å“åº”ç»“æœ</span>
</span></span><span class="line"><span class="cl">              <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æ¥æ”¶åˆ°å“åº”ï¼Œå…±è€—æ—¶</span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">use_time</span><span class="si">}</span><span class="s2">s,æ€»å…±æ£€æµ‹åˆ°</span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">number</span><span class="si">}</span><span class="s2">ä¸ªäººè„¸&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="bp">self</span><span class="o">.</span><span class="n">show_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="n">future</span><span class="o">.</span><span class="n">add_done_callback</span><span class="p">(</span><span class="n">result_callback</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">def</span> <span class="nf">show_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">resonse</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">          <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">resonse</span><span class="o">.</span><span class="n">number</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">              <span class="n">top</span><span class="o">=</span><span class="n">resonse</span><span class="o">.</span><span class="n">top</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">              <span class="n">left</span><span class="o">=</span><span class="n">resonse</span><span class="o">.</span><span class="n">left</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">              <span class="n">right</span><span class="o">=</span><span class="n">resonse</span><span class="o">.</span><span class="n">right</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">              <span class="n">bottom</span><span class="o">=</span><span class="n">resonse</span><span class="o">.</span><span class="n">bottom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">              <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,(</span><span class="n">left</span><span class="p">,</span><span class="n">top</span><span class="p">),(</span><span class="n">right</span><span class="p">,</span><span class="n">bottom</span><span class="p">),(</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="c1">#ç»“æœæ˜¾ç¤º</span>
</span></span><span class="line"><span class="cl">          <span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s1">&#39;Face Detecte result&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="c1">#é˜»å¡</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclpy</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">      <span class="n">node</span><span class="o">=</span><span class="n">FaceDetectClientNode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">      <span class="n">node</span><span class="o">.</span><span class="n">send_request</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclpy</span><span class="o">.</span><span class="n">spin</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclpy</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>        
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
<li>ä¹‹åæ­£å¸¸è¿è¡Œå…ˆå¼€å§‹ä¹‹å‰çš„æœåŠ¡ç«¯èŠ‚ç‚¹ï¼Œç„¶åå†å¼€å¯å®¢æˆ·ç«¯èŠ‚ç‚¹è¿›è¡Œè¯†åˆ«æ—¢å¯çœ‹åˆ°ç°è±¡</li>
</ul>
</li>
</ul>
</li>
<li>
<p>C++å°ä¹Œé¾Ÿå·¡èˆªæœåŠ¡ï¼š</p>
<ul>
<li>æ–°å»ºæœåŠ¡é€šè®¯æ¥å£ï¼šåœ¨srvæ–‡ä»¶ä¸‹æ–°å»ºPatrol.srvï¼Œå†…å®¹ç¤ºä¾‹ï¼š
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">  <span class="n">float32</span> <span class="n">target_x</span>
</span></span><span class="line"><span class="cl">  <span class="n">float32</span> <span class="n">target_y</span>
</span></span><span class="line"><span class="cl">  <span class="o">---</span>
</span></span><span class="line"><span class="cl">  <span class="n">int8</span> <span class="n">SUCESS</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">  <span class="n">int8</span> <span class="n">FAIL</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">  <span class="n">int8</span> <span class="n">result</span> <span class="err">#</span> <span class="err">ç»“æœ</span> <span class="err">è¿”å›</span> <span class="n">SUCESS</span> <span class="o">/</span> <span class="n">FAIL</span> <span class="err">å–å…¶ä¸­ä¹‹ä¸€</span> 
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>éšåæ›´æ”¹cmakelistæ–‡ä»¶å°†è¯¥srvæ–‡ä»¶è·¯å¾„æ›´æ–°åˆ°é‡Œé¢ï¼Œå‚è€ƒä¸Šé¢pythonçš„srvæ›´æ–°ã€‚ä¹‹åç›´æ¥colcon buildå·²ç»sourceæ—¢å¯ï¼ŒæŸ¥çœ‹ros2 interface show chapt4_interface/srv/Patrol æ—¢å¯çœ‹åˆ°æ¥å£è¯¦ç»†ä¿¡æ¯</li>
</ul>
</li>
<li>(æœåŠ¡ç«¯)åœ¨srcä¸‹æ–°å»ºåŠŸèƒ½åŒ…ï¼š
<ul>
<li>ros2 pkg create demo_cpp_service &ndash;build-type ament_cmake &ndash;dependencies chapt4_interfaces rclcpp geometry_msgs turtlesim &ndash;license Apache-2.0</li>
<li>éšååœ¨é¡¹ç›®åç§°ä¸‹æ–°å»ºæœåŠ¡ç«¯turtle_control.cppä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">  <span class="cp">#include</span> <span class="cpf">&#34;rclcpp/rclcpp.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&#34;geometry_msgs/msg/twist.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&lt;chrono&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&#34;turtlesim/msg/pose.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&#34;chapt4_interfaces/srv/patrol.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="k">using</span> <span class="n">Patrol</span><span class="o">=</span><span class="n">chapt4_interfaces</span><span class="o">::</span><span class="n">srv</span><span class="o">::</span><span class="n">Patrol</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="o">::</span><span class="n">chrono_literals</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">class</span> <span class="nc">TurtrlControlNode</span><span class="o">:</span><span class="k">public</span> <span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">private</span><span class="o">:</span>    
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">Service</span><span class="o">&lt;</span><span class="n">Patrol</span><span class="o">&gt;::</span><span class="n">SharedPtr</span> <span class="n">patrol_service_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">Publisher</span><span class="o">&lt;</span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Twist</span><span class="o">&gt;::</span><span class="n">SharedPtr</span> <span class="n">publisher_</span><span class="p">;</span> <span class="c1">//å‘å¸ƒè€…çš„æ™ºèƒ½æŒ‡é’ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="n">rclcpp</span><span class="o">::</span><span class="n">Subscription</span><span class="o">&lt;</span><span class="n">turtlesim</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Pose</span><span class="o">&gt;::</span><span class="n">SharedPtr</span> <span class="n">subscription_</span><span class="p">;</span><span class="c1">//è¨‚é–±è€…çš„æ™ºèƒ½æŒ‡é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="kt">double</span> <span class="n">target_x_</span><span class="p">{</span><span class="mf">1.0</span><span class="p">};</span><span class="c1">//ç›®æ¨™ä½ç½®xåº§æ¨™
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="kt">double</span> <span class="n">target_y_</span><span class="p">{</span><span class="mf">1.0</span><span class="p">};</span> <span class="c1">//ç›®æ¨™ä½ç½®yåº§æ¨™
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="kt">double</span> <span class="n">k_</span><span class="p">{</span><span class="mf">1.0</span><span class="p">};</span> <span class="c1">// æ¯”ä¾‹ä¿‚æ•¸
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="kt">double</span> <span class="n">max_speed_</span><span class="p">{</span><span class="mf">3.0</span><span class="p">};</span> <span class="c1">//æœ€å¤§é€Ÿåº¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">explicit</span> <span class="n">TurtrlControlNode</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">node_name</span><span class="p">)</span><span class="o">:</span><span class="n">Node</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span> <span class="c1">//åŠ å…¥explicitå…³é”®å­—æ˜¯é˜²æ­¢ç±»è¿›è¡Œå•å‚æ•°éšå¼è½¬æ¢ æ­¤å¤„åªæœ‰ä¸€ä¸ªå‚æ•°å¯ä»¥è¢«ç›´æ¥ä½¿ç”¨èµ‹å€¼æ„é€ ï¼Œä½†æ˜¯ä¸è¦å…è®¸è¿™æ ·å‘ç”Ÿï¼Œæé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">patrol_service_</span><span class="o">=</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_service</span><span class="o">&lt;</span><span class="n">Patrol</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;patrol&#34;</span><span class="p">,[</span><span class="o">&amp;</span><span class="p">](</span><span class="k">const</span> <span class="n">Patrol</span><span class="o">::</span><span class="n">Request</span><span class="o">::</span><span class="n">SharedPtr</span> <span class="n">request</span><span class="p">,</span><span class="n">Patrol</span><span class="o">::</span><span class="n">Response</span><span class="o">::</span><span class="n">SharedPtr</span> <span class="n">response</span><span class="p">)</span><span class="o">-&gt;</span><span class="kt">void</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="k">if</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                  <span class="p">(</span><span class="mi">0</span><span class="o">&lt;</span><span class="n">request</span><span class="o">-&gt;</span><span class="n">target_x</span><span class="o">&amp;&amp;</span><span class="n">request</span><span class="o">-&gt;</span><span class="n">target_x</span><span class="o">&lt;</span><span class="mf">12.0f</span><span class="p">)</span><span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">(</span><span class="mi">0</span><span class="o">&lt;</span><span class="n">request</span><span class="o">-&gt;</span><span class="n">target_y</span><span class="o">&amp;&amp;</span><span class="n">request</span><span class="o">-&gt;</span><span class="n">target_y</span><span class="o">&lt;</span><span class="mf">12.0f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="k">this</span><span class="o">-&gt;</span><span class="n">target_x_</span><span class="o">=</span><span class="n">request</span><span class="o">-&gt;</span><span class="n">target_x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                  <span class="k">this</span><span class="o">-&gt;</span><span class="n">target_y_</span><span class="o">=</span><span class="n">request</span><span class="o">-&gt;</span><span class="n">target_y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                  <span class="n">response</span><span class="o">-&gt;</span><span class="n">result</span><span class="o">=</span><span class="n">Patrol</span><span class="o">::</span><span class="n">Response</span><span class="o">::</span><span class="n">SUCESS</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">              <span class="p">}</span>
</span></span><span class="line"><span class="cl">              <span class="k">else</span>
</span></span><span class="line"><span class="cl">              <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="n">response</span><span class="o">-&gt;</span><span class="n">result</span><span class="o">=</span><span class="n">Patrol</span><span class="o">::</span><span class="n">Response</span><span class="o">::</span><span class="n">FAIL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">              <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="p">});</span>
</span></span><span class="line"><span class="cl">          <span class="n">publisher_</span><span class="o">=</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_publisher</span><span class="o">&lt;</span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Twist</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;/turtle1/cmd_vel&#34;</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="c1">// timer_=this-&gt;create_wall_timer(1000ms,std::bind(&amp;TurtrlControlNode::timer_callback,this));
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="n">subscription_</span><span class="o">=</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_subscription</span><span class="o">&lt;</span><span class="n">turtlesim</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Pose</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;/turtle1/pose&#34;</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">TurtrlControlNode</span><span class="o">::</span><span class="n">on_pose_recevied</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">_1</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="kt">void</span> <span class="nf">on_pose_recevied</span><span class="p">(</span><span class="k">const</span> <span class="n">turtlesim</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Pose</span><span class="o">::</span><span class="n">SharedPtr</span> <span class="n">pose</span><span class="p">)</span> <span class="c1">//åƒæ•¸ï¼šæ”¶åˆ°æ•¸æ“šçš„å…±äº«æŒ‡é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="c1">//1.ç²å–ç•¶å‰ä½ç½®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="k">auto</span> <span class="n">current_x</span><span class="o">=</span><span class="n">pose</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="k">auto</span> <span class="n">current_y</span><span class="o">=</span><span class="n">pose</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="n">get_logger</span><span class="p">(),</span><span class="s">&#34;ç•¶å‰çš„ï¼šx=%f,y=%f&#34;</span><span class="p">,</span><span class="n">current_x</span><span class="p">,</span><span class="n">current_y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="c1">//2.è¨ˆç®—ç•¶å‰çš„ä½ç½®å’Œç›®æ¨™ä½ç½®çš„è·é›¢å’Œæœå‘çš„å·®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="k">auto</span> <span class="n">distance</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">              <span class="p">(</span><span class="n">target_x_</span><span class="o">-</span><span class="n">current_x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">target_x_</span><span class="o">-</span><span class="n">current_x</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">              <span class="p">(</span><span class="n">target_y_</span><span class="o">-</span><span class="n">current_y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">target_y_</span><span class="o">-</span><span class="n">current_y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="k">auto</span> <span class="n">angle</span><span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">atan2</span><span class="p">((</span><span class="n">target_y_</span><span class="o">-</span><span class="n">current_y</span><span class="p">),(</span><span class="n">target_x_</span><span class="o">-</span><span class="n">current_x</span><span class="p">))</span> <span class="o">-</span> <span class="n">pose</span><span class="o">-&gt;</span><span class="n">theta</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="c1">//3.åˆ©ç”¨è§’åº¦å·®å’Œä½ç½®å·®è¼¸å‡ºæ§åˆ¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="k">auto</span> <span class="n">msg</span><span class="o">=</span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Twist</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">          <span class="k">if</span><span class="p">(</span><span class="n">distance</span><span class="o">&gt;</span><span class="mf">0.2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="k">if</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="n">msg</span><span class="p">.</span><span class="n">angular</span><span class="p">.</span><span class="n">z</span><span class="o">=</span><span class="n">fabs</span><span class="p">(</span><span class="n">angle</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">              <span class="p">}</span>
</span></span><span class="line"><span class="cl">              <span class="k">else</span>
</span></span><span class="line"><span class="cl">              <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="n">msg</span><span class="p">.</span><span class="n">linear</span><span class="p">.</span><span class="n">x</span><span class="o">=</span><span class="n">k_</span><span class="o">*</span><span class="n">distance</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">              <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="c1">//4.é™åˆ¶ç·šé€Ÿåº¦æœ€å¤§å€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="k">if</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">linear</span><span class="p">.</span><span class="n">x</span><span class="o">&gt;</span><span class="n">max_speed_</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="n">msg</span><span class="p">.</span><span class="n">linear</span><span class="p">.</span><span class="n">x</span><span class="o">=</span><span class="n">max_speed_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="n">publisher_</span><span class="o">-&gt;</span><span class="n">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="n">argv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">auto</span> <span class="n">node</span> <span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">TurtrlControlNode</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;turtle_control&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">spin</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">shutdown</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>ä¹‹åå†cmakelistæ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–å·²ç»éœ€è¦ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶å·²ç»æ‹·è´å†…å®¹3ä¸ªéƒ¨åˆ†ï¼Œä¹‹åå°±å¯ä»¥æ­£å¸¸åœ°colconå·²ç»sourceï¼Œæµ‹è¯•éœ€è¦å¼€å¯å°æµ·é¾ŸèŠ‚ç‚¹ï¼Œå¯ä»¥å†å¼€ä¸€ä¸ªrqtå¯è§†åŒ–å·¥å…·æ¥å‘å¸ƒrequestæœåŠ¡çš„æ¥å£å†…å®¹ï¼Œè§‚å¯Ÿæ˜¯å¦èƒ½æ§åˆ¶å°æµ·é¾Ÿè¿åŠ¨æ—¢å¯</li>
</ul>
</li>
</ul>
</li>
<li>(å®¢æˆ·ç«¯)åœ¨srcçš„demo_cpp_serviceä¸‹æ–°å»ºä¸€ä¸ªpatrol_client.cppï¼Œä»£ç ç¤ºä¾‹ï¼š
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">  <span class="cp">#include</span> <span class="cpf">&#34;rclcpp/rclcpp.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&lt;chrono&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&#34;chapt4_interfaces/srv/patrol.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&lt;ctime&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="k">using</span> <span class="n">Patrol</span><span class="o">=</span><span class="n">chapt4_interfaces</span><span class="o">::</span><span class="n">srv</span><span class="o">::</span><span class="n">Patrol</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="o">::</span><span class="n">chrono_literals</span><span class="p">;</span> <span class="c1">//å®šä¹‰ä¹‹åå¯ä»¥ä½¿ç”¨10s,100ms
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">class</span> <span class="nc">PatrolClient</span><span class="o">:</span><span class="k">public</span> <span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">private</span><span class="o">:</span>    
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">TimerBase</span><span class="o">::</span><span class="n">SharedPtr</span> <span class="n">timer_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">Client</span><span class="o">&lt;</span><span class="n">Patrol</span><span class="o">&gt;::</span><span class="n">SharedPtr</span> <span class="n">patrol_client_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">explicit</span> <span class="n">PatrolClient</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">node_name</span><span class="p">)</span><span class="o">:</span><span class="n">Node</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span> <span class="c1">//åŠ å…¥explicitå…³é”®å­—æ˜¯é˜²æ­¢ç±»è¿›è¡Œå•å‚æ•°éšå¼è½¬æ¢ æ­¤å¤„åªæœ‰ä¸€ä¸ªå‚æ•°å¯ä»¥è¢«ç›´æ¥ä½¿ç”¨èµ‹å€¼æ„é€ ï¼Œä½†æ˜¯ä¸è¦å…è®¸è¿™æ ·å‘ç”Ÿï¼Œæé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">srand</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span> <span class="c1">//åˆå§‹åŒ–éšæœºæ•°ç§å­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="n">patrol_client_</span><span class="o">=</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_client</span><span class="o">&lt;</span><span class="n">Patrol</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;patrol&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="n">timer_</span><span class="o">=</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_wall_timer</span><span class="p">(</span><span class="mi">10</span><span class="n">s</span><span class="p">,[</span><span class="o">&amp;</span><span class="p">]()</span><span class="o">-&gt;</span><span class="kt">void</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="c1">//1.æ£€æµ‹æœåŠ¡ç«¯æ˜¯å¦ä¸Šçº¿
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>              <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">patrol_client_</span><span class="o">-&gt;</span><span class="n">wait_for_service</span><span class="p">(</span><span class="mi">1</span><span class="n">s</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">              <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">ok</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">                  <span class="p">{</span>
</span></span><span class="line"><span class="cl">                      <span class="n">RCLCPP_ERROR</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="s">&#34;ç­‰å¾…æœåŠ¡ä¸Šçº¿ä¸­ï¼ŒrclcppæŒ‚äº†ã€‚è‡£é€€ä¸‹äº†&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                      <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">                  <span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="s">&#34;ç­‰å¾…æœåŠ¡ä¸Šçº¿ä¸­......&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">              <span class="p">}</span>
</span></span><span class="line"><span class="cl">              <span class="c1">//2.æ„é€ è¯·æ±‚çš„å¯¹è±¡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>              <span class="k">auto</span> <span class="n">request</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">Patrol</span><span class="o">::</span><span class="n">Request</span><span class="o">&gt;</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">              <span class="n">request</span><span class="o">-&gt;</span><span class="n">target_x</span><span class="o">=</span><span class="n">rand</span><span class="p">()</span><span class="o">%</span><span class="mi">12</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">              <span class="n">request</span><span class="o">-&gt;</span><span class="n">target_y</span><span class="o">=</span><span class="n">rand</span><span class="p">()</span><span class="o">%</span><span class="mi">12</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">              <span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="s">&#34;å‡†å¤‡å¥½ç›®æ ‡ç‚¹ï¼š%f,%f&#34;</span><span class="p">,</span><span class="n">request</span><span class="o">-&gt;</span><span class="n">target_x</span><span class="p">,</span><span class="n">request</span><span class="o">-&gt;</span><span class="n">target_y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">              <span class="c1">//3.å‘é€è¯·æ±‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>              <span class="k">this</span><span class="o">-&gt;</span><span class="n">patrol_client_</span><span class="o">-&gt;</span><span class="n">async_send_request</span><span class="p">(</span><span class="n">request</span><span class="p">,[</span><span class="o">&amp;</span><span class="p">](</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Client</span><span class="o">&lt;</span><span class="n">Patrol</span><span class="o">&gt;::</span><span class="n">SharedFuture</span> <span class="n">result_future</span><span class="p">)</span><span class="o">-&gt;</span><span class="kt">void</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="k">auto</span> <span class="n">response</span> <span class="o">=</span><span class="n">result_future</span><span class="p">.</span><span class="n">get</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                  <span class="k">if</span><span class="p">(</span><span class="n">response</span><span class="o">-&gt;</span><span class="n">result</span><span class="o">==</span><span class="n">Patrol</span><span class="o">::</span><span class="n">Response</span><span class="o">::</span><span class="n">SUCESS</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                  <span class="p">{</span>
</span></span><span class="line"><span class="cl">                      <span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="s">&#34;è¯·æ±‚å·¡é€»ç›®æ ‡ç‚¹æˆåŠŸï¼&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">                  <span class="k">if</span><span class="p">(</span><span class="n">response</span><span class="o">-&gt;</span><span class="n">result</span><span class="o">==</span><span class="n">Patrol</span><span class="o">::</span><span class="n">Response</span><span class="o">::</span><span class="n">FAIL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                  <span class="p">{</span>
</span></span><span class="line"><span class="cl">                      <span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="s">&#34;è¯·æ±‚å·¡é€»ç›®æ ‡ç‚¹å¤±è´¥....&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>                
</span></span><span class="line"><span class="cl">              <span class="p">});</span>
</span></span><span class="line"><span class="cl">          <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="n">argv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">auto</span> <span class="n">node</span> <span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">PatrolClient</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;patrol_client_node&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">spin</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">shutdown</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>ä¹‹åä¿®æ”¹cmakelisté…ç½®æ–‡ä»¶ç„¶åæ­£å¸¸åœ°colconæ—¢å¯ï¼Œä¹‹åæ­£å¸¸è¿è¡Œå…ˆè¿è¡Œæµ·é¾Ÿnodeç„¶åå†æŠŠæœåŠ¡ç«¯çš„èŠ‚ç‚¹å¼€å¯ï¼Œæœ€åå¼€å¯å®¢æˆ·ç«¯å°±å¯ä»¥çœ‹åˆ°å°æµ·é¾Ÿè‡ªåŠ¨åŠ¨èµ·æ¥äº†ï¼š</li>
</ul>
</li>
</ul>
</li>
<li>
<p>å‚æ•°ç›¸å…³</p>
<ul>
<li>å‚æ•°å£°æ˜é…ç½®
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">  <span class="c1">#å‚æ•°å£°æ˜ åç§°ï¼‹å€¼</span>
</span></span><span class="line"><span class="cl">  <span class="bp">self</span><span class="o">.</span><span class="n">declare_parameter</span><span class="p">(</span><span class="s1">&#39;number_of_times_to_upsample&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="bp">self</span><span class="o">.</span><span class="n">declare_parameter</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span><span class="s1">&#39;hog&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#å‚æ•°å€¼è·å–</span>
</span></span><span class="line"><span class="cl">  <span class="bp">self</span><span class="o">.</span><span class="n">number_of_times_to_upsample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s1">&#39;number_of_times_to_upsample&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
</span></span><span class="line"><span class="cl">  <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
<li>å‚æ•°ä½¿ç”¨å’Œæ›´æ”¹ï¼š
<ul>
<li>è¿è¡ŒèŠ‚ç‚¹æ—¶å¯æŒ‡ä»¤æ›´æ”¹å‚æ•°å€¼ï¼š
<ul>
<li>ros2 run demo_python_service face_detect_node &ndash;ros-args -p model:=cnn</li>
</ul>
</li>
<li>å¯åœ¨æ–°ç»ˆç«¯å…ˆè¿è¡ŒæŸ¥çœ‹å½“å‰å‚æ•°listï¼šros2 param list
<ul>
<li>éšåå¯è¿è¡Œç±»ä¼¼setå‚æ•°å€¼ï¼šros2 param set /face_detect_node number_of_times_to_upsample 2</li>
<li>ä¹Ÿå¯ä»¥getå‚æ•°å€¼ï¼šros2 param get /face_detect_node model</li>
</ul>
</li>
</ul>
</li>
<li>C++æ¥æ”¶å‚æ•°äº‹ä»¶
<ul>
<li>åˆ›å»ºå‚æ•°å¹¶ä¸”å¯ä»¥ä»£ç å†…éƒ¨ä¿®æ”¹å‚æ•°å€¼ï¼Œä¹Ÿå¯ä»¥åŠ¨æ€rqtè®¾ç½®å‚æ•°ï¼Œé€šè¿‡è®¾ç½®å“åº”è®¾ç½®å‚æ•°çš„å›è°ƒå‡½æ•°æ¥åŠ¨æ€è®¾ç½®å‚æ•°æ•°å€¼å¹¶ä¸”èµ‹å€¼ç»™ä»£ç ä¸­çš„å…¶ä»–å‚æ•°
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">  <span class="cp">#include</span> <span class="cpf">&#34;rclcpp/rclcpp.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&#34;geometry_msgs/msg/twist.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&lt;chrono&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&#34;turtlesim/msg/pose.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&#34;chapt4_interfaces/srv/patrol.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&#34;rcl_interfaces/msg/set_parameters_result.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl">  <span class="k">using</span> <span class="n">SetParametersResult</span><span class="o">=</span><span class="n">rcl_interfaces</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">SetParametersResult</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">using</span> <span class="n">Patrol</span><span class="o">=</span><span class="n">chapt4_interfaces</span><span class="o">::</span><span class="n">srv</span><span class="o">::</span><span class="n">Patrol</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="o">::</span><span class="n">chrono_literals</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">class</span> <span class="nc">TurtrlControlNode</span><span class="o">:</span><span class="k">public</span> <span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">private</span><span class="o">:</span>    
</span></span><span class="line"><span class="cl">      <span class="n">OnSetParametersCallbackHandle</span><span class="o">::</span><span class="n">SharedPtr</span> <span class="n">parameter_callback_handle_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">Service</span><span class="o">&lt;</span><span class="n">Patrol</span><span class="o">&gt;::</span><span class="n">SharedPtr</span> <span class="n">patrol_service_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">Publisher</span><span class="o">&lt;</span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Twist</span><span class="o">&gt;::</span><span class="n">SharedPtr</span> <span class="n">publisher_</span><span class="p">;</span> <span class="c1">//å‘å¸ƒè€…çš„æ™ºèƒ½æŒ‡é’ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="n">rclcpp</span><span class="o">::</span><span class="n">Subscription</span><span class="o">&lt;</span><span class="n">turtlesim</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Pose</span><span class="o">&gt;::</span><span class="n">SharedPtr</span> <span class="n">subscription_</span><span class="p">;</span><span class="c1">//è¨‚é–±è€…çš„æ™ºèƒ½æŒ‡é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="kt">double</span> <span class="n">target_x_</span><span class="p">{</span><span class="mf">1.0</span><span class="p">};</span><span class="c1">//ç›®æ¨™ä½ç½®xåº§æ¨™
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="kt">double</span> <span class="n">target_y_</span><span class="p">{</span><span class="mf">1.0</span><span class="p">};</span> <span class="c1">//ç›®æ¨™ä½ç½®yåº§æ¨™
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="kt">double</span> <span class="n">k_</span><span class="p">{</span><span class="mf">1.0</span><span class="p">};</span> <span class="c1">// æ¯”ä¾‹ä¿‚æ•¸
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="kt">double</span> <span class="n">max_speed_</span><span class="p">{</span><span class="mf">3.0</span><span class="p">};</span> <span class="c1">//æœ€å¤§é€Ÿåº¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">explicit</span> <span class="n">TurtrlControlNode</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">node_name</span><span class="p">)</span><span class="o">:</span><span class="n">Node</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span> <span class="c1">//åŠ å…¥explicitå…³é”®å­—æ˜¯é˜²æ­¢ç±»è¿›è¡Œå•å‚æ•°éšå¼è½¬æ¢ æ­¤å¤„åªæœ‰ä¸€ä¸ªå‚æ•°å¯ä»¥è¢«ç›´æ¥ä½¿ç”¨èµ‹å€¼æ„é€ ï¼Œä½†æ˜¯ä¸è¦å…è®¸è¿™æ ·å‘ç”Ÿï¼Œæé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">{</span>     
</span></span><span class="line"><span class="cl">          <span class="k">this</span><span class="o">-&gt;</span><span class="n">declare_parameter</span><span class="p">(</span><span class="s">&#34;k&#34;</span><span class="p">,</span><span class="mf">1.0</span><span class="p">);</span> <span class="c1">//åˆ›å»ºå‚æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="k">this</span><span class="o">-&gt;</span><span class="n">declare_parameter</span><span class="p">(</span><span class="s">&#34;max_speed&#34;</span><span class="p">,</span><span class="mf">1.0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="k">this</span><span class="o">-&gt;</span><span class="n">get_parameter</span><span class="p">(</span><span class="s">&#34;k&#34;</span><span class="p">,</span><span class="n">k_</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="k">this</span><span class="o">-&gt;</span><span class="n">get_parameter</span><span class="p">(</span><span class="s">&#34;max_speed&#34;</span><span class="p">,</span><span class="n">max_speed_</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="k">this</span><span class="o">-&gt;</span><span class="n">set_parameter</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Parameter</span><span class="p">(</span><span class="s">&#34;k&#34;</span><span class="p">,</span><span class="mf">2.0</span><span class="p">));</span>  <span class="c1">//å†…éƒ¨ä¿®æ”¹å‚æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">          <span class="c1">//å“åº”å›è°ƒå‡½æ•°åŠ¨æ€æ¥æ”¶å‚æ•°ä¿®æ”¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="n">parameter_callback_handle_</span><span class="o">=</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">add_on_set_parameters_callback</span><span class="p">([</span><span class="o">&amp;</span><span class="p">]</span> 
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Parameter</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">parameters</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="o">-&gt;</span><span class="n">rcl_interfaces</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">SetParametersResult</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">              <span class="n">rcl_interfaces</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">SetParametersResult</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">              <span class="n">result</span><span class="p">.</span><span class="n">successful</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">              <span class="k">for</span> <span class="p">(</span><span class="k">const</span> <span class="k">auto</span> <span class="o">&amp;</span> <span class="nl">parameter</span> <span class="p">:</span> <span class="n">parameters</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">              <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="s">&#34;æ›´æ–°å‚æ•°çš„å€¼%s=%f&#34;</span><span class="p">,</span><span class="n">parameter</span><span class="p">.</span><span class="n">get_name</span><span class="p">().</span><span class="n">c_str</span><span class="p">(),</span><span class="n">parameter</span><span class="p">.</span><span class="n">as_double</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">                  <span class="k">if</span><span class="p">(</span><span class="n">parameter</span><span class="p">.</span><span class="n">get_name</span><span class="p">()</span><span class="o">==</span><span class="s">&#34;k&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                  <span class="p">{</span>
</span></span><span class="line"><span class="cl">                      <span class="n">k_</span><span class="o">=</span><span class="n">parameter</span><span class="p">.</span><span class="n">as_double</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">                  <span class="k">if</span><span class="p">(</span><span class="n">parameter</span><span class="p">.</span><span class="n">get_name</span><span class="p">()</span><span class="o">==</span><span class="s">&#34;max_speed&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                  <span class="p">{</span>
</span></span><span class="line"><span class="cl">                      <span class="n">max_speed_</span><span class="o">=</span><span class="n">parameter</span><span class="p">.</span><span class="n">as_double</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">              <span class="p">}</span>
</span></span><span class="line"><span class="cl">              <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="n">patrol_service_</span><span class="o">=</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_service</span><span class="o">&lt;</span><span class="n">Patrol</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;patrol&#34;</span><span class="p">,[</span><span class="o">&amp;</span><span class="p">](</span><span class="k">const</span> <span class="n">Patrol</span><span class="o">::</span><span class="n">Request</span><span class="o">::</span><span class="n">SharedPtr</span> <span class="n">request</span><span class="p">,</span><span class="n">Patrol</span><span class="o">::</span><span class="n">Response</span><span class="o">::</span><span class="n">SharedPtr</span> <span class="n">response</span><span class="p">)</span><span class="o">-&gt;</span><span class="kt">void</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="k">if</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                  <span class="p">(</span><span class="mi">0</span><span class="o">&lt;</span><span class="n">request</span><span class="o">-&gt;</span><span class="n">target_x</span><span class="o">&amp;&amp;</span><span class="n">request</span><span class="o">-&gt;</span><span class="n">target_x</span><span class="o">&lt;</span><span class="mf">12.0f</span><span class="p">)</span><span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">(</span><span class="mi">0</span><span class="o">&lt;</span><span class="n">request</span><span class="o">-&gt;</span><span class="n">target_y</span><span class="o">&amp;&amp;</span><span class="n">request</span><span class="o">-&gt;</span><span class="n">target_y</span><span class="o">&lt;</span><span class="mf">12.0f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="k">this</span><span class="o">-&gt;</span><span class="n">target_x_</span><span class="o">=</span><span class="n">request</span><span class="o">-&gt;</span><span class="n">target_x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                  <span class="k">this</span><span class="o">-&gt;</span><span class="n">target_y_</span><span class="o">=</span><span class="n">request</span><span class="o">-&gt;</span><span class="n">target_y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                  <span class="n">response</span><span class="o">-&gt;</span><span class="n">result</span><span class="o">=</span><span class="n">Patrol</span><span class="o">::</span><span class="n">Response</span><span class="o">::</span><span class="n">SUCESS</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">              <span class="p">}</span>
</span></span><span class="line"><span class="cl">              <span class="k">else</span>
</span></span><span class="line"><span class="cl">              <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="n">response</span><span class="o">-&gt;</span><span class="n">result</span><span class="o">=</span><span class="n">Patrol</span><span class="o">::</span><span class="n">Response</span><span class="o">::</span><span class="n">FAIL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">              <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="p">});</span>
</span></span><span class="line"><span class="cl">          <span class="n">publisher_</span><span class="o">=</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_publisher</span><span class="o">&lt;</span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Twist</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;/turtle1/cmd_vel&#34;</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="c1">// timer_=this-&gt;create_wall_timer(1000ms,std::bind(&amp;TurtrlControlNode::timer_callback,this));
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="n">subscription_</span><span class="o">=</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_subscription</span><span class="o">&lt;</span><span class="n">turtlesim</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Pose</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;/turtle1/pose&#34;</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">TurtrlControlNode</span><span class="o">::</span><span class="n">on_pose_recevied</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">_1</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="kt">void</span> <span class="nf">on_pose_recevied</span><span class="p">(</span><span class="k">const</span> <span class="n">turtlesim</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Pose</span><span class="o">::</span><span class="n">SharedPtr</span> <span class="n">pose</span><span class="p">)</span> <span class="c1">//åƒæ•¸ï¼šæ”¶åˆ°æ•¸æ“šçš„å…±äº«æŒ‡é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="c1">//1.ç²å–ç•¶å‰ä½ç½®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="k">auto</span> <span class="n">current_x</span><span class="o">=</span><span class="n">pose</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="k">auto</span> <span class="n">current_y</span><span class="o">=</span><span class="n">pose</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="n">get_logger</span><span class="p">(),</span><span class="s">&#34;ç•¶å‰çš„ï¼šx=%f,y=%f&#34;</span><span class="p">,</span><span class="n">current_x</span><span class="p">,</span><span class="n">current_y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="c1">//2.è¨ˆç®—ç•¶å‰çš„ä½ç½®å’Œç›®æ¨™ä½ç½®çš„è·é›¢å’Œæœå‘çš„å·®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="k">auto</span> <span class="n">distance</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">              <span class="p">(</span><span class="n">target_x_</span><span class="o">-</span><span class="n">current_x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">target_x_</span><span class="o">-</span><span class="n">current_x</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">              <span class="p">(</span><span class="n">target_y_</span><span class="o">-</span><span class="n">current_y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">target_y_</span><span class="o">-</span><span class="n">current_y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="k">auto</span> <span class="n">angle</span><span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">atan2</span><span class="p">((</span><span class="n">target_y_</span><span class="o">-</span><span class="n">current_y</span><span class="p">),(</span><span class="n">target_x_</span><span class="o">-</span><span class="n">current_x</span><span class="p">))</span> <span class="o">-</span> <span class="n">pose</span><span class="o">-&gt;</span><span class="n">theta</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="c1">//3.åˆ©ç”¨è§’åº¦å·®å’Œä½ç½®å·®è¼¸å‡ºæ§åˆ¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="k">auto</span> <span class="n">msg</span><span class="o">=</span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Twist</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">          <span class="k">if</span><span class="p">(</span><span class="n">distance</span><span class="o">&gt;</span><span class="mf">0.2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="k">if</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="n">msg</span><span class="p">.</span><span class="n">angular</span><span class="p">.</span><span class="n">z</span><span class="o">=</span><span class="n">fabs</span><span class="p">(</span><span class="n">angle</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">              <span class="p">}</span>
</span></span><span class="line"><span class="cl">              <span class="k">else</span>
</span></span><span class="line"><span class="cl">              <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="n">msg</span><span class="p">.</span><span class="n">linear</span><span class="p">.</span><span class="n">x</span><span class="o">=</span><span class="n">k_</span><span class="o">*</span><span class="n">distance</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">              <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="c1">//4.é™åˆ¶ç·šé€Ÿåº¦æœ€å¤§å€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="k">if</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">linear</span><span class="p">.</span><span class="n">x</span><span class="o">&gt;</span><span class="n">max_speed_</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="n">msg</span><span class="p">.</span><span class="n">linear</span><span class="p">.</span><span class="n">x</span><span class="o">=</span><span class="n">max_speed_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="n">publisher_</span><span class="o">-&gt;</span><span class="n">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="n">argv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">auto</span> <span class="n">node</span> <span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">TurtrlControlNode</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;turtle_control&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">spin</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">shutdown</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>ä»£ç è·‘é€šåç›´æ¥åœ¨rqtä¸­parameter reconfigureåŠ¨æ€ä¿®æ”¹èŠ‚ç‚¹ä¸­çš„å¯¹åº”è®¾ç½®å¥½çš„kå’Œmax_speedçš„å€¼ï¼ŒéšåæŸ¥çœ‹ç»ˆç«¯æ˜¯å¦æ‰“å°ä¿®æ”¹æˆåŠŸä¿¡æ¯</li>
</ul>
</li>
</ul>
</li>
<li>C++ä¿®æ”¹å…¶ä»–èŠ‚ç‚¹çš„å‚æ•°
<ul>
<li>åˆ†åˆ«æ–°å»ºå®¢æˆ·ç«¯ç”¨äºå‘é€è¯·æ±‚ï¼Œä»¥åŠæ–°å»ºæ›´æ–°å‚æ•°å€¼å‡½æ•°ï¼Œä¸»å‡½æ•°è°ƒç”¨æ›´æ–°å‚æ•°å€¼å‡½æ•°å³å¯ï¼Œä»£ç ç¤ºä¾‹ä¸­ä¸»è¦æ˜¯è®¾ç½®kçš„å‚æ•°å€¼ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹å…¶ä»–å‚æ•°å€¼ç›´æ¥æ–°å»ºè®¾ç½®å‡½æ•°å³å¯ï¼Œä¸»è¦å¦‚ä¸‹ï¼š
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">  <span class="cp">#include</span> <span class="cpf">&#34;rclcpp/rclcpp.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&lt;chrono&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&#34;chapt4_interfaces/srv/patrol.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&lt;ctime&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&#34;rcl_interfaces/msg/parameter.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&#34;rcl_interfaces/msg/parameter_value.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&#34;rcl_interfaces/msg/parameter_type.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#include</span> <span class="cpf">&#34;rcl_interfaces/srv/set_parameters.hpp&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl">  <span class="k">using</span> <span class="n">SetP</span><span class="o">=</span><span class="n">rcl_interfaces</span><span class="o">::</span><span class="n">srv</span><span class="o">::</span><span class="n">SetParameters</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">using</span> <span class="n">Patrol</span><span class="o">=</span><span class="n">chapt4_interfaces</span><span class="o">::</span><span class="n">srv</span><span class="o">::</span><span class="n">Patrol</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="o">::</span><span class="n">chrono_literals</span><span class="p">;</span> <span class="c1">//å®šä¹‰ä¹‹åå¯ä»¥ä½¿ç”¨10s,100ms
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">class</span> <span class="nc">PatrolClient</span><span class="o">:</span><span class="k">public</span> <span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">private</span><span class="o">:</span>    
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">TimerBase</span><span class="o">::</span><span class="n">SharedPtr</span> <span class="n">timer_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">Client</span><span class="o">&lt;</span><span class="n">Patrol</span><span class="o">&gt;::</span><span class="n">SharedPtr</span> <span class="n">patrol_client_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">explicit</span> <span class="n">PatrolClient</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">node_name</span><span class="p">)</span><span class="o">:</span><span class="n">Node</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span> <span class="c1">//åŠ å…¥explicitå…³é”®å­—æ˜¯é˜²æ­¢ç±»è¿›è¡Œå•å‚æ•°éšå¼è½¬æ¢ æ­¤å¤„åªæœ‰ä¸€ä¸ªå‚æ•°å¯ä»¥è¢«ç›´æ¥ä½¿ç”¨èµ‹å€¼æ„é€ ï¼Œä½†æ˜¯ä¸è¦å…è®¸è¿™æ ·å‘ç”Ÿï¼Œæé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">srand</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span> <span class="c1">//åˆå§‹åŒ–éšæœºæ•°ç§å­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="n">patrol_client_</span><span class="o">=</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_client</span><span class="o">&lt;</span><span class="n">Patrol</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;patrol&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="n">timer_</span><span class="o">=</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_wall_timer</span><span class="p">(</span><span class="mi">10</span><span class="n">s</span><span class="p">,[</span><span class="o">&amp;</span><span class="p">]()</span><span class="o">-&gt;</span><span class="kt">void</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="c1">//1.æ£€æµ‹æœåŠ¡ç«¯æ˜¯å¦ä¸Šçº¿
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>              <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">patrol_client_</span><span class="o">-&gt;</span><span class="n">wait_for_service</span><span class="p">(</span><span class="mi">1</span><span class="n">s</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">              <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">ok</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">                  <span class="p">{</span>
</span></span><span class="line"><span class="cl">                      <span class="n">RCLCPP_ERROR</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="s">&#34;ç­‰å¾…æœåŠ¡ä¸Šçº¿ä¸­ï¼ŒrclcppæŒ‚äº†ã€‚è‡£é€€ä¸‹äº†&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                      <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">                  <span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="s">&#34;ç­‰å¾…æœåŠ¡ä¸Šçº¿ä¸­......&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">              <span class="p">}</span>
</span></span><span class="line"><span class="cl">              <span class="c1">//2.æ„é€ è¯·æ±‚çš„å¯¹è±¡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>              <span class="k">auto</span> <span class="n">request</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">Patrol</span><span class="o">::</span><span class="n">Request</span><span class="o">&gt;</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">              <span class="n">request</span><span class="o">-&gt;</span><span class="n">target_x</span><span class="o">=</span><span class="n">rand</span><span class="p">()</span><span class="o">%</span><span class="mi">12</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">              <span class="n">request</span><span class="o">-&gt;</span><span class="n">target_y</span><span class="o">=</span><span class="n">rand</span><span class="p">()</span><span class="o">%</span><span class="mi">12</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">              <span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="s">&#34;å‡†å¤‡å¥½ç›®æ ‡ç‚¹ï¼š%f,%f&#34;</span><span class="p">,</span><span class="n">request</span><span class="o">-&gt;</span><span class="n">target_x</span><span class="p">,</span><span class="n">request</span><span class="o">-&gt;</span><span class="n">target_y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">              <span class="c1">//3.å‘é€è¯·æ±‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>              <span class="k">this</span><span class="o">-&gt;</span><span class="n">patrol_client_</span><span class="o">-&gt;</span><span class="n">async_send_request</span><span class="p">(</span><span class="n">request</span><span class="p">,[</span><span class="o">&amp;</span><span class="p">](</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Client</span><span class="o">&lt;</span><span class="n">Patrol</span><span class="o">&gt;::</span><span class="n">SharedFuture</span> <span class="n">result_future</span><span class="p">)</span><span class="o">-&gt;</span><span class="kt">void</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="k">auto</span> <span class="n">response</span> <span class="o">=</span><span class="n">result_future</span><span class="p">.</span><span class="n">get</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                  <span class="k">if</span><span class="p">(</span><span class="n">response</span><span class="o">-&gt;</span><span class="n">result</span><span class="o">==</span><span class="n">Patrol</span><span class="o">::</span><span class="n">Response</span><span class="o">::</span><span class="n">SUCESS</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                  <span class="p">{</span>
</span></span><span class="line"><span class="cl">                      <span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="s">&#34;è¯·æ±‚å·¡é€»ç›®æ ‡ç‚¹æˆåŠŸï¼&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">                  <span class="k">if</span><span class="p">(</span><span class="n">response</span><span class="o">-&gt;</span><span class="n">result</span><span class="o">==</span><span class="n">Patrol</span><span class="o">::</span><span class="n">Response</span><span class="o">::</span><span class="n">FAIL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                  <span class="p">{</span>
</span></span><span class="line"><span class="cl">                      <span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="s">&#34;è¯·æ±‚å·¡é€»ç›®æ ‡ç‚¹å¤±è´¥....&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>                
</span></span><span class="line"><span class="cl">              <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">      * åˆ›å»ºå®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œå¹¶ä¸”è¿”å›ç»“æœ
</span></span></span><span class="line"><span class="cl"><span class="cm">      */</span>
</span></span><span class="line"><span class="cl">      <span class="n">SetP</span><span class="o">::</span><span class="n">Response</span><span class="o">::</span><span class="n">SharedPtr</span> <span class="n">call_set_parameters</span><span class="p">(</span><span class="k">const</span> <span class="n">rcl_interfaces</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Parameter</span> <span class="o">&amp;</span><span class="n">param</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="k">auto</span> <span class="n">param_client</span><span class="o">=</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_client</span><span class="o">&lt;</span><span class="n">SetP</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;/turtle_control/set_parameters&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">              <span class="c1">//1.æ£€æµ‹æœåŠ¡ç«¯æ˜¯å¦ä¸Šçº¿
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>              <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">param_client</span><span class="o">-&gt;</span><span class="n">wait_for_service</span><span class="p">(</span><span class="mi">1</span><span class="n">s</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">              <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">ok</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">                  <span class="p">{</span>
</span></span><span class="line"><span class="cl">                      <span class="n">RCLCPP_ERROR</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="s">&#34;ç­‰å¾…ç¬¬äºŒä¸ªset_paramæœåŠ¡ä¸Šçº¿ä¸­ï¼ŒrclcppæŒ‚äº†ã€‚è‡£é€€ä¸‹äº†&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                      <span class="k">return</span> <span class="k">nullptr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">                  <span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="s">&#34;ç­‰å¾…æœåŠ¡ä¸Šçº¿ä¸­......&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">              <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">              <span class="c1">//2.æ„é€ è¯·æ±‚çš„å¯¹è±¡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>              <span class="k">auto</span> <span class="n">request</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">SetP</span><span class="o">::</span><span class="n">Request</span><span class="o">&gt;</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">              <span class="n">request</span><span class="o">-&gt;</span><span class="n">parameters</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">param</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">              <span class="c1">//3.å‘é€è¯·æ±‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>              <span class="k">auto</span> <span class="n">furture</span><span class="o">=</span><span class="n">param_client</span><span class="o">-&gt;</span><span class="n">async_send_request</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">              <span class="n">rclcpp</span><span class="o">::</span><span class="n">spin_until_future_complete</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_node_base_interface</span><span class="p">(),</span><span class="n">furture</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">              <span class="k">auto</span> <span class="n">response</span><span class="o">=</span><span class="n">furture</span><span class="p">.</span><span class="n">get</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">              <span class="k">return</span> <span class="n">response</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">      * æ›´æ–°å‚æ•°å€¼
</span></span></span><span class="line"><span class="cl"><span class="cm">      */</span>
</span></span><span class="line"><span class="cl">      <span class="kt">void</span> <span class="nf">update_server_param_k</span><span class="p">(</span><span class="kt">double</span> <span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="c1">//1.åˆ›å»ºä¸€ä¸ªå‚æ•°å¯¹è±¡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="k">auto</span> <span class="n">param</span><span class="o">=</span><span class="n">rcl_interfaces</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Parameter</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">          <span class="n">param</span><span class="p">.</span><span class="n">name</span><span class="o">=</span><span class="s">&#34;k&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="c1">//2.åˆ›å»ºå‚æ•°å€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="k">auto</span> <span class="n">param_value</span><span class="o">=</span><span class="n">rcl_interfaces</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">ParameterValue</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">          <span class="n">param_value</span><span class="p">.</span><span class="n">type</span><span class="o">=</span><span class="n">rcl_interfaces</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">ParameterType</span><span class="o">::</span><span class="n">PARAMETER_DOUBLE</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="n">param_value</span><span class="p">.</span><span class="n">double_value</span><span class="o">=</span><span class="n">k</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="n">param</span><span class="p">.</span><span class="n">value</span><span class="o">=</span><span class="n">param_value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="c1">//3.è¯·æ±‚æ›´æ–°å‚èµ›
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="k">auto</span> <span class="n">response</span><span class="o">=</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">call_set_parameters</span><span class="p">(</span><span class="n">param</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="k">if</span><span class="p">(</span><span class="n">response</span><span class="o">==</span><span class="nb">NULL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="s">&#34;å‚æ•°è¿”å›å¤±è´¥&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">              <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="nl">result</span><span class="p">:</span><span class="n">response</span><span class="o">-&gt;</span><span class="n">results</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="k">if</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">successful</span><span class="o">==</span><span class="nb">false</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="s">&#34;å‚æ•°è¿”å›å¤±è´¥ï¼ŒåŸå› æ˜¯ï¼š%s&#34;</span><span class="p">,</span><span class="n">result</span><span class="p">.</span><span class="n">reason</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">              <span class="p">}</span>
</span></span><span class="line"><span class="cl">              <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="s">&#34;å‚æ•°è¿”å›æˆåŠŸ&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">              <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="n">argv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">auto</span> <span class="n">node</span> <span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">PatrolClient</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;patrol_client_node&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">node</span><span class="o">-&gt;</span><span class="n">update_server_param_k</span><span class="p">(</span><span class="mf">5.0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">spin</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">rclcpp</span><span class="o">::</span><span class="n">shutdown</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>å†™å®Œåç¼–è¯‘ï¼Œå…ˆè¿è¡Œä¸Šä¸€èŠ‚çš„å‚æ•°å£°æ˜èŠ‚ç‚¹ï¼Œç„¶åå†è¿è¡Œæ–°å†™çš„ä¿®æ”¹å‚æ•°èŠ‚ç‚¹ï¼Œæ—¢å¯çœ‹åˆ°ç»ˆç«¯æ‰“å°çš„æ—¥å¿—å†…å®¹æ˜¯å¦æˆåŠŸæ£€æµ‹åˆ°æœåŠ¡ä¸Šçº¿ä»¥åŠæ˜¯å¦ä¿®æ”¹æˆåŠŸ</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>ä½¿ç”¨launchæ–‡ä»¶</p>
<ul>
<li>ç°åœ¨æƒ³è¦çš„åŠŸèƒ½åŒ…ä¸‹é¢æ–°å»ºlaunchæ–‡ä»¶å¤¹ï¼Œç„¶åå†launchæ–‡ä»¶å¤¹å†…æ–°å»ºä¸€ä¸ªdemo.launch.pyæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">launch</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">launch_ros</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">generate_launch_description</span><span class="p">():</span> <span class="c1">#æ­¤å‡½æ•°åæ˜¯å›ºå®šçš„</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;&#34;&#34;äº§ç”Ÿlaunchæè¿°&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="n">action_node_turtlesim_node</span><span class="o">=</span><span class="n">launch_ros</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">          <span class="n">package</span><span class="o">=</span><span class="s1">&#39;turtlesim&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">executable</span><span class="o">=</span><span class="s1">&#39;turtlesim_node&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">output</span><span class="o">=</span><span class="s1">&#39;screen&#39;</span> <span class="c1"># è¾“å‡ºæ–¹å¼ä¸€ï¼šå±å¹•</span>
</span></span><span class="line"><span class="cl">      <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="n">action_node_turtle_control</span><span class="o">=</span><span class="n">launch_ros</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">          <span class="n">package</span><span class="o">=</span><span class="s1">&#39;demo_cpp_service&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">executable</span><span class="o">=</span><span class="s1">&#39;turtle_control&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">output</span><span class="o">=</span><span class="s1">&#39;log&#39;</span> <span class="c1"># è¾“å‡ºæ–¹å¼äºŒï¼šæ—¥å¿—æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">      <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="n">action_node_patrol_client</span><span class="o">=</span><span class="n">launch_ros</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">          <span class="n">package</span><span class="o">=</span><span class="s1">&#39;demo_cpp_service&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">executable</span><span class="o">=</span><span class="s1">&#39;patrol_client&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">output</span><span class="o">=</span><span class="s1">&#39;both&#39;</span> <span class="c1"># è¾“å‡ºæ–¹å¼ä¸‰ï¼šä¸Šé¢ä¸¤ç§éƒ½è¦</span>
</span></span><span class="line"><span class="cl">      <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="n">launch</span><span class="o">.</span><span class="n">LaunchDescription</span><span class="p">([</span>
</span></span><span class="line"><span class="cl">          <span class="c1"># actionsåŠ¨ä½œ</span>
</span></span><span class="line"><span class="cl">          <span class="n">action_node_turtlesim_node</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">action_node_turtle_control</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">action_node_patrol_client</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>éšåæ›´æ”¹æ‹·è´çš„æ„å»ºé…ç½®ï¼Œåœ¨C++ä¸­çš„cmakelistæ–‡ä»¶ä¸­æ·»åŠ ä¸‹é¢å†…å®¹æŒ‡å®šæ‹·è´çš„æ–‡ä»¶å¤¹åç§°å’Œæ–‡ä»¶è·¯å¾„å³å¯ï¼š
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">  <span class="c1">// install(DIRECTORY launch
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// DESTINATION share/${PROJECT_NAME}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// )
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>åœ¨pythonä¸­çš„setup.pyä¸­æ·»åŠ ä¸‹é¢å†…å®¹ï¼ŒåŒæ ·æŒ‡å®šæ–‡ä»¶å¤¹å’Œæ–‡ä»¶è·¯å¾„ï¼š
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">  <span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">find_packages</span><span class="p">,</span> <span class="n">setup</span>
</span></span><span class="line"><span class="cl">  <span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>  <span class="c1"># 1.å¼•å…¥æ­¤åŒ…</span>
</span></span><span class="line"><span class="cl">  <span class="n">package_name</span> <span class="o">=</span> <span class="s1">&#39;demo_python_service&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">setup</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="n">name</span><span class="o">=</span><span class="n">package_name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">version</span><span class="o">=</span><span class="s1">&#39;0.0.0&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">packages</span><span class="o">=</span><span class="n">find_packages</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">      <span class="n">data_files</span><span class="o">=</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="s1">&#39;share/ament_index/resource_index/packages&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="p">[</span><span class="s1">&#39;resource/&#39;</span> <span class="o">+</span> <span class="n">package_name</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="s1">&#39;share/&#39;</span> <span class="o">+</span> <span class="n">package_name</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;package.xml&#39;</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="s1">&#39;share/&#39;</span> <span class="o">+</span> <span class="n">package_name</span><span class="o">+</span><span class="s2">&#34;/resource&#34;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;resource/defult.jpg&#39;</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="s1">&#39;share/&#39;</span> <span class="o">+</span> <span class="n">package_name</span><span class="o">+</span><span class="s2">&#34;/resource&#34;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;resource/peoples.jpg&#39;</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="s1">&#39;share/&#39;</span> <span class="o">+</span> <span class="n">package_name</span><span class="o">+</span><span class="s2">&#34;/launch&#34;</span><span class="p">,</span> <span class="n">glob</span><span class="p">(</span><span class="s1">&#39;launch/*.launch.py&#39;</span><span class="p">)),</span> <span class="c1"># 2.æ·»åŠ æŒ‡å®šè·¯å¾„ä»¥åŠæ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="n">install_requires</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;setuptools&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="n">zip_safe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">maintainer</span><span class="o">=</span><span class="s1">&#39;robot&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">maintainer_email</span><span class="o">=</span><span class="s1">&#39;robot@todo.todo&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">description</span><span class="o">=</span><span class="s1">&#39;TODO: Package description&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">license</span><span class="o">=</span><span class="s1">&#39;Apache-2.0&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">tests_require</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pytest&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="n">entry_points</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="s1">&#39;console_scripts&#39;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">              <span class="s1">&#39;learn_face_detect=demo_python_service.learn_face_detect:main&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="s1">&#39;face_detect_node=demo_python_service.face_detect_node:main&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="s1">&#39;face_detect_client_node=demo_python_service.face_detect_client_node:main&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
</li>
<li>é…ç½®å¥½åå…ˆcolcon buildï¼Œéšåå†sourceå®Œï¼Œè¿è¡Œï¼šros2 launch åŠŸèƒ½åŒ…åï¼ˆåˆ›å»ºlaunchæ–‡ä»¶å¤¹çš„åŠŸèƒ½åŒ…ä½ç½®ï¼‰ demo.launch.py</li>
<li>ä¹‹åå°±èƒ½çœ‹åˆ°é…ç½®çš„å¯¹åº”èŠ‚ç‚¹æˆåŠŸæ‰“å¼€</li>
</ul>
</li>
</ul>
<h2 id="4-å¿ƒå¾—æ€»ç»“">4. å¿ƒå¾—æ€»ç»“
</h2><blockquote class="alert alert-note">
    <p>ç§»æ­¥å®Œè¿™ç¯‡ç¬”è®°å†…å®¹æ‰ç®—æ˜¯æŠŠæˆ‘æœ¬åœ°ç”µè„‘ä¸Šé‚£ä¸ªâ€œåŸå§‹äººçš„CMDç¬”è®°â€ç»™å®Œå…¨ç§»æ­¥å®ŒğŸ˜¥ï¼Œä¹Ÿç®—æ˜¯é€æ­¥çº æ­£è‡ªå·±çš„æ‹–å»¶ç—‡å’Œæ‡’äº†ğŸ˜©ã€‚å…¶å®Linuxçš„å­¦ä¹ æ„Ÿè§‰è¿˜æ˜¯æœ‰å¾ˆå¤šå®è·µå’Œæ“ä½œéœ€è¦åŠ¨æ‰‹è¾¹å­¦è¾¹è¿ç”¨æ‰èƒ½æ›´å¥½å¸æ”¶ï¼Œåé¢æ›´å¤šçš„è¿˜æ˜¯å¸¦å…¥å®é™…é¡¹ç›®ä¸­å»è¾¹å­¦è¾¹åšï¼è¿˜æœ‰åé¢éœ€è¦çš„ç»†åˆ†åœ¨Linuxç³»ç»Ÿä¸‹å…·ä½“åšä¾‹å¦‚éŸ³é¢‘ï¼Œç½‘ç»œç­‰ç­‰å¼€å‘å†æ ï¼Œå…ˆå­¦ä¹ è¿ç”¨åœ¨ROSæœºå™¨äººæ“ä½œç³»ç»Ÿä¸Šçš„å…·ä½“ä¾‹å¦‚è‡ªä¸»å¯¼èˆªï¼Œæ‰‹çœ¼æ ‡å®šæŠ“å–ç­‰ç­‰ï¼Œä¸€æ­¥ä¸€æ­¥æ€»ä¼šæ‰¾åˆ°å±äºè‡ªå·±æƒ³è¦çš„ğŸ¥±ğŸ¥±ğŸ¥±</p></blockquote>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>ä¸çŸ¥æ±Ÿæœˆå¾…ä½•äºº,ä½†è§é•¿æ±Ÿé€æµæ°´.</span>
    </section>
    </footer>


    
</article>

    

    

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="prominsegsj/prominsegsj.github.io"
    data-repo-id="R_kgDOPjrIrg"
    data-category="Announcements"
    data-category-id="DIC_kwDOPjrIrs4Cuj0b"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="light"
    data-lang="en"
    data-loading=""
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('light');
            } else {
                setGiscusTheme('dark');
            }
        }
    })();
</script>

    

    
<div class="reading-progress">
    <div class="reading-progress-bar" id="readingProgress"></div>
</div>

<footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2025 å°éƒ­ä¸èƒŒé”…
    </section>
    
    
    <section class="powerby" style="margin-top: 0.5rem;">
        <div id="site-runtime" style="font-size: 1.15em; color: #290656;">
            æœ¬ç«™å·²å®‰å…¨è¿è¡Œ <span id="runtime-days">0</span> å¤© <span id="runtime-hours">0</span> æ—¶ <span id="runtime-mins">0</span> åˆ† <span id="runtime-secs">0</span> ç§’
        </div>
    </section>

    <script>
        
        const startDate = new Date('2025-08-25T12:00:00'); 

        function updateRuntime() {
            const now = new Date();
            const diff = now - startDate; 

            
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);

            
            document.getElementById('runtime-days').innerText = days;
            document.getElementById('runtime-hours').innerText = hours;
            document.getElementById('runtime-mins').innerText = minutes;
            document.getElementById('runtime-secs').innerText = seconds;
        }

        
        updateRuntime();
        
        setInterval(updateRuntime, 1000);

        
        document.addEventListener('DOMContentLoaded', function() {
            const progressBar = document.getElementById('readingProgress');
            
            if (progressBar) {
                
                window.addEventListener('scroll', function() {
                    const windowHeight = window.innerHeight;
                    const documentHeight = document.documentElement.scrollHeight - windowHeight;
                    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                    
                    const progress = (scrollTop / documentHeight) * 100;
                    progressBar.style.width = progress + '%';
                });
                
                
                progressBar.addEventListener('click', function(e) {
                    const rect = this.getBoundingClientRect();
                    const clickPosition = e.clientX - rect.left;
                    const percentage = clickPosition / rect.width;
                    
                    const documentHeight = document.documentElement.scrollHeight - window.innerHeight;
                    const targetPosition = documentHeight * percentage;
                    
                    window.scrollTo({
                        top: targetPosition,
                        behavior: 'smooth'
                    });
                });
            }
        });
    </script>
    
    <style>
     
    .reading-progress {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 3px;
        background: rgba(0, 0, 0, 0.1);
        z-index: 9999;
        backdrop-filter: blur(5px);
    }

    .reading-progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #ff6b6b, #ff8e53, #fea82f, #4ecdc4, #45b7d1);
        width: 0%;
        transition: width 0.1s ease;
        position: relative;
        overflow: hidden;
        cursor: pointer;
    }

    .reading-progress-bar::after {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, 
            transparent, 
            rgba(255,255,255,0.4), 
            transparent);
        animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
        0% { left: -100%; }
        100% { left: 100%; }
    }

     
    ::-webkit-scrollbar {
        width: 8px;
    }

    ::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb {
        background: linear-gradient(180deg, #ff6b6b, #4ecdc4);
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(180deg, #ff5252, #26a69a);
    }
    </style>
    
    
</footer>

    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

<meting-js
	server="netease"
	type="playlist"
	id="14194243775"
    list-max-height="100px"
    fixed="true"
    mini="true">
</meting-js>

<script>
    
    const cssPath = 'https:\/\/prominsegsj.github.io\/waifu\/waifu.css'
    const tipsJsonPath = 'https:\/\/prominsegsj.github.io\/waifu\/waifu-tips.json'
    const live2dJsPath = 'https:\/\/prominsegsj.github.io\/waifu\/live2d.min.js'
    
    const live2d_path = "https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/";


    
    function loadExternalResource(url, type) {
        return new Promise((resolve, reject) => {
            let tag;
            if (type === "css") {
                tag = document.createElement("link");
                tag.rel = "stylesheet";
                tag.href = url;
            }
            else if (type === "js") {
                tag = document.createElement("script");
                tag.src = url;
            }
            if (tag) {
                tag.onload = () => resolve(url);
                tag.onerror = () => reject(url);
                document.head.appendChild(tag);
            }
        });
    }

    
    if (screen.width >= 768) {
        Promise.all([
            loadExternalResource(cssPath, "css"),
            loadExternalResource(live2dJsPath, "js"),
            loadExternalResource(live2d_path + "waifu-tips.js", "js")
        ]).then(() => {
            
            initWidget({
                waifuPath: tipsJsonPath,
                cdnPath: "https://cdn.jsdelivr.net/gh/prominsegsj/static-resource@v1.0.0",
                tools: ["hitokoto", "asteroids", "switch-model", "switch-texture", "photo", "info", "quit"]
            });
            initWaifuMouseEvent();
        });
    }
   
    function initWaifuMouseEvent() {
        const waifu = document.getElementById("waifu");
        let isDown = false;
        let waifuLeft;
        let mouseLeft;
        let waifuTop;
        let mouseTop;
        
        waifu.onmousedown = function (e) {
            isDown = true;
            
            waifuLeft = waifu.offsetLeft;
            mouseLeft = e.clientX;
            
            waifuTop = waifu.offsetTop;
            mouseTop = e.clientY;
        }
        
        window.onmousemove = function (e) {
            if (!isDown) {
                return;
            }
            
            let currentLeft = waifuLeft + (e.clientX - mouseLeft);
            if (currentLeft < 0) {
                currentLeft = 0;
            } else if (currentLeft > window.innerWidth - 300) {
                currentLeft = window.innerWidth - 300;
            }
            waifu.style.left = currentLeft  + "px";
            
            
            
            
            
            
            
            
        }
        
        window.onmouseup = function (e) {
            isDown = false;
        }
    }  
</script>

<style>
    @font-face {
      font-family: 'ShinRetroMaruGothic';
      src: url('https://prominsegsj.github.io/font/ShinRetroMaruGothic-Medium.ttf') format('truetype');
    }
  
    :root {
      --base-font-family: 'ShinRetroMaruGothic';
      --code-font-family: 'ShinRetroMaruGothic';
    }
</style>
  
<style>

body,
html,
.article-content img {
  cursor: url(/mouse/normal1.png),
  auto !important;
}

a:hover,
button:hover,
.copyCodeButton:hover,
#dark-mode-toggle {
  cursor: url(/mouse/click_hu.png),
  auto;
}

input:hover,
.site-description,
.article-subtitle,
.article-content span,
.article-content li,
.article-content p {
  cursor: url(/mouse/text_hu.png),
  auto;
}

</style>

<style>
    #TableOfContents > ul, ol {
        ul, ol {
            display: none;
        }
        .open {
            display: block;
        }
    }
</style>

<script>
    function initTocHide() {
        
        let toc = document.querySelector(".widget--toc");
        if (!toc) {
            return;
        }
        
        window.addEventListener('scroll', function() {
            
            let openUl = document.querySelectorAll(".open");
            if (openUl.length > 0) {
              openUl.forEach((ul) => {
                ul.classList.remove("open")
              })
            }
            
            let currentLi = document.querySelector(".active-class");
            if (!currentLi) {
                return
            }
            
            if (currentLi.children.length > 1) {
                currentLi.children[1].classList.add("open")
            }
            
            let ul = currentLi.parentElement;
            do {
                ul.classList.add("open");
                ul = ul.parentElement.parentElement
            } while (ul !== undefined && (ul.localName === 'ul' || ul.localName === 'ol'))
        });
    }
    initTocHide()
</script>

<style>
    #backTopBtn {
        display: none;
        position: fixed;
        bottom: 30px;
        z-index: 99;
        cursor: pointer;
        width: 30px;
        height: 30px;
        background-image: url('https://prominsegsj.github.io/icons/backTop.svg');
    }
</style>

<script>
    

    function initScrollTop() {
        let rightSideBar = document.querySelector(".right-sidebar");
        if (!rightSideBar) {
            return;
        }
        
        let btn = document.createElement("div");
        btn.id = "backTopBtn";
        btn.onclick = backToTop
        rightSideBar.appendChild(btn)
        
        window.onscroll = function() {
            
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                btn.style.display = "block";
            } else {
                btn.style.display = "none";
            }
        };
    }

    

    function backToTop(){
        window.scrollTo({ top: 0, behavior: "smooth" })
    }

    initScrollTop();
</script>

<style>
    .highlight {
         
        max-height: 400px;
        overflow: hidden;
    }

    .code-show {
        max-height: none !important;
    }

    .code-more-box {
        width: 100%;
        padding-top: 78px;
        background-image: -webkit-gradient(linear, left top, left bottom, from(rgba(255, 255, 255, 0)), to(#fff));
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 1;
    }

    .code-more-btn {
        display: block;
        margin: auto;
        width: 44px;
        height: 22px;
        background: #f0f0f5;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
        padding-top: 6px;
        cursor: pointer;
    }

    .code-more-img {
        cursor: pointer !important;
        display: block;
        margin: auto;
        width: 22px;
        height: 16px;
    }
</style>

<script>
  function initCodeMoreBox() {
    let codeBlocks = document.querySelectorAll(".highlight");
    if (!codeBlocks) {
      return;
    }
    codeBlocks.forEach(codeBlock => {
      
      if (codeBlock.scrollHeight <= codeBlock.clientHeight) {
        return;
      }
      
      
      let codeMoreBox = document.createElement('div');
      codeMoreBox.classList.add('code-more-box');
      
      let codeMoreBtn = document.createElement('span');
      codeMoreBtn.classList.add('code-more-btn');
      codeMoreBtn.addEventListener('click', () => {
        codeBlock.classList.add('code-show');
        codeMoreBox.style.display = 'none';
        
        window.dispatchEvent(new Event('resize'))
      })
      
      let img = document.createElement('img');
      img.classList.add('code-more-img');
      img.src = 'https:\/\/prominsegsj.github.io\/icons\/codeMore.png'
      
      codeMoreBtn.appendChild(img);
      codeMoreBox.appendChild(codeMoreBtn);
      codeBlock.appendChild(codeMoreBox)
    })
  }
  
  initCodeMoreBox();
</script>





  
  
  
  

<script defer src="https://events.vercount.one/js"></script>
  



<div id="background-layer">
    
    <div id="particles-js"></div>
  
    
    <div id="jsi-flying-fish-container"></div>
  </div>
  
  
  <script src="/background/particles.min.js"></script>
  <script src="/fish/renderer.js"></script>
  <script>
    particlesJS.load('particles-js', '/background/particlesjs-config.json', function() {
      console.log('particles.js loaded - callback');
    });
  </script>
  
  
  <style>
     
    #background-layer {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;      
      overflow: hidden;
      pointer-events: none;
    }
  
     
    #particles-js {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;       
    }
  
     
    #jsi-flying-fish-container {
      width: 100%;
      height: 200px;
      position: absolute;
      bottom: 0;
      left: 0;
      z-index: 2;       
      opacity: 0.37;
    }
  </style>
  



    </body>
</html>



